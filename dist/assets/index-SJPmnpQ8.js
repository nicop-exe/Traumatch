function Qb(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function Yb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var YS={exports:{}},wp={},XS={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nh=Symbol.for("react.element"),Xb=Symbol.for("react.portal"),Jb=Symbol.for("react.fragment"),Zb=Symbol.for("react.strict_mode"),eN=Symbol.for("react.profiler"),tN=Symbol.for("react.provider"),nN=Symbol.for("react.context"),rN=Symbol.for("react.forward_ref"),sN=Symbol.for("react.suspense"),iN=Symbol.for("react.memo"),oN=Symbol.for("react.lazy"),l0=Symbol.iterator;function aN(n){return n===null||typeof n!="object"?null:(n=l0&&n[l0]||n["@@iterator"],typeof n=="function"?n:null)}var JS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ZS=Object.assign,e1={};function Cl(n,e,t){this.props=n,this.context=e,this.refs=e1,this.updater=t||JS}Cl.prototype.isReactComponent={};Cl.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Cl.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function t1(){}t1.prototype=Cl.prototype;function wy(n,e,t){this.props=n,this.context=e,this.refs=e1,this.updater=t||JS}var Ty=wy.prototype=new t1;Ty.constructor=wy;ZS(Ty,Cl.prototype);Ty.isPureReactComponent=!0;var u0=Array.isArray,n1=Object.prototype.hasOwnProperty,Ey={current:null},r1={key:!0,ref:!0,__self:!0,__source:!0};function s1(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)n1.call(e,r)&&!r1.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:nh,type:n,key:i,ref:o,props:s,_owner:Ey.current}}function lN(n,e){return{$$typeof:nh,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Iy(n){return typeof n=="object"&&n!==null&&n.$$typeof===nh}function uN(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var c0=/\/+/g;function Fm(n,e){return typeof n=="object"&&n!==null&&n.key!=null?uN(""+n.key):e.toString(36)}function bd(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case nh:case Xb:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Fm(o,0):r,u0(s)?(t="",n!=null&&(t=n.replace(c0,"$&/")+"/"),bd(s,e,t,"",function(u){return u})):s!=null&&(Iy(s)&&(s=lN(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(c0,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",u0(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+Fm(i,a);o+=bd(i,e,t,l,s)}else if(l=aN(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+Fm(i,a++),o+=bd(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ed(n,e,t){if(n==null)return n;var r=[],s=0;return bd(n,r,"","",function(i){return e.call(t,i,s++)}),r}function cN(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var un={current:null},Nd={transition:null},hN={ReactCurrentDispatcher:un,ReactCurrentBatchConfig:Nd,ReactCurrentOwner:Ey};function i1(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:ed,forEach:function(n,e,t){ed(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return ed(n,function(){e++}),e},toArray:function(n){return ed(n,function(e){return e})||[]},only:function(n){if(!Iy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Te.Component=Cl;Te.Fragment=Jb;Te.Profiler=eN;Te.PureComponent=wy;Te.StrictMode=Zb;Te.Suspense=sN;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hN;Te.act=i1;Te.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=ZS({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ey.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)n1.call(e,l)&&!r1.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:nh,type:n.type,key:s,ref:i,props:r,_owner:o}};Te.createContext=function(n){return n={$$typeof:nN,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:tN,_context:n},n.Consumer=n};Te.createElement=s1;Te.createFactory=function(n){var e=s1.bind(null,n);return e.type=n,e};Te.createRef=function(){return{current:null}};Te.forwardRef=function(n){return{$$typeof:rN,render:n}};Te.isValidElement=Iy;Te.lazy=function(n){return{$$typeof:oN,_payload:{_status:-1,_result:n},_init:cN}};Te.memo=function(n,e){return{$$typeof:iN,type:n,compare:e===void 0?null:e}};Te.startTransition=function(n){var e=Nd.transition;Nd.transition={};try{n()}finally{Nd.transition=e}};Te.unstable_act=i1;Te.useCallback=function(n,e){return un.current.useCallback(n,e)};Te.useContext=function(n){return un.current.useContext(n)};Te.useDebugValue=function(){};Te.useDeferredValue=function(n){return un.current.useDeferredValue(n)};Te.useEffect=function(n,e){return un.current.useEffect(n,e)};Te.useId=function(){return un.current.useId()};Te.useImperativeHandle=function(n,e,t){return un.current.useImperativeHandle(n,e,t)};Te.useInsertionEffect=function(n,e){return un.current.useInsertionEffect(n,e)};Te.useLayoutEffect=function(n,e){return un.current.useLayoutEffect(n,e)};Te.useMemo=function(n,e){return un.current.useMemo(n,e)};Te.useReducer=function(n,e,t){return un.current.useReducer(n,e,t)};Te.useRef=function(n){return un.current.useRef(n)};Te.useState=function(n){return un.current.useState(n)};Te.useSyncExternalStore=function(n,e,t){return un.current.useSyncExternalStore(n,e,t)};Te.useTransition=function(){return un.current.useTransition()};Te.version="18.3.1";XS.exports=Te;var q=XS.exports;const pt=Yb(q),dN=Qb({__proto__:null,default:pt},[q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fN=q,pN=Symbol.for("react.element"),mN=Symbol.for("react.fragment"),gN=Object.prototype.hasOwnProperty,_N=fN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yN={key:!0,ref:!0,__self:!0,__source:!0};function o1(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)gN.call(e,r)&&!yN.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:pN,type:n,key:i,ref:o,props:s,_owner:_N.current}}wp.Fragment=mN;wp.jsx=o1;wp.jsxs=o1;YS.exports=wp;var V=YS.exports,Pg={},a1={exports:{}},Ln={},l1={exports:{}},u1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(j,z){var G=j.length;j.push(z);e:for(;0<G;){var Z=G-1>>>1,le=j[Z];if(0<s(le,z))j[Z]=z,j[G]=le,G=Z;else break e}}function t(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var z=j[0],G=j.pop();if(G!==z){j[0]=G;e:for(var Z=0,le=j.length,dt=le>>>1;Z<dt;){var Le=2*(Z+1)-1,fe=j[Le],Ee=Le+1,Qe=j[Ee];if(0>s(fe,G))Ee<le&&0>s(Qe,fe)?(j[Z]=Qe,j[Ee]=G,Z=Ee):(j[Z]=fe,j[Le]=G,Z=Le);else if(Ee<le&&0>s(Qe,G))j[Z]=Qe,j[Ee]=G,Z=Ee;else break e}}return z}function s(j,z){var G=j.sortIndex-z.sortIndex;return G!==0?G:j.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,d=null,f=3,m=!1,g=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(j){for(var z=t(u);z!==null;){if(z.callback===null)r(u);else if(z.startTime<=j)r(u),z.sortIndex=z.expirationTime,e(l,z);else break;z=t(u)}}function N(j){if(w=!1,S(j),!g)if(t(l)!==null)g=!0,ee(P);else{var z=t(u);z!==null&&re(N,z.startTime-j)}}function P(j,z){g=!1,w&&(w=!1,y(v),v=-1),m=!0;var G=f;try{for(S(z),d=t(l);d!==null&&(!(d.expirationTime>z)||j&&!C());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,f=d.priorityLevel;var le=Z(d.expirationTime<=z);z=n.unstable_now(),typeof le=="function"?d.callback=le:d===t(l)&&r(l),S(z)}else r(l);d=t(l)}if(d!==null)var dt=!0;else{var Le=t(u);Le!==null&&re(N,Le.startTime-z),dt=!1}return dt}finally{d=null,f=G,m=!1}}var D=!1,I=null,v=-1,A=5,x=-1;function C(){return!(n.unstable_now()-x<A)}function b(){if(I!==null){var j=n.unstable_now();x=j;var z=!0;try{z=I(!0,j)}finally{z?R():(D=!1,I=null)}}else D=!1}var R;if(typeof T=="function")R=function(){T(b)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,se=W.port2;W.port1.onmessage=b,R=function(){se.postMessage(null)}}else R=function(){E(b,0)};function ee(j){I=j,D||(D=!0,R())}function re(j,z){v=E(function(){j(n.unstable_now())},z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(j){j.callback=null},n.unstable_continueExecution=function(){g||m||(g=!0,ee(P))},n.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<j?Math.floor(1e3/j):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(j){switch(f){case 1:case 2:case 3:var z=3;break;default:z=f}var G=f;f=z;try{return j()}finally{f=G}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(j,z){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var G=f;f=j;try{return z()}finally{f=G}},n.unstable_scheduleCallback=function(j,z,G){var Z=n.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Z+G:Z):G=Z,j){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=G+le,j={id:h++,callback:z,priorityLevel:j,startTime:G,expirationTime:le,sortIndex:-1},G>Z?(j.sortIndex=G,e(u,j),t(l)===null&&j===t(u)&&(w?(y(v),v=-1):w=!0,re(N,G-Z))):(j.sortIndex=le,e(l,j),g||m||(g=!0,ee(P))),j},n.unstable_shouldYield=C,n.unstable_wrapCallback=function(j){var z=f;return function(){var G=f;f=z;try{return j.apply(this,arguments)}finally{f=G}}}})(u1);l1.exports=u1;var vN=l1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wN=q,Vn=vN;function $(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c1=new Set,lc={};function Uo(n,e){qa(n,e),qa(n+"Capture",e)}function qa(n,e){for(lc[n]=e,n=0;n<e.length;n++)c1.add(e[n])}var Zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bg=Object.prototype.hasOwnProperty,TN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h0={},d0={};function EN(n){return bg.call(d0,n)?!0:bg.call(h0,n)?!1:TN.test(n)?d0[n]=!0:(h0[n]=!0,!1)}function IN(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function SN(n,e,t,r){if(e===null||typeof e>"u"||IN(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function cn(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Gt[n]=new cn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Gt[e]=new cn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Gt[n]=new cn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Gt[n]=new cn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Gt[n]=new cn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Gt[n]=new cn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Gt[n]=new cn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Gt[n]=new cn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Gt[n]=new cn(n,5,!1,n.toLowerCase(),null,!1,!1)});var Sy=/[\-:]([a-z])/g;function Ay(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Sy,Ay);Gt[e]=new cn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Sy,Ay);Gt[e]=new cn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Sy,Ay);Gt[e]=new cn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Gt[n]=new cn(n,1,!1,n.toLowerCase(),null,!1,!1)});Gt.xlinkHref=new cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Gt[n]=new cn(n,1,!1,n.toLowerCase(),null,!0,!0)});function Cy(n,e,t,r){var s=Gt.hasOwnProperty(e)?Gt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SN(e,t,s,r)&&(t=null),r||s===null?EN(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var cs=wN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,td=Symbol.for("react.element"),pa=Symbol.for("react.portal"),ma=Symbol.for("react.fragment"),xy=Symbol.for("react.strict_mode"),Ng=Symbol.for("react.profiler"),h1=Symbol.for("react.provider"),d1=Symbol.for("react.context"),ky=Symbol.for("react.forward_ref"),Dg=Symbol.for("react.suspense"),Vg=Symbol.for("react.suspense_list"),Ry=Symbol.for("react.memo"),Os=Symbol.for("react.lazy"),f1=Symbol.for("react.offscreen"),f0=Symbol.iterator;function pu(n){return n===null||typeof n!="object"?null:(n=f0&&n[f0]||n["@@iterator"],typeof n=="function"?n:null)}var ot=Object.assign,Um;function ku(n){if(Um===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Um=e&&e[1]||""}return`
`+Um+n}var jm=!1;function Bm(n,e){if(!n||jm)return"";jm=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{jm=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?ku(n):""}function AN(n){switch(n.tag){case 5:return ku(n.type);case 16:return ku("Lazy");case 13:return ku("Suspense");case 19:return ku("SuspenseList");case 0:case 2:case 15:return n=Bm(n.type,!1),n;case 11:return n=Bm(n.type.render,!1),n;case 1:return n=Bm(n.type,!0),n;default:return""}}function Og(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ma:return"Fragment";case pa:return"Portal";case Ng:return"Profiler";case xy:return"StrictMode";case Dg:return"Suspense";case Vg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case d1:return(n.displayName||"Context")+".Consumer";case h1:return(n._context.displayName||"Context")+".Provider";case ky:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Ry:return e=n.displayName||null,e!==null?e:Og(n.type)||"Memo";case Os:e=n._payload,n=n._init;try{return Og(n(e))}catch{}}return null}function CN(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Og(e);case 8:return e===xy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hi(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function p1(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xN(n){var e=p1(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function nd(n){n._valueTracker||(n._valueTracker=xN(n))}function m1(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=p1(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function of(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Mg(n,e){var t=e.checked;return ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function p0(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=hi(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function g1(n,e){e=e.checked,e!=null&&Cy(n,"checked",e,!1)}function Lg(n,e){g1(n,e);var t=hi(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Fg(n,e.type,t):e.hasOwnProperty("defaultValue")&&Fg(n,e.type,hi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function m0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Fg(n,e,t){(e!=="number"||of(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Ru=Array.isArray;function Ra(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+hi(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Ug(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return ot({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function g0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error($(92));if(Ru(t)){if(1<t.length)throw Error($(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:hi(t)}}function _1(n,e){var t=hi(e.value),r=hi(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function _0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function y1(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?y1(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var rd,v1=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(rd=rd||document.createElement("div"),rd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rd.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function uc(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Fu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kN=["Webkit","ms","Moz","O"];Object.keys(Fu).forEach(function(n){kN.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Fu[e]=Fu[n]})});function w1(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Fu.hasOwnProperty(n)&&Fu[n]?(""+e).trim():e+"px"}function T1(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=w1(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var RN=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bg(n,e){if(e){if(RN[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function zg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qg=null;function Py(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var $g=null,Pa=null,ba=null;function y0(n){if(n=ih(n)){if(typeof $g!="function")throw Error($(280));var e=n.stateNode;e&&(e=Ap(e),$g(n.stateNode,n.type,e))}}function E1(n){Pa?ba?ba.push(n):ba=[n]:Pa=n}function I1(){if(Pa){var n=Pa,e=ba;if(ba=Pa=null,y0(n),e)for(n=0;n<e.length;n++)y0(e[n])}}function S1(n,e){return n(e)}function A1(){}var zm=!1;function C1(n,e,t){if(zm)return n(e,t);zm=!0;try{return S1(n,e,t)}finally{zm=!1,(Pa!==null||ba!==null)&&(A1(),I1())}}function cc(n,e){var t=n.stateNode;if(t===null)return null;var r=Ap(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error($(231,e,typeof t));return t}var Wg=!1;if(Zr)try{var mu={};Object.defineProperty(mu,"passive",{get:function(){Wg=!0}}),window.addEventListener("test",mu,mu),window.removeEventListener("test",mu,mu)}catch{Wg=!1}function PN(n,e,t,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var Uu=!1,af=null,lf=!1,Gg=null,bN={onError:function(n){Uu=!0,af=n}};function NN(n,e,t,r,s,i,o,a,l){Uu=!1,af=null,PN.apply(bN,arguments)}function DN(n,e,t,r,s,i,o,a,l){if(NN.apply(this,arguments),Uu){if(Uu){var u=af;Uu=!1,af=null}else throw Error($(198));lf||(lf=!0,Gg=u)}}function jo(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function x1(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function v0(n){if(jo(n)!==n)throw Error($(188))}function VN(n){var e=n.alternate;if(!e){if(e=jo(n),e===null)throw Error($(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return v0(s),n;if(i===r)return v0(s),e;i=i.sibling}throw Error($(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error($(189))}}if(t.alternate!==r)throw Error($(190))}if(t.tag!==3)throw Error($(188));return t.stateNode.current===t?n:e}function k1(n){return n=VN(n),n!==null?R1(n):null}function R1(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=R1(n);if(e!==null)return e;n=n.sibling}return null}var P1=Vn.unstable_scheduleCallback,w0=Vn.unstable_cancelCallback,ON=Vn.unstable_shouldYield,MN=Vn.unstable_requestPaint,gt=Vn.unstable_now,LN=Vn.unstable_getCurrentPriorityLevel,by=Vn.unstable_ImmediatePriority,b1=Vn.unstable_UserBlockingPriority,uf=Vn.unstable_NormalPriority,FN=Vn.unstable_LowPriority,N1=Vn.unstable_IdlePriority,Tp=null,xr=null;function UN(n){if(xr&&typeof xr.onCommitFiberRoot=="function")try{xr.onCommitFiberRoot(Tp,n,void 0,(n.current.flags&128)===128)}catch{}}var sr=Math.clz32?Math.clz32:zN,jN=Math.log,BN=Math.LN2;function zN(n){return n>>>=0,n===0?32:31-(jN(n)/BN|0)|0}var sd=64,id=4194304;function Pu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function cf(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=Pu(a):(i&=o,i!==0&&(r=Pu(i)))}else o=t&~s,o!==0?r=Pu(o):i!==0&&(r=Pu(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-sr(e),s=1<<t,r|=n[t],e&=~s;return r}function qN(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $N(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-sr(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&r)&&(s[o]=qN(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function Hg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function D1(){var n=sd;return sd<<=1,!(sd&4194240)&&(sd=64),n}function qm(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function rh(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-sr(e),n[e]=t}function WN(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-sr(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function Ny(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-sr(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Pe=0;function V1(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var O1,Dy,M1,L1,F1,Kg=!1,od=[],Ys=null,Xs=null,Js=null,hc=new Map,dc=new Map,Fs=[],GN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function T0(n,e){switch(n){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":hc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":dc.delete(e.pointerId)}}function gu(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ih(e),e!==null&&Dy(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function HN(n,e,t,r,s){switch(e){case"focusin":return Ys=gu(Ys,n,e,t,r,s),!0;case"dragenter":return Xs=gu(Xs,n,e,t,r,s),!0;case"mouseover":return Js=gu(Js,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return hc.set(i,gu(hc.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,dc.set(i,gu(dc.get(i)||null,n,e,t,r,s)),!0}return!1}function U1(n){var e=so(n.target);if(e!==null){var t=jo(e);if(t!==null){if(e=t.tag,e===13){if(e=x1(t),e!==null){n.blockedOn=e,F1(n.priority,function(){M1(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Dd(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Qg(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);qg=r,t.target.dispatchEvent(r),qg=null}else return e=ih(t),e!==null&&Dy(e),n.blockedOn=t,!1;e.shift()}return!0}function E0(n,e,t){Dd(n)&&t.delete(e)}function KN(){Kg=!1,Ys!==null&&Dd(Ys)&&(Ys=null),Xs!==null&&Dd(Xs)&&(Xs=null),Js!==null&&Dd(Js)&&(Js=null),hc.forEach(E0),dc.forEach(E0)}function _u(n,e){n.blockedOn===e&&(n.blockedOn=null,Kg||(Kg=!0,Vn.unstable_scheduleCallback(Vn.unstable_NormalPriority,KN)))}function fc(n){function e(s){return _u(s,n)}if(0<od.length){_u(od[0],n);for(var t=1;t<od.length;t++){var r=od[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Ys!==null&&_u(Ys,n),Xs!==null&&_u(Xs,n),Js!==null&&_u(Js,n),hc.forEach(e),dc.forEach(e),t=0;t<Fs.length;t++)r=Fs[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Fs.length&&(t=Fs[0],t.blockedOn===null);)U1(t),t.blockedOn===null&&Fs.shift()}var Na=cs.ReactCurrentBatchConfig,hf=!0;function QN(n,e,t,r){var s=Pe,i=Na.transition;Na.transition=null;try{Pe=1,Vy(n,e,t,r)}finally{Pe=s,Na.transition=i}}function YN(n,e,t,r){var s=Pe,i=Na.transition;Na.transition=null;try{Pe=4,Vy(n,e,t,r)}finally{Pe=s,Na.transition=i}}function Vy(n,e,t,r){if(hf){var s=Qg(n,e,t,r);if(s===null)Zm(n,e,r,df,t),T0(n,r);else if(HN(s,n,e,t,r))r.stopPropagation();else if(T0(n,r),e&4&&-1<GN.indexOf(n)){for(;s!==null;){var i=ih(s);if(i!==null&&O1(i),i=Qg(n,e,t,r),i===null&&Zm(n,e,r,df,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else Zm(n,e,r,null,t)}}var df=null;function Qg(n,e,t,r){if(df=null,n=Py(r),n=so(n),n!==null)if(e=jo(n),e===null)n=null;else if(t=e.tag,t===13){if(n=x1(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return df=n,null}function j1(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LN()){case by:return 1;case b1:return 4;case uf:case FN:return 16;case N1:return 536870912;default:return 16}default:return 16}}var Ws=null,Oy=null,Vd=null;function B1(){if(Vd)return Vd;var n,e=Oy,t=e.length,r,s="value"in Ws?Ws.value:Ws.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Vd=s.slice(n,1<r?1-r:void 0)}function Od(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function ad(){return!0}function I0(){return!1}function Fn(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ad:I0,this.isPropagationStopped=I0,this}return ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ad)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ad)},persist:function(){},isPersistent:ad}),e}var xl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},My=Fn(xl),sh=ot({},xl,{view:0,detail:0}),XN=Fn(sh),$m,Wm,yu,Ep=ot({},sh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ly,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==yu&&(yu&&n.type==="mousemove"?($m=n.screenX-yu.screenX,Wm=n.screenY-yu.screenY):Wm=$m=0,yu=n),$m)},movementY:function(n){return"movementY"in n?n.movementY:Wm}}),S0=Fn(Ep),JN=ot({},Ep,{dataTransfer:0}),ZN=Fn(JN),eD=ot({},sh,{relatedTarget:0}),Gm=Fn(eD),tD=ot({},xl,{animationName:0,elapsedTime:0,pseudoElement:0}),nD=Fn(tD),rD=ot({},xl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),sD=Fn(rD),iD=ot({},xl,{data:0}),A0=Fn(iD),oD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uD(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=lD[n])?!!e[n]:!1}function Ly(){return uD}var cD=ot({},sh,{key:function(n){if(n.key){var e=oD[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Od(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?aD[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ly,charCode:function(n){return n.type==="keypress"?Od(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Od(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),hD=Fn(cD),dD=ot({},Ep,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C0=Fn(dD),fD=ot({},sh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ly}),pD=Fn(fD),mD=ot({},xl,{propertyName:0,elapsedTime:0,pseudoElement:0}),gD=Fn(mD),_D=ot({},Ep,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),yD=Fn(_D),vD=[9,13,27,32],Fy=Zr&&"CompositionEvent"in window,ju=null;Zr&&"documentMode"in document&&(ju=document.documentMode);var wD=Zr&&"TextEvent"in window&&!ju,z1=Zr&&(!Fy||ju&&8<ju&&11>=ju),x0=" ",k0=!1;function q1(n,e){switch(n){case"keyup":return vD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $1(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ga=!1;function TD(n,e){switch(n){case"compositionend":return $1(e);case"keypress":return e.which!==32?null:(k0=!0,x0);case"textInput":return n=e.data,n===x0&&k0?null:n;default:return null}}function ED(n,e){if(ga)return n==="compositionend"||!Fy&&q1(n,e)?(n=B1(),Vd=Oy=Ws=null,ga=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return z1&&e.locale!=="ko"?null:e.data;default:return null}}var ID={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function R0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!ID[n.type]:e==="textarea"}function W1(n,e,t,r){E1(r),e=ff(e,"onChange"),0<e.length&&(t=new My("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Bu=null,pc=null;function SD(n){nA(n,0)}function Ip(n){var e=va(n);if(m1(e))return n}function AD(n,e){if(n==="change")return e}var G1=!1;if(Zr){var Hm;if(Zr){var Km="oninput"in document;if(!Km){var P0=document.createElement("div");P0.setAttribute("oninput","return;"),Km=typeof P0.oninput=="function"}Hm=Km}else Hm=!1;G1=Hm&&(!document.documentMode||9<document.documentMode)}function b0(){Bu&&(Bu.detachEvent("onpropertychange",H1),pc=Bu=null)}function H1(n){if(n.propertyName==="value"&&Ip(pc)){var e=[];W1(e,pc,n,Py(n)),C1(SD,e)}}function CD(n,e,t){n==="focusin"?(b0(),Bu=e,pc=t,Bu.attachEvent("onpropertychange",H1)):n==="focusout"&&b0()}function xD(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ip(pc)}function kD(n,e){if(n==="click")return Ip(e)}function RD(n,e){if(n==="input"||n==="change")return Ip(e)}function PD(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var cr=typeof Object.is=="function"?Object.is:PD;function mc(n,e){if(cr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!bg.call(e,s)||!cr(n[s],e[s]))return!1}return!0}function N0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function D0(n,e){var t=N0(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=N0(t)}}function K1(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?K1(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Q1(){for(var n=window,e=of();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=of(n.document)}return e}function Uy(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function bD(n){var e=Q1(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&K1(t.ownerDocument.documentElement,t)){if(r!==null&&Uy(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=D0(t,i);var o=D0(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var ND=Zr&&"documentMode"in document&&11>=document.documentMode,_a=null,Yg=null,zu=null,Xg=!1;function V0(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Xg||_a==null||_a!==of(r)||(r=_a,"selectionStart"in r&&Uy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zu&&mc(zu,r)||(zu=r,r=ff(Yg,"onSelect"),0<r.length&&(e=new My("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=_a)))}function ld(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ya={animationend:ld("Animation","AnimationEnd"),animationiteration:ld("Animation","AnimationIteration"),animationstart:ld("Animation","AnimationStart"),transitionend:ld("Transition","TransitionEnd")},Qm={},Y1={};Zr&&(Y1=document.createElement("div").style,"AnimationEvent"in window||(delete ya.animationend.animation,delete ya.animationiteration.animation,delete ya.animationstart.animation),"TransitionEvent"in window||delete ya.transitionend.transition);function Sp(n){if(Qm[n])return Qm[n];if(!ya[n])return n;var e=ya[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Y1)return Qm[n]=e[t];return n}var X1=Sp("animationend"),J1=Sp("animationiteration"),Z1=Sp("animationstart"),eA=Sp("transitionend"),tA=new Map,O0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ai(n,e){tA.set(n,e),Uo(e,[n])}for(var Ym=0;Ym<O0.length;Ym++){var Xm=O0[Ym],DD=Xm.toLowerCase(),VD=Xm[0].toUpperCase()+Xm.slice(1);Ai(DD,"on"+VD)}Ai(X1,"onAnimationEnd");Ai(J1,"onAnimationIteration");Ai(Z1,"onAnimationStart");Ai("dblclick","onDoubleClick");Ai("focusin","onFocus");Ai("focusout","onBlur");Ai(eA,"onTransitionEnd");qa("onMouseEnter",["mouseout","mouseover"]);qa("onMouseLeave",["mouseout","mouseover"]);qa("onPointerEnter",["pointerout","pointerover"]);qa("onPointerLeave",["pointerout","pointerover"]);Uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OD=new Set("cancel close invalid load scroll toggle".split(" ").concat(bu));function M0(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,DN(r,e,void 0,n),n.currentTarget=null}function nA(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;M0(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;M0(s,a,u),i=l}}}if(lf)throw n=Gg,lf=!1,Gg=null,n}function qe(n,e){var t=e[n_];t===void 0&&(t=e[n_]=new Set);var r=n+"__bubble";t.has(r)||(rA(e,n,2,!1),t.add(r))}function Jm(n,e,t){var r=0;e&&(r|=4),rA(t,n,r,e)}var ud="_reactListening"+Math.random().toString(36).slice(2);function gc(n){if(!n[ud]){n[ud]=!0,c1.forEach(function(t){t!=="selectionchange"&&(OD.has(t)||Jm(t,!1,n),Jm(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[ud]||(e[ud]=!0,Jm("selectionchange",!1,e))}}function rA(n,e,t,r){switch(j1(e)){case 1:var s=QN;break;case 4:s=YN;break;default:s=Vy}t=s.bind(null,e,t,n),s=void 0,!Wg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function Zm(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=so(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}C1(function(){var u=i,h=Py(t),d=[];e:{var f=tA.get(n);if(f!==void 0){var m=My,g=n;switch(n){case"keypress":if(Od(t)===0)break e;case"keydown":case"keyup":m=hD;break;case"focusin":g="focus",m=Gm;break;case"focusout":g="blur",m=Gm;break;case"beforeblur":case"afterblur":m=Gm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=S0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ZN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=pD;break;case X1:case J1:case Z1:m=nD;break;case eA:m=gD;break;case"scroll":m=XN;break;case"wheel":m=yD;break;case"copy":case"cut":case"paste":m=sD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=C0}var w=(e&4)!==0,E=!w&&n==="scroll",y=w?f!==null?f+"Capture":null:f;w=[];for(var T=u,S;T!==null;){S=T;var N=S.stateNode;if(S.tag===5&&N!==null&&(S=N,y!==null&&(N=cc(T,y),N!=null&&w.push(_c(T,N,S)))),E)break;T=T.return}0<w.length&&(f=new m(f,g,null,t,h),d.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",f&&t!==qg&&(g=t.relatedTarget||t.fromElement)&&(so(g)||g[es]))break e;if((m||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=u,g=g?so(g):null,g!==null&&(E=jo(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(w=S0,N="onMouseLeave",y="onMouseEnter",T="mouse",(n==="pointerout"||n==="pointerover")&&(w=C0,N="onPointerLeave",y="onPointerEnter",T="pointer"),E=m==null?f:va(m),S=g==null?f:va(g),f=new w(N,T+"leave",m,t,h),f.target=E,f.relatedTarget=S,N=null,so(h)===u&&(w=new w(y,T+"enter",g,t,h),w.target=S,w.relatedTarget=E,N=w),E=N,m&&g)t:{for(w=m,y=g,T=0,S=w;S;S=na(S))T++;for(S=0,N=y;N;N=na(N))S++;for(;0<T-S;)w=na(w),T--;for(;0<S-T;)y=na(y),S--;for(;T--;){if(w===y||y!==null&&w===y.alternate)break t;w=na(w),y=na(y)}w=null}else w=null;m!==null&&L0(d,f,m,w,!1),g!==null&&E!==null&&L0(d,E,g,w,!0)}}e:{if(f=u?va(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var P=AD;else if(R0(f))if(G1)P=RD;else{P=xD;var D=CD}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=kD);if(P&&(P=P(n,u))){W1(d,P,t,h);break e}D&&D(n,f,u),n==="focusout"&&(D=f._wrapperState)&&D.controlled&&f.type==="number"&&Fg(f,"number",f.value)}switch(D=u?va(u):window,n){case"focusin":(R0(D)||D.contentEditable==="true")&&(_a=D,Yg=u,zu=null);break;case"focusout":zu=Yg=_a=null;break;case"mousedown":Xg=!0;break;case"contextmenu":case"mouseup":case"dragend":Xg=!1,V0(d,t,h);break;case"selectionchange":if(ND)break;case"keydown":case"keyup":V0(d,t,h)}var I;if(Fy)e:{switch(n){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else ga?q1(n,t)&&(v="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(v="onCompositionStart");v&&(z1&&t.locale!=="ko"&&(ga||v!=="onCompositionStart"?v==="onCompositionEnd"&&ga&&(I=B1()):(Ws=h,Oy="value"in Ws?Ws.value:Ws.textContent,ga=!0)),D=ff(u,v),0<D.length&&(v=new A0(v,n,null,t,h),d.push({event:v,listeners:D}),I?v.data=I:(I=$1(t),I!==null&&(v.data=I)))),(I=wD?TD(n,t):ED(n,t))&&(u=ff(u,"onBeforeInput"),0<u.length&&(h=new A0("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=I))}nA(d,e)})}function _c(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ff(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=cc(n,t),i!=null&&r.unshift(_c(n,i,s)),i=cc(n,e),i!=null&&r.push(_c(n,i,s))),n=n.return}return r}function na(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function L0(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=cc(t,i),l!=null&&o.unshift(_c(t,l,a))):s||(l=cc(t,i),l!=null&&o.push(_c(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var MD=/\r\n?/g,LD=/\u0000|\uFFFD/g;function F0(n){return(typeof n=="string"?n:""+n).replace(MD,`
`).replace(LD,"")}function cd(n,e,t){if(e=F0(e),F0(n)!==e&&t)throw Error($(425))}function pf(){}var Jg=null,Zg=null;function e_(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var t_=typeof setTimeout=="function"?setTimeout:void 0,FD=typeof clearTimeout=="function"?clearTimeout:void 0,U0=typeof Promise=="function"?Promise:void 0,UD=typeof queueMicrotask=="function"?queueMicrotask:typeof U0<"u"?function(n){return U0.resolve(null).then(n).catch(jD)}:t_;function jD(n){setTimeout(function(){throw n})}function eg(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),fc(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);fc(e)}function Zs(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function j0(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var kl=Math.random().toString(36).slice(2),Sr="__reactFiber$"+kl,yc="__reactProps$"+kl,es="__reactContainer$"+kl,n_="__reactEvents$"+kl,BD="__reactListeners$"+kl,zD="__reactHandles$"+kl;function so(n){var e=n[Sr];if(e)return e;for(var t=n.parentNode;t;){if(e=t[es]||t[Sr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=j0(n);n!==null;){if(t=n[Sr])return t;n=j0(n)}return e}n=t,t=n.parentNode}return null}function ih(n){return n=n[Sr]||n[es],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function va(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error($(33))}function Ap(n){return n[yc]||null}var r_=[],wa=-1;function Ci(n){return{current:n}}function He(n){0>wa||(n.current=r_[wa],r_[wa]=null,wa--)}function Ue(n,e){wa++,r_[wa]=n.current,n.current=e}var di={},tn=Ci(di),vn=Ci(!1),_o=di;function $a(n,e){var t=n.type.contextTypes;if(!t)return di;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function wn(n){return n=n.childContextTypes,n!=null}function mf(){He(vn),He(tn)}function B0(n,e,t){if(tn.current!==di)throw Error($(168));Ue(tn,e),Ue(vn,t)}function sA(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,CN(n)||"Unknown",s));return ot({},t,r)}function gf(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||di,_o=tn.current,Ue(tn,n),Ue(vn,vn.current),!0}function z0(n,e,t){var r=n.stateNode;if(!r)throw Error($(169));t?(n=sA(n,e,_o),r.__reactInternalMemoizedMergedChildContext=n,He(vn),He(tn),Ue(tn,n)):He(vn),Ue(vn,t)}var Br=null,Cp=!1,tg=!1;function iA(n){Br===null?Br=[n]:Br.push(n)}function qD(n){Cp=!0,iA(n)}function xi(){if(!tg&&Br!==null){tg=!0;var n=0,e=Pe;try{var t=Br;for(Pe=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Br=null,Cp=!1}catch(s){throw Br!==null&&(Br=Br.slice(n+1)),P1(by,xi),s}finally{Pe=e,tg=!1}}return null}var Ta=[],Ea=0,_f=null,yf=0,Un=[],jn=0,yo=null,qr=1,$r="";function Ki(n,e){Ta[Ea++]=yf,Ta[Ea++]=_f,_f=n,yf=e}function oA(n,e,t){Un[jn++]=qr,Un[jn++]=$r,Un[jn++]=yo,yo=n;var r=qr;n=$r;var s=32-sr(r)-1;r&=~(1<<s),t+=1;var i=32-sr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,qr=1<<32-sr(e)+s|t<<s|r,$r=i+n}else qr=1<<i|t<<s|r,$r=n}function jy(n){n.return!==null&&(Ki(n,1),oA(n,1,0))}function By(n){for(;n===_f;)_f=Ta[--Ea],Ta[Ea]=null,yf=Ta[--Ea],Ta[Ea]=null;for(;n===yo;)yo=Un[--jn],Un[jn]=null,$r=Un[--jn],Un[jn]=null,qr=Un[--jn],Un[jn]=null}var Nn=null,bn=null,Ze=!1,Zn=null;function aA(n,e){var t=Bn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function q0(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Nn=n,bn=Zs(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Nn=n,bn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=yo!==null?{id:qr,overflow:$r}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Bn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Nn=n,bn=null,!0):!1;default:return!1}}function s_(n){return(n.mode&1)!==0&&(n.flags&128)===0}function i_(n){if(Ze){var e=bn;if(e){var t=e;if(!q0(n,e)){if(s_(n))throw Error($(418));e=Zs(t.nextSibling);var r=Nn;e&&q0(n,e)?aA(r,t):(n.flags=n.flags&-4097|2,Ze=!1,Nn=n)}}else{if(s_(n))throw Error($(418));n.flags=n.flags&-4097|2,Ze=!1,Nn=n}}}function $0(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Nn=n}function hd(n){if(n!==Nn)return!1;if(!Ze)return $0(n),Ze=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!e_(n.type,n.memoizedProps)),e&&(e=bn)){if(s_(n))throw lA(),Error($(418));for(;e;)aA(n,e),e=Zs(e.nextSibling)}if($0(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error($(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){bn=Zs(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}bn=null}}else bn=Nn?Zs(n.stateNode.nextSibling):null;return!0}function lA(){for(var n=bn;n;)n=Zs(n.nextSibling)}function Wa(){bn=Nn=null,Ze=!1}function zy(n){Zn===null?Zn=[n]:Zn.push(n)}var $D=cs.ReactCurrentBatchConfig;function vu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error($(309));var r=t.stateNode}if(!r)throw Error($(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error($(284));if(!t._owner)throw Error($(290,n))}return n}function dd(n,e){throw n=Object.prototype.toString.call(e),Error($(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function W0(n){var e=n._init;return e(n._payload)}function uA(n){function e(y,T){if(n){var S=y.deletions;S===null?(y.deletions=[T],y.flags|=16):S.push(T)}}function t(y,T){if(!n)return null;for(;T!==null;)e(y,T),T=T.sibling;return null}function r(y,T){for(y=new Map;T!==null;)T.key!==null?y.set(T.key,T):y.set(T.index,T),T=T.sibling;return y}function s(y,T){return y=ri(y,T),y.index=0,y.sibling=null,y}function i(y,T,S){return y.index=S,n?(S=y.alternate,S!==null?(S=S.index,S<T?(y.flags|=2,T):S):(y.flags|=2,T)):(y.flags|=1048576,T)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function a(y,T,S,N){return T===null||T.tag!==6?(T=lg(S,y.mode,N),T.return=y,T):(T=s(T,S),T.return=y,T)}function l(y,T,S,N){var P=S.type;return P===ma?h(y,T,S.props.children,N,S.key):T!==null&&(T.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Os&&W0(P)===T.type)?(N=s(T,S.props),N.ref=vu(y,T,S),N.return=y,N):(N=zd(S.type,S.key,S.props,null,y.mode,N),N.ref=vu(y,T,S),N.return=y,N)}function u(y,T,S,N){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=ug(S,y.mode,N),T.return=y,T):(T=s(T,S.children||[]),T.return=y,T)}function h(y,T,S,N,P){return T===null||T.tag!==7?(T=ho(S,y.mode,N,P),T.return=y,T):(T=s(T,S),T.return=y,T)}function d(y,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=lg(""+T,y.mode,S),T.return=y,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case td:return S=zd(T.type,T.key,T.props,null,y.mode,S),S.ref=vu(y,null,T),S.return=y,S;case pa:return T=ug(T,y.mode,S),T.return=y,T;case Os:var N=T._init;return d(y,N(T._payload),S)}if(Ru(T)||pu(T))return T=ho(T,y.mode,S,null),T.return=y,T;dd(y,T)}return null}function f(y,T,S,N){var P=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return P!==null?null:a(y,T,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case td:return S.key===P?l(y,T,S,N):null;case pa:return S.key===P?u(y,T,S,N):null;case Os:return P=S._init,f(y,T,P(S._payload),N)}if(Ru(S)||pu(S))return P!==null?null:h(y,T,S,N,null);dd(y,S)}return null}function m(y,T,S,N,P){if(typeof N=="string"&&N!==""||typeof N=="number")return y=y.get(S)||null,a(T,y,""+N,P);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case td:return y=y.get(N.key===null?S:N.key)||null,l(T,y,N,P);case pa:return y=y.get(N.key===null?S:N.key)||null,u(T,y,N,P);case Os:var D=N._init;return m(y,T,S,D(N._payload),P)}if(Ru(N)||pu(N))return y=y.get(S)||null,h(T,y,N,P,null);dd(T,N)}return null}function g(y,T,S,N){for(var P=null,D=null,I=T,v=T=0,A=null;I!==null&&v<S.length;v++){I.index>v?(A=I,I=null):A=I.sibling;var x=f(y,I,S[v],N);if(x===null){I===null&&(I=A);break}n&&I&&x.alternate===null&&e(y,I),T=i(x,T,v),D===null?P=x:D.sibling=x,D=x,I=A}if(v===S.length)return t(y,I),Ze&&Ki(y,v),P;if(I===null){for(;v<S.length;v++)I=d(y,S[v],N),I!==null&&(T=i(I,T,v),D===null?P=I:D.sibling=I,D=I);return Ze&&Ki(y,v),P}for(I=r(y,I);v<S.length;v++)A=m(I,y,v,S[v],N),A!==null&&(n&&A.alternate!==null&&I.delete(A.key===null?v:A.key),T=i(A,T,v),D===null?P=A:D.sibling=A,D=A);return n&&I.forEach(function(C){return e(y,C)}),Ze&&Ki(y,v),P}function w(y,T,S,N){var P=pu(S);if(typeof P!="function")throw Error($(150));if(S=P.call(S),S==null)throw Error($(151));for(var D=P=null,I=T,v=T=0,A=null,x=S.next();I!==null&&!x.done;v++,x=S.next()){I.index>v?(A=I,I=null):A=I.sibling;var C=f(y,I,x.value,N);if(C===null){I===null&&(I=A);break}n&&I&&C.alternate===null&&e(y,I),T=i(C,T,v),D===null?P=C:D.sibling=C,D=C,I=A}if(x.done)return t(y,I),Ze&&Ki(y,v),P;if(I===null){for(;!x.done;v++,x=S.next())x=d(y,x.value,N),x!==null&&(T=i(x,T,v),D===null?P=x:D.sibling=x,D=x);return Ze&&Ki(y,v),P}for(I=r(y,I);!x.done;v++,x=S.next())x=m(I,y,v,x.value,N),x!==null&&(n&&x.alternate!==null&&I.delete(x.key===null?v:x.key),T=i(x,T,v),D===null?P=x:D.sibling=x,D=x);return n&&I.forEach(function(b){return e(y,b)}),Ze&&Ki(y,v),P}function E(y,T,S,N){if(typeof S=="object"&&S!==null&&S.type===ma&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case td:e:{for(var P=S.key,D=T;D!==null;){if(D.key===P){if(P=S.type,P===ma){if(D.tag===7){t(y,D.sibling),T=s(D,S.props.children),T.return=y,y=T;break e}}else if(D.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Os&&W0(P)===D.type){t(y,D.sibling),T=s(D,S.props),T.ref=vu(y,D,S),T.return=y,y=T;break e}t(y,D);break}else e(y,D);D=D.sibling}S.type===ma?(T=ho(S.props.children,y.mode,N,S.key),T.return=y,y=T):(N=zd(S.type,S.key,S.props,null,y.mode,N),N.ref=vu(y,T,S),N.return=y,y=N)}return o(y);case pa:e:{for(D=S.key;T!==null;){if(T.key===D)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){t(y,T.sibling),T=s(T,S.children||[]),T.return=y,y=T;break e}else{t(y,T);break}else e(y,T);T=T.sibling}T=ug(S,y.mode,N),T.return=y,y=T}return o(y);case Os:return D=S._init,E(y,T,D(S._payload),N)}if(Ru(S))return g(y,T,S,N);if(pu(S))return w(y,T,S,N);dd(y,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(t(y,T.sibling),T=s(T,S),T.return=y,y=T):(t(y,T),T=lg(S,y.mode,N),T.return=y,y=T),o(y)):t(y,T)}return E}var Ga=uA(!0),cA=uA(!1),vf=Ci(null),wf=null,Ia=null,qy=null;function $y(){qy=Ia=wf=null}function Wy(n){var e=vf.current;He(vf),n._currentValue=e}function o_(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Da(n,e){wf=n,qy=Ia=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(mn=!0),n.firstContext=null)}function Gn(n){var e=n._currentValue;if(qy!==n)if(n={context:n,memoizedValue:e,next:null},Ia===null){if(wf===null)throw Error($(308));Ia=n,wf.dependencies={lanes:0,firstContext:n}}else Ia=Ia.next=n;return e}var io=null;function Gy(n){io===null?io=[n]:io.push(n)}function hA(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,Gy(e)):(t.next=s.next,s.next=t),e.interleaved=t,ts(n,r)}function ts(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ms=!1;function Hy(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dA(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Qr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function ei(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Ce&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ts(n,t)}return s=r.interleaved,s===null?(e.next=e,Gy(r)):(e.next=s.next,s.next=e),r.interleaved=e,ts(n,t)}function Md(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Ny(n,t)}}function G0(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Tf(n,e,t,r){var s=n.updateQueue;Ms=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,h=u=l=null,a=i;do{var f=a.lane,m=a.eventTime;if((r&f)===f){h!==null&&(h=h.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=n,w=a;switch(f=e,m=t,w.tag){case 1:if(g=w.payload,typeof g=="function"){d=g.call(m,d,f);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=w.payload,f=typeof g=="function"?g.call(m,d,f):g,f==null)break e;d=ot({},d,f);break e;case 2:Ms=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else m={eventTime:m,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=m,l=d):h=h.next=m,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(h===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);wo|=o,n.lanes=o,n.memoizedState=d}}function H0(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error($(191,s));s.call(r)}}}var oh={},kr=Ci(oh),vc=Ci(oh),wc=Ci(oh);function oo(n){if(n===oh)throw Error($(174));return n}function Ky(n,e){switch(Ue(wc,e),Ue(vc,n),Ue(kr,oh),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:jg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=jg(e,n)}He(kr),Ue(kr,e)}function Ha(){He(kr),He(vc),He(wc)}function fA(n){oo(wc.current);var e=oo(kr.current),t=jg(e,n.type);e!==t&&(Ue(vc,n),Ue(kr,t))}function Qy(n){vc.current===n&&(He(kr),He(vc))}var st=Ci(0);function Ef(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ng=[];function Yy(){for(var n=0;n<ng.length;n++)ng[n]._workInProgressVersionPrimary=null;ng.length=0}var Ld=cs.ReactCurrentDispatcher,rg=cs.ReactCurrentBatchConfig,vo=0,it=null,At=null,Ot=null,If=!1,qu=!1,Tc=0,WD=0;function Kt(){throw Error($(321))}function Xy(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!cr(n[t],e[t]))return!1;return!0}function Jy(n,e,t,r,s,i){if(vo=i,it=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ld.current=n===null||n.memoizedState===null?QD:YD,n=t(r,s),qu){i=0;do{if(qu=!1,Tc=0,25<=i)throw Error($(301));i+=1,Ot=At=null,e.updateQueue=null,Ld.current=XD,n=t(r,s)}while(qu)}if(Ld.current=Sf,e=At!==null&&At.next!==null,vo=0,Ot=At=it=null,If=!1,e)throw Error($(300));return n}function Zy(){var n=Tc!==0;return Tc=0,n}function Tr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?it.memoizedState=Ot=n:Ot=Ot.next=n,Ot}function Hn(){if(At===null){var n=it.alternate;n=n!==null?n.memoizedState:null}else n=At.next;var e=Ot===null?it.memoizedState:Ot.next;if(e!==null)Ot=e,At=n;else{if(n===null)throw Error($(310));At=n,n={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Ot===null?it.memoizedState=Ot=n:Ot=Ot.next=n}return Ot}function Ec(n,e){return typeof e=="function"?e(n):e}function sg(n){var e=Hn(),t=e.queue;if(t===null)throw Error($(311));t.lastRenderedReducer=n;var r=At,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var h=u.lane;if((vo&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,it.lanes|=h,wo|=h}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,cr(r,e.memoizedState)||(mn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,it.lanes|=i,wo|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function ig(n){var e=Hn(),t=e.queue;if(t===null)throw Error($(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);cr(i,e.memoizedState)||(mn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function pA(){}function mA(n,e){var t=it,r=Hn(),s=e(),i=!cr(r.memoizedState,s);if(i&&(r.memoizedState=s,mn=!0),r=r.queue,ev(yA.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||Ot!==null&&Ot.memoizedState.tag&1){if(t.flags|=2048,Ic(9,_A.bind(null,t,r,s,e),void 0,null),Ft===null)throw Error($(349));vo&30||gA(t,e,s)}return s}function gA(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function _A(n,e,t,r){e.value=t,e.getSnapshot=r,vA(e)&&wA(n)}function yA(n,e,t){return t(function(){vA(e)&&wA(n)})}function vA(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!cr(n,t)}catch{return!0}}function wA(n){var e=ts(n,1);e!==null&&ir(e,n,1,-1)}function K0(n){var e=Tr();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ec,lastRenderedState:n},e.queue=n,n=n.dispatch=KD.bind(null,it,n),[e.memoizedState,n]}function Ic(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function TA(){return Hn().memoizedState}function Fd(n,e,t,r){var s=Tr();it.flags|=n,s.memoizedState=Ic(1|e,t,void 0,r===void 0?null:r)}function xp(n,e,t,r){var s=Hn();r=r===void 0?null:r;var i=void 0;if(At!==null){var o=At.memoizedState;if(i=o.destroy,r!==null&&Xy(r,o.deps)){s.memoizedState=Ic(e,t,i,r);return}}it.flags|=n,s.memoizedState=Ic(1|e,t,i,r)}function Q0(n,e){return Fd(8390656,8,n,e)}function ev(n,e){return xp(2048,8,n,e)}function EA(n,e){return xp(4,2,n,e)}function IA(n,e){return xp(4,4,n,e)}function SA(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function AA(n,e,t){return t=t!=null?t.concat([n]):null,xp(4,4,SA.bind(null,e,n),t)}function tv(){}function CA(n,e){var t=Hn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Xy(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function xA(n,e){var t=Hn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Xy(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function kA(n,e,t){return vo&21?(cr(t,e)||(t=D1(),it.lanes|=t,wo|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,mn=!0),n.memoizedState=t)}function GD(n,e){var t=Pe;Pe=t!==0&&4>t?t:4,n(!0);var r=rg.transition;rg.transition={};try{n(!1),e()}finally{Pe=t,rg.transition=r}}function RA(){return Hn().memoizedState}function HD(n,e,t){var r=ni(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},PA(n))bA(e,t);else if(t=hA(n,e,t,r),t!==null){var s=ln();ir(t,n,r,s),NA(t,e,r)}}function KD(n,e,t){var r=ni(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(PA(n))bA(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,cr(a,o)){var l=e.interleaved;l===null?(s.next=s,Gy(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=hA(n,e,s,r),t!==null&&(s=ln(),ir(t,n,r,s),NA(t,e,r))}}function PA(n){var e=n.alternate;return n===it||e!==null&&e===it}function bA(n,e){qu=If=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function NA(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Ny(n,t)}}var Sf={readContext:Gn,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},QD={readContext:Gn,useCallback:function(n,e){return Tr().memoizedState=[n,e===void 0?null:e],n},useContext:Gn,useEffect:Q0,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Fd(4194308,4,SA.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Fd(4194308,4,n,e)},useInsertionEffect:function(n,e){return Fd(4,2,n,e)},useMemo:function(n,e){var t=Tr();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Tr();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=HD.bind(null,it,n),[r.memoizedState,n]},useRef:function(n){var e=Tr();return n={current:n},e.memoizedState=n},useState:K0,useDebugValue:tv,useDeferredValue:function(n){return Tr().memoizedState=n},useTransition:function(){var n=K0(!1),e=n[0];return n=GD.bind(null,n[1]),Tr().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=it,s=Tr();if(Ze){if(t===void 0)throw Error($(407));t=t()}else{if(t=e(),Ft===null)throw Error($(349));vo&30||gA(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,Q0(yA.bind(null,r,i,n),[n]),r.flags|=2048,Ic(9,_A.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=Tr(),e=Ft.identifierPrefix;if(Ze){var t=$r,r=qr;t=(r&~(1<<32-sr(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Tc++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=WD++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},YD={readContext:Gn,useCallback:CA,useContext:Gn,useEffect:ev,useImperativeHandle:AA,useInsertionEffect:EA,useLayoutEffect:IA,useMemo:xA,useReducer:sg,useRef:TA,useState:function(){return sg(Ec)},useDebugValue:tv,useDeferredValue:function(n){var e=Hn();return kA(e,At.memoizedState,n)},useTransition:function(){var n=sg(Ec)[0],e=Hn().memoizedState;return[n,e]},useMutableSource:pA,useSyncExternalStore:mA,useId:RA,unstable_isNewReconciler:!1},XD={readContext:Gn,useCallback:CA,useContext:Gn,useEffect:ev,useImperativeHandle:AA,useInsertionEffect:EA,useLayoutEffect:IA,useMemo:xA,useReducer:ig,useRef:TA,useState:function(){return ig(Ec)},useDebugValue:tv,useDeferredValue:function(n){var e=Hn();return At===null?e.memoizedState=n:kA(e,At.memoizedState,n)},useTransition:function(){var n=ig(Ec)[0],e=Hn().memoizedState;return[n,e]},useMutableSource:pA,useSyncExternalStore:mA,useId:RA,unstable_isNewReconciler:!1};function Yn(n,e){if(n&&n.defaultProps){e=ot({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function a_(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:ot({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var kp={isMounted:function(n){return(n=n._reactInternals)?jo(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=ln(),s=ni(n),i=Qr(r,s);i.payload=e,t!=null&&(i.callback=t),e=ei(n,i,s),e!==null&&(ir(e,n,s,r),Md(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=ln(),s=ni(n),i=Qr(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=ei(n,i,s),e!==null&&(ir(e,n,s,r),Md(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=ln(),r=ni(n),s=Qr(t,r);s.tag=2,e!=null&&(s.callback=e),e=ei(n,s,r),e!==null&&(ir(e,n,r,t),Md(e,n,r))}};function Y0(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!mc(t,r)||!mc(s,i):!0}function DA(n,e,t){var r=!1,s=di,i=e.contextType;return typeof i=="object"&&i!==null?i=Gn(i):(s=wn(e)?_o:tn.current,r=e.contextTypes,i=(r=r!=null)?$a(n,s):di),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kp,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function X0(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&kp.enqueueReplaceState(e,e.state,null)}function l_(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Hy(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Gn(i):(i=wn(e)?_o:tn.current,s.context=$a(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(a_(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&kp.enqueueReplaceState(s,s.state,null),Tf(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Ka(n,e){try{var t="",r=e;do t+=AN(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function og(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function u_(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var JD=typeof WeakMap=="function"?WeakMap:Map;function VA(n,e,t){t=Qr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Cf||(Cf=!0,v_=r),u_(n,e)},t}function OA(n,e,t){t=Qr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){u_(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){u_(n,e),typeof r!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function J0(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new JD;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=dV.bind(null,n,e,t),e.then(n,n))}function Z0(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function eE(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Qr(-1,1),e.tag=2,ei(t,e,1))),t.lanes|=1),n)}var ZD=cs.ReactCurrentOwner,mn=!1;function sn(n,e,t,r){e.child=n===null?cA(e,null,t,r):Ga(e,n.child,t,r)}function tE(n,e,t,r,s){t=t.render;var i=e.ref;return Da(e,s),r=Jy(n,e,t,r,i,s),t=Zy(),n!==null&&!mn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ns(n,e,s)):(Ze&&t&&jy(e),e.flags|=1,sn(n,e,r,s),e.child)}function nE(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!uv(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,MA(n,e,i,r,s)):(n=zd(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:mc,t(o,r)&&n.ref===e.ref)return ns(n,e,s)}return e.flags|=1,n=ri(i,r),n.ref=e.ref,n.return=e,e.child=n}function MA(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(mc(i,r)&&n.ref===e.ref)if(mn=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(mn=!0);else return e.lanes=n.lanes,ns(n,e,s)}return c_(n,e,t,r,s)}function LA(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(Aa,kn),kn|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ue(Aa,kn),kn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Ue(Aa,kn),kn|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Ue(Aa,kn),kn|=r;return sn(n,e,s,t),e.child}function FA(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function c_(n,e,t,r,s){var i=wn(t)?_o:tn.current;return i=$a(e,i),Da(e,s),t=Jy(n,e,t,r,i,s),r=Zy(),n!==null&&!mn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ns(n,e,s)):(Ze&&r&&jy(e),e.flags|=1,sn(n,e,t,s),e.child)}function rE(n,e,t,r,s){if(wn(t)){var i=!0;gf(e)}else i=!1;if(Da(e,s),e.stateNode===null)Ud(n,e),DA(e,t,r),l_(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Gn(u):(u=wn(t)?_o:tn.current,u=$a(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&X0(e,o,r,u),Ms=!1;var f=e.memoizedState;o.state=f,Tf(e,r,o,s),l=e.memoizedState,a!==r||f!==l||vn.current||Ms?(typeof h=="function"&&(a_(e,t,h,r),l=e.memoizedState),(a=Ms||Y0(e,t,a,r,f,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,dA(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Yn(e.type,a),o.props=u,d=e.pendingProps,f=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Gn(l):(l=wn(t)?_o:tn.current,l=$a(e,l));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&X0(e,o,r,l),Ms=!1,f=e.memoizedState,o.state=f,Tf(e,r,o,s);var g=e.memoizedState;a!==d||f!==g||vn.current||Ms?(typeof m=="function"&&(a_(e,t,m,r),g=e.memoizedState),(u=Ms||Y0(e,t,u,r,f,g,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),r=!1)}return h_(n,e,t,r,i,s)}function h_(n,e,t,r,s,i){FA(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&z0(e,t,!1),ns(n,e,i);r=e.stateNode,ZD.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Ga(e,n.child,null,i),e.child=Ga(e,null,a,i)):sn(n,e,a,i),e.memoizedState=r.state,s&&z0(e,t,!0),e.child}function UA(n){var e=n.stateNode;e.pendingContext?B0(n,e.pendingContext,e.pendingContext!==e.context):e.context&&B0(n,e.context,!1),Ky(n,e.containerInfo)}function sE(n,e,t,r,s){return Wa(),zy(s),e.flags|=256,sn(n,e,t,r),e.child}var d_={dehydrated:null,treeContext:null,retryLane:0};function f_(n){return{baseLanes:n,cachePool:null,transitions:null}}function jA(n,e,t){var r=e.pendingProps,s=st.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Ue(st,s&1),n===null)return i_(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=bp(o,r,0,null),n=ho(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=f_(t),e.memoizedState=d_,n):nv(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return eV(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ri(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ri(a,i):(i=ho(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?f_(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=d_,r}return i=n.child,n=i.sibling,r=ri(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function nv(n,e){return e=bp({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function fd(n,e,t,r){return r!==null&&zy(r),Ga(e,n.child,null,t),n=nv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function eV(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=og(Error($(422))),fd(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=bp({mode:"visible",children:r.children},s,0,null),i=ho(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ga(e,n.child,null,o),e.child.memoizedState=f_(o),e.memoizedState=d_,i);if(!(e.mode&1))return fd(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error($(419)),r=og(i,r,void 0),fd(n,e,o,r)}if(a=(o&n.childLanes)!==0,mn||a){if(r=Ft,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ts(n,s),ir(r,n,s,-1))}return lv(),r=og(Error($(421))),fd(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=fV.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,bn=Zs(s.nextSibling),Nn=e,Ze=!0,Zn=null,n!==null&&(Un[jn++]=qr,Un[jn++]=$r,Un[jn++]=yo,qr=n.id,$r=n.overflow,yo=e),e=nv(e,r.children),e.flags|=4096,e)}function iE(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),o_(n.return,e,t)}function ag(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function BA(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(sn(n,e,r.children,t),r=st.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&iE(n,t,e);else if(n.tag===19)iE(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Ue(st,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Ef(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),ag(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Ef(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}ag(e,!0,t,null,i);break;case"together":ag(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ud(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ns(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),wo|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error($(153));if(e.child!==null){for(n=e.child,t=ri(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ri(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function tV(n,e,t){switch(e.tag){case 3:UA(e),Wa();break;case 5:fA(e);break;case 1:wn(e.type)&&gf(e);break;case 4:Ky(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ue(vf,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ue(st,st.current&1),e.flags|=128,null):t&e.child.childLanes?jA(n,e,t):(Ue(st,st.current&1),n=ns(n,e,t),n!==null?n.sibling:null);Ue(st,st.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return BA(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ue(st,st.current),r)break;return null;case 22:case 23:return e.lanes=0,LA(n,e,t)}return ns(n,e,t)}var zA,p_,qA,$A;zA=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};p_=function(){};qA=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,oo(kr.current);var i=null;switch(t){case"input":s=Mg(n,s),r=Mg(n,r),i=[];break;case"select":s=ot({},s,{value:void 0}),r=ot({},r,{value:void 0}),i=[];break;case"textarea":s=Ug(n,s),r=Ug(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=pf)}Bg(t,r);var o;t=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(lc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(lc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&qe("scroll",n),i||a===l||(i=[])):(i=i||[]).push(u,l))}t&&(i=i||[]).push("style",t);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};$A=function(n,e,t,r){t!==r&&(e.flags|=4)};function wu(n,e){if(!Ze)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Qt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function nV(n,e,t){var r=e.pendingProps;switch(By(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return wn(e.type)&&mf(),Qt(e),null;case 3:return r=e.stateNode,Ha(),He(vn),He(tn),Yy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(hd(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(E_(Zn),Zn=null))),p_(n,e),Qt(e),null;case 5:Qy(e);var s=oo(wc.current);if(t=e.type,n!==null&&e.stateNode!=null)qA(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return Qt(e),null}if(n=oo(kr.current),hd(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Sr]=e,r[yc]=i,n=(e.mode&1)!==0,t){case"dialog":qe("cancel",r),qe("close",r);break;case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(s=0;s<bu.length;s++)qe(bu[s],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"input":p0(r,i),qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},qe("invalid",r);break;case"textarea":g0(r,i),qe("invalid",r)}Bg(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&cd(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&cd(r.textContent,a,n),s=["children",""+a]):lc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&qe("scroll",r)}switch(t){case"input":nd(r),m0(r,i,!0);break;case"textarea":nd(r),_0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=pf)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=y1(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Sr]=e,n[yc]=r,zA(n,e,!1,!1),e.stateNode=n;e:{switch(o=zg(t,r),t){case"dialog":qe("cancel",n),qe("close",n),s=r;break;case"iframe":case"object":case"embed":qe("load",n),s=r;break;case"video":case"audio":for(s=0;s<bu.length;s++)qe(bu[s],n);s=r;break;case"source":qe("error",n),s=r;break;case"img":case"image":case"link":qe("error",n),qe("load",n),s=r;break;case"details":qe("toggle",n),s=r;break;case"input":p0(n,r),s=Mg(n,r),qe("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=ot({},r,{value:void 0}),qe("invalid",n);break;case"textarea":g0(n,r),s=Ug(n,r),qe("invalid",n);break;default:s=r}Bg(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?T1(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&v1(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&uc(n,l):typeof l=="number"&&uc(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(lc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&qe("scroll",n):l!=null&&Cy(n,i,l,o))}switch(t){case"input":nd(n),m0(n,r,!1);break;case"textarea":nd(n),_0(n);break;case"option":r.value!=null&&n.setAttribute("value",""+hi(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?Ra(n,!!r.multiple,i,!1):r.defaultValue!=null&&Ra(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=pf)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(n&&e.stateNode!=null)$A(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(t=oo(wc.current),oo(kr.current),hd(e)){if(r=e.stateNode,t=e.memoizedProps,r[Sr]=e,(i=r.nodeValue!==t)&&(n=Nn,n!==null))switch(n.tag){case 3:cd(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&cd(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Sr]=e,e.stateNode=r}return Qt(e),null;case 13:if(He(st),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ze&&bn!==null&&e.mode&1&&!(e.flags&128))lA(),Wa(),e.flags|=98560,i=!1;else if(i=hd(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[Sr]=e}else Wa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),i=!1}else Zn!==null&&(E_(Zn),Zn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||st.current&1?Ct===0&&(Ct=3):lv())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return Ha(),p_(n,e),n===null&&gc(e.stateNode.containerInfo),Qt(e),null;case 10:return Wy(e.type._context),Qt(e),null;case 17:return wn(e.type)&&mf(),Qt(e),null;case 19:if(He(st),i=e.memoizedState,i===null)return Qt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)wu(i,!1);else{if(Ct!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Ef(n),o!==null){for(e.flags|=128,wu(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ue(st,st.current&1|2),e.child}n=n.sibling}i.tail!==null&&gt()>Qa&&(e.flags|=128,r=!0,wu(i,!1),e.lanes=4194304)}else{if(!r)if(n=Ef(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),wu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ze)return Qt(e),null}else 2*gt()-i.renderingStartTime>Qa&&t!==1073741824&&(e.flags|=128,r=!0,wu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=gt(),e.sibling=null,t=st.current,Ue(st,r?t&1|2:t&1),e):(Qt(e),null);case 22:case 23:return av(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?kn&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function rV(n,e){switch(By(e),e.tag){case 1:return wn(e.type)&&mf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Ha(),He(vn),He(tn),Yy(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Qy(e),null;case 13:if(He(st),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error($(340));Wa()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return He(st),null;case 4:return Ha(),null;case 10:return Wy(e.type._context),null;case 22:case 23:return av(),null;case 24:return null;default:return null}}var pd=!1,Jt=!1,sV=typeof WeakSet=="function"?WeakSet:Set,te=null;function Sa(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){ct(n,e,r)}else t.current=null}function m_(n,e,t){try{t()}catch(r){ct(n,e,r)}}var oE=!1;function iV(n,e){if(Jg=hf,n=Q1(),Uy(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,h=0,d=n,f=null;t:for(;;){for(var m;d!==t||s!==0&&d.nodeType!==3||(a=o+s),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(m=d.firstChild)!==null;)f=d,d=m;for(;;){if(d===n)break t;if(f===t&&++u===s&&(a=o),f===i&&++h===r&&(l=o),(m=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Zg={focusedElem:n,selectionRange:t},hf=!1,te=e;te!==null;)if(e=te,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,te=n;else for(;te!==null;){e=te;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var w=g.memoizedProps,E=g.memoizedState,y=e.stateNode,T=y.getSnapshotBeforeUpdate(e.elementType===e.type?w:Yn(e.type,w),E);y.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(N){ct(e,e.return,N)}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}return g=oE,oE=!1,g}function $u(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&m_(e,t,i)}s=s.next}while(s!==r)}}function Rp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function g_(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function WA(n){var e=n.alternate;e!==null&&(n.alternate=null,WA(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Sr],delete e[yc],delete e[n_],delete e[BD],delete e[zD])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function GA(n){return n.tag===5||n.tag===3||n.tag===4}function aE(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||GA(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function __(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=pf));else if(r!==4&&(n=n.child,n!==null))for(__(n,e,t),n=n.sibling;n!==null;)__(n,e,t),n=n.sibling}function y_(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(y_(n,e,t),n=n.sibling;n!==null;)y_(n,e,t),n=n.sibling}var qt=null,Xn=!1;function ks(n,e,t){for(t=t.child;t!==null;)HA(n,e,t),t=t.sibling}function HA(n,e,t){if(xr&&typeof xr.onCommitFiberUnmount=="function")try{xr.onCommitFiberUnmount(Tp,t)}catch{}switch(t.tag){case 5:Jt||Sa(t,e);case 6:var r=qt,s=Xn;qt=null,ks(n,e,t),qt=r,Xn=s,qt!==null&&(Xn?(n=qt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):qt.removeChild(t.stateNode));break;case 18:qt!==null&&(Xn?(n=qt,t=t.stateNode,n.nodeType===8?eg(n.parentNode,t):n.nodeType===1&&eg(n,t),fc(n)):eg(qt,t.stateNode));break;case 4:r=qt,s=Xn,qt=t.stateNode.containerInfo,Xn=!0,ks(n,e,t),qt=r,Xn=s;break;case 0:case 11:case 14:case 15:if(!Jt&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&m_(t,e,o),s=s.next}while(s!==r)}ks(n,e,t);break;case 1:if(!Jt&&(Sa(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){ct(t,e,a)}ks(n,e,t);break;case 21:ks(n,e,t);break;case 22:t.mode&1?(Jt=(r=Jt)||t.memoizedState!==null,ks(n,e,t),Jt=r):ks(n,e,t);break;default:ks(n,e,t)}}function lE(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new sV),e.forEach(function(r){var s=pV.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Qn(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,Xn=!1;break e;case 3:qt=a.stateNode.containerInfo,Xn=!0;break e;case 4:qt=a.stateNode.containerInfo,Xn=!0;break e}a=a.return}if(qt===null)throw Error($(160));HA(i,o,s),qt=null,Xn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){ct(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)KA(e,n),e=e.sibling}function KA(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Qn(e,n),wr(n),r&4){try{$u(3,n,n.return),Rp(3,n)}catch(w){ct(n,n.return,w)}try{$u(5,n,n.return)}catch(w){ct(n,n.return,w)}}break;case 1:Qn(e,n),wr(n),r&512&&t!==null&&Sa(t,t.return);break;case 5:if(Qn(e,n),wr(n),r&512&&t!==null&&Sa(t,t.return),n.flags&32){var s=n.stateNode;try{uc(s,"")}catch(w){ct(n,n.return,w)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&g1(s,i),zg(a,o);var u=zg(a,i);for(o=0;o<l.length;o+=2){var h=l[o],d=l[o+1];h==="style"?T1(s,d):h==="dangerouslySetInnerHTML"?v1(s,d):h==="children"?uc(s,d):Cy(s,h,d,u)}switch(a){case"input":Lg(s,i);break;case"textarea":_1(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Ra(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ra(s,!!i.multiple,i.defaultValue,!0):Ra(s,!!i.multiple,i.multiple?[]:"",!1))}s[yc]=i}catch(w){ct(n,n.return,w)}}break;case 6:if(Qn(e,n),wr(n),r&4){if(n.stateNode===null)throw Error($(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(w){ct(n,n.return,w)}}break;case 3:if(Qn(e,n),wr(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{fc(e.containerInfo)}catch(w){ct(n,n.return,w)}break;case 4:Qn(e,n),wr(n);break;case 13:Qn(e,n),wr(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(iv=gt())),r&4&&lE(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Jt=(u=Jt)||h,Qn(e,n),Jt=u):Qn(e,n),wr(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(te=n,h=n.child;h!==null;){for(d=te=h;te!==null;){switch(f=te,m=f.child,f.tag){case 0:case 11:case 14:case 15:$u(4,f,f.return);break;case 1:Sa(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,t=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(w){ct(r,t,w)}}break;case 5:Sa(f,f.return);break;case 22:if(f.memoizedState!==null){cE(d);continue}}m!==null?(m.return=f,te=m):cE(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{s=d.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=w1("display",o))}catch(w){ct(n,n.return,w)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(w){ct(n,n.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Qn(e,n),wr(n),r&4&&lE(n);break;case 21:break;default:Qn(e,n),wr(n)}}function wr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(GA(t)){var r=t;break e}t=t.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(uc(s,""),r.flags&=-33);var i=aE(n);y_(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=aE(n);__(n,a,o);break;default:throw Error($(161))}}catch(l){ct(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function oV(n,e,t){te=n,QA(n)}function QA(n,e,t){for(var r=(n.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||pd;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Jt;a=pd;var u=Jt;if(pd=o,(Jt=l)&&!u)for(te=s;te!==null;)o=te,l=o.child,o.tag===22&&o.memoizedState!==null?hE(s):l!==null?(l.return=o,te=l):hE(s);for(;i!==null;)te=i,QA(i),i=i.sibling;te=s,pd=a,Jt=u}uE(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):uE(n)}}function uE(n){for(;te!==null;){var e=te;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jt||Rp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jt)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Yn(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&H0(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}H0(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&fc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}Jt||e.flags&512&&g_(e)}catch(f){ct(e,e.return,f)}}if(e===n){te=null;break}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}}function cE(n){for(;te!==null;){var e=te;if(e===n){te=null;break}var t=e.sibling;if(t!==null){t.return=e.return,te=t;break}te=e.return}}function hE(n){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Rp(4,e)}catch(l){ct(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){ct(e,s,l)}}var i=e.return;try{g_(e)}catch(l){ct(e,i,l)}break;case 5:var o=e.return;try{g_(e)}catch(l){ct(e,o,l)}}}catch(l){ct(e,e.return,l)}if(e===n){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var aV=Math.ceil,Af=cs.ReactCurrentDispatcher,rv=cs.ReactCurrentOwner,qn=cs.ReactCurrentBatchConfig,Ce=0,Ft=null,Et=null,Wt=0,kn=0,Aa=Ci(0),Ct=0,Sc=null,wo=0,Pp=0,sv=0,Wu=null,dn=null,iv=0,Qa=1/0,Ur=null,Cf=!1,v_=null,ti=null,md=!1,Gs=null,xf=0,Gu=0,w_=null,jd=-1,Bd=0;function ln(){return Ce&6?gt():jd!==-1?jd:jd=gt()}function ni(n){return n.mode&1?Ce&2&&Wt!==0?Wt&-Wt:$D.transition!==null?(Bd===0&&(Bd=D1()),Bd):(n=Pe,n!==0||(n=window.event,n=n===void 0?16:j1(n.type)),n):1}function ir(n,e,t,r){if(50<Gu)throw Gu=0,w_=null,Error($(185));rh(n,t,r),(!(Ce&2)||n!==Ft)&&(n===Ft&&(!(Ce&2)&&(Pp|=t),Ct===4&&Us(n,Wt)),Tn(n,r),t===1&&Ce===0&&!(e.mode&1)&&(Qa=gt()+500,Cp&&xi()))}function Tn(n,e){var t=n.callbackNode;$N(n,e);var r=cf(n,n===Ft?Wt:0);if(r===0)t!==null&&w0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&w0(t),e===1)n.tag===0?qD(dE.bind(null,n)):iA(dE.bind(null,n)),UD(function(){!(Ce&6)&&xi()}),t=null;else{switch(V1(r)){case 1:t=by;break;case 4:t=b1;break;case 16:t=uf;break;case 536870912:t=N1;break;default:t=uf}t=rC(t,YA.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function YA(n,e){if(jd=-1,Bd=0,Ce&6)throw Error($(327));var t=n.callbackNode;if(Va()&&n.callbackNode!==t)return null;var r=cf(n,n===Ft?Wt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=kf(n,r);else{e=r;var s=Ce;Ce|=2;var i=JA();(Ft!==n||Wt!==e)&&(Ur=null,Qa=gt()+500,co(n,e));do try{cV();break}catch(a){XA(n,a)}while(!0);$y(),Af.current=i,Ce=s,Et!==null?e=0:(Ft=null,Wt=0,e=Ct)}if(e!==0){if(e===2&&(s=Hg(n),s!==0&&(r=s,e=T_(n,s))),e===1)throw t=Sc,co(n,0),Us(n,r),Tn(n,gt()),t;if(e===6)Us(n,r);else{if(s=n.current.alternate,!(r&30)&&!lV(s)&&(e=kf(n,r),e===2&&(i=Hg(n),i!==0&&(r=i,e=T_(n,i))),e===1))throw t=Sc,co(n,0),Us(n,r),Tn(n,gt()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Qi(n,dn,Ur);break;case 3:if(Us(n,r),(r&130023424)===r&&(e=iv+500-gt(),10<e)){if(cf(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){ln(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=t_(Qi.bind(null,n,dn,Ur),e);break}Qi(n,dn,Ur);break;case 4:if(Us(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-sr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aV(r/1960))-r,10<r){n.timeoutHandle=t_(Qi.bind(null,n,dn,Ur),r);break}Qi(n,dn,Ur);break;case 5:Qi(n,dn,Ur);break;default:throw Error($(329))}}}return Tn(n,gt()),n.callbackNode===t?YA.bind(null,n):null}function T_(n,e){var t=Wu;return n.current.memoizedState.isDehydrated&&(co(n,e).flags|=256),n=kf(n,e),n!==2&&(e=dn,dn=t,e!==null&&E_(e)),n}function E_(n){dn===null?dn=n:dn.push.apply(dn,n)}function lV(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!cr(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Us(n,e){for(e&=~sv,e&=~Pp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-sr(e),r=1<<t;n[t]=-1,e&=~r}}function dE(n){if(Ce&6)throw Error($(327));Va();var e=cf(n,0);if(!(e&1))return Tn(n,gt()),null;var t=kf(n,e);if(n.tag!==0&&t===2){var r=Hg(n);r!==0&&(e=r,t=T_(n,r))}if(t===1)throw t=Sc,co(n,0),Us(n,e),Tn(n,gt()),t;if(t===6)throw Error($(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Qi(n,dn,Ur),Tn(n,gt()),null}function ov(n,e){var t=Ce;Ce|=1;try{return n(e)}finally{Ce=t,Ce===0&&(Qa=gt()+500,Cp&&xi())}}function To(n){Gs!==null&&Gs.tag===0&&!(Ce&6)&&Va();var e=Ce;Ce|=1;var t=qn.transition,r=Pe;try{if(qn.transition=null,Pe=1,n)return n()}finally{Pe=r,qn.transition=t,Ce=e,!(Ce&6)&&xi()}}function av(){kn=Aa.current,He(Aa)}function co(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,FD(t)),Et!==null)for(t=Et.return;t!==null;){var r=t;switch(By(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&mf();break;case 3:Ha(),He(vn),He(tn),Yy();break;case 5:Qy(r);break;case 4:Ha();break;case 13:He(st);break;case 19:He(st);break;case 10:Wy(r.type._context);break;case 22:case 23:av()}t=t.return}if(Ft=n,Et=n=ri(n.current,null),Wt=kn=e,Ct=0,Sc=null,sv=Pp=wo=0,dn=Wu=null,io!==null){for(e=0;e<io.length;e++)if(t=io[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}io=null}return n}function XA(n,e){do{var t=Et;try{if($y(),Ld.current=Sf,If){for(var r=it.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}If=!1}if(vo=0,Ot=At=it=null,qu=!1,Tc=0,rv.current=null,t===null||t.return===null){Ct=1,Sc=e,Et=null;break}e:{var i=n,o=t.return,a=t,l=e;if(e=Wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Z0(o);if(m!==null){m.flags&=-257,eE(m,o,a,i,e),m.mode&1&&J0(i,u,e),e=m,l=u;var g=e.updateQueue;if(g===null){var w=new Set;w.add(l),e.updateQueue=w}else g.add(l);break e}else{if(!(e&1)){J0(i,u,e),lv();break e}l=Error($(426))}}else if(Ze&&a.mode&1){var E=Z0(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),eE(E,o,a,i,e),zy(Ka(l,a));break e}}i=l=Ka(l,a),Ct!==4&&(Ct=2),Wu===null?Wu=[i]:Wu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=VA(i,l,e);G0(i,y);break e;case 1:a=l;var T=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ti===null||!ti.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=OA(i,a,e);G0(i,N);break e}}i=i.return}while(i!==null)}eC(t)}catch(P){e=P,Et===t&&t!==null&&(Et=t=t.return);continue}break}while(!0)}function JA(){var n=Af.current;return Af.current=Sf,n===null?Sf:n}function lv(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Ft===null||!(wo&268435455)&&!(Pp&268435455)||Us(Ft,Wt)}function kf(n,e){var t=Ce;Ce|=2;var r=JA();(Ft!==n||Wt!==e)&&(Ur=null,co(n,e));do try{uV();break}catch(s){XA(n,s)}while(!0);if($y(),Ce=t,Af.current=r,Et!==null)throw Error($(261));return Ft=null,Wt=0,Ct}function uV(){for(;Et!==null;)ZA(Et)}function cV(){for(;Et!==null&&!ON();)ZA(Et)}function ZA(n){var e=nC(n.alternate,n,kn);n.memoizedProps=n.pendingProps,e===null?eC(n):Et=e,rv.current=null}function eC(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=rV(t,e),t!==null){t.flags&=32767,Et=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ct=6,Et=null;return}}else if(t=nV(t,e,kn),t!==null){Et=t;return}if(e=e.sibling,e!==null){Et=e;return}Et=e=n}while(e!==null);Ct===0&&(Ct=5)}function Qi(n,e,t){var r=Pe,s=qn.transition;try{qn.transition=null,Pe=1,hV(n,e,t,r)}finally{qn.transition=s,Pe=r}return null}function hV(n,e,t,r){do Va();while(Gs!==null);if(Ce&6)throw Error($(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error($(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(WN(n,i),n===Ft&&(Et=Ft=null,Wt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||md||(md=!0,rC(uf,function(){return Va(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=qn.transition,qn.transition=null;var o=Pe;Pe=1;var a=Ce;Ce|=4,rv.current=null,iV(n,t),KA(t,n),bD(Zg),hf=!!Jg,Zg=Jg=null,n.current=t,oV(t),MN(),Ce=a,Pe=o,qn.transition=i}else n.current=t;if(md&&(md=!1,Gs=n,xf=s),i=n.pendingLanes,i===0&&(ti=null),UN(t.stateNode),Tn(n,gt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(Cf)throw Cf=!1,n=v_,v_=null,n;return xf&1&&n.tag!==0&&Va(),i=n.pendingLanes,i&1?n===w_?Gu++:(Gu=0,w_=n):Gu=0,xi(),null}function Va(){if(Gs!==null){var n=V1(xf),e=qn.transition,t=Pe;try{if(qn.transition=null,Pe=16>n?16:n,Gs===null)var r=!1;else{if(n=Gs,Gs=null,xf=0,Ce&6)throw Error($(331));var s=Ce;for(Ce|=4,te=n.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(te=u;te!==null;){var h=te;switch(h.tag){case 0:case 11:case 15:$u(8,h,i)}var d=h.child;if(d!==null)d.return=h,te=d;else for(;te!==null;){h=te;var f=h.sibling,m=h.return;if(WA(h),h===u){te=null;break}if(f!==null){f.return=m,te=f;break}te=m}}}var g=i.alternate;if(g!==null){var w=g.child;if(w!==null){g.child=null;do{var E=w.sibling;w.sibling=null,w=E}while(w!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:$u(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,te=y;break e}te=i.return}}var T=n.current;for(te=T;te!==null;){o=te;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,te=S;else e:for(o=T;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Rp(9,a)}}catch(P){ct(a,a.return,P)}if(a===o){te=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,te=N;break e}te=a.return}}if(Ce=s,xi(),xr&&typeof xr.onPostCommitFiberRoot=="function")try{xr.onPostCommitFiberRoot(Tp,n)}catch{}r=!0}return r}finally{Pe=t,qn.transition=e}}return!1}function fE(n,e,t){e=Ka(t,e),e=VA(n,e,1),n=ei(n,e,1),e=ln(),n!==null&&(rh(n,1,e),Tn(n,e))}function ct(n,e,t){if(n.tag===3)fE(n,n,t);else for(;e!==null;){if(e.tag===3){fE(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ti===null||!ti.has(r))){n=Ka(t,n),n=OA(e,n,1),e=ei(e,n,1),n=ln(),e!==null&&(rh(e,1,n),Tn(e,n));break}}e=e.return}}function dV(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=ln(),n.pingedLanes|=n.suspendedLanes&t,Ft===n&&(Wt&t)===t&&(Ct===4||Ct===3&&(Wt&130023424)===Wt&&500>gt()-iv?co(n,0):sv|=t),Tn(n,e)}function tC(n,e){e===0&&(n.mode&1?(e=id,id<<=1,!(id&130023424)&&(id=4194304)):e=1);var t=ln();n=ts(n,e),n!==null&&(rh(n,e,t),Tn(n,t))}function fV(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),tC(n,t)}function pV(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),tC(n,t)}var nC;nC=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||vn.current)mn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return mn=!1,tV(n,e,t);mn=!!(n.flags&131072)}else mn=!1,Ze&&e.flags&1048576&&oA(e,yf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ud(n,e),n=e.pendingProps;var s=$a(e,tn.current);Da(e,t),s=Jy(null,e,r,n,s,t);var i=Zy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wn(r)?(i=!0,gf(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hy(e),s.updater=kp,e.stateNode=s,s._reactInternals=e,l_(e,r,n,t),e=h_(null,e,r,!0,i,t)):(e.tag=0,Ze&&i&&jy(e),sn(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Ud(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=gV(r),n=Yn(r,n),s){case 0:e=c_(null,e,r,n,t);break e;case 1:e=rE(null,e,r,n,t);break e;case 11:e=tE(null,e,r,n,t);break e;case 14:e=nE(null,e,r,Yn(r.type,n),t);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),c_(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),rE(n,e,r,s,t);case 3:e:{if(UA(e),n===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,dA(n,e),Tf(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ka(Error($(423)),e),e=sE(n,e,r,t,s);break e}else if(r!==s){s=Ka(Error($(424)),e),e=sE(n,e,r,t,s);break e}else for(bn=Zs(e.stateNode.containerInfo.firstChild),Nn=e,Ze=!0,Zn=null,t=cA(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Wa(),r===s){e=ns(n,e,t);break e}sn(n,e,r,t)}e=e.child}return e;case 5:return fA(e),n===null&&i_(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,e_(r,s)?o=null:i!==null&&e_(r,i)&&(e.flags|=32),FA(n,e),sn(n,e,o,t),e.child;case 6:return n===null&&i_(e),null;case 13:return jA(n,e,t);case 4:return Ky(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Ga(e,null,r,t):sn(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),tE(n,e,r,s,t);case 7:return sn(n,e,e.pendingProps,t),e.child;case 8:return sn(n,e,e.pendingProps.children,t),e.child;case 12:return sn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ue(vf,r._currentValue),r._currentValue=o,i!==null)if(cr(i.value,o)){if(i.children===s.children&&!vn.current){e=ns(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Qr(-1,t&-t),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),o_(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),o_(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}sn(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Da(e,t),s=Gn(s),r=r(s),e.flags|=1,sn(n,e,r,t),e.child;case 14:return r=e.type,s=Yn(r,e.pendingProps),s=Yn(r.type,s),nE(n,e,r,s,t);case 15:return MA(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),Ud(n,e),e.tag=1,wn(r)?(n=!0,gf(e)):n=!1,Da(e,t),DA(e,r,s),l_(e,r,s,t),h_(null,e,r,!0,n,t);case 19:return BA(n,e,t);case 22:return LA(n,e,t)}throw Error($(156,e.tag))};function rC(n,e){return P1(n,e)}function mV(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(n,e,t,r){return new mV(n,e,t,r)}function uv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function gV(n){if(typeof n=="function")return uv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ky)return 11;if(n===Ry)return 14}return 2}function ri(n,e){var t=n.alternate;return t===null?(t=Bn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function zd(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")uv(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case ma:return ho(t.children,s,i,e);case xy:o=8,s|=8;break;case Ng:return n=Bn(12,t,e,s|2),n.elementType=Ng,n.lanes=i,n;case Dg:return n=Bn(13,t,e,s),n.elementType=Dg,n.lanes=i,n;case Vg:return n=Bn(19,t,e,s),n.elementType=Vg,n.lanes=i,n;case f1:return bp(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case h1:o=10;break e;case d1:o=9;break e;case ky:o=11;break e;case Ry:o=14;break e;case Os:o=16,r=null;break e}throw Error($(130,n==null?n:typeof n,""))}return e=Bn(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function ho(n,e,t,r){return n=Bn(7,n,r,e),n.lanes=t,n}function bp(n,e,t,r){return n=Bn(22,n,r,e),n.elementType=f1,n.lanes=t,n.stateNode={isHidden:!1},n}function lg(n,e,t){return n=Bn(6,n,null,e),n.lanes=t,n}function ug(n,e,t){return e=Bn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function _V(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qm(0),this.expirationTimes=qm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qm(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function cv(n,e,t,r,s,i,o,a,l){return n=new _V(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Bn(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hy(i),n}function yV(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pa,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function sC(n){if(!n)return di;n=n._reactInternals;e:{if(jo(n)!==n||n.tag!==1)throw Error($(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(n.tag===1){var t=n.type;if(wn(t))return sA(n,t,e)}return e}function iC(n,e,t,r,s,i,o,a,l){return n=cv(t,r,!0,n,s,i,o,a,l),n.context=sC(null),t=n.current,r=ln(),s=ni(t),i=Qr(r,s),i.callback=e??null,ei(t,i,s),n.current.lanes=s,rh(n,s,r),Tn(n,r),n}function Np(n,e,t,r){var s=e.current,i=ln(),o=ni(s);return t=sC(t),e.context===null?e.context=t:e.pendingContext=t,e=Qr(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=ei(s,e,o),n!==null&&(ir(n,s,o,i),Md(n,s,o)),o}function Rf(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function pE(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function hv(n,e){pE(n,e),(n=n.alternate)&&pE(n,e)}function vV(){return null}var oC=typeof reportError=="function"?reportError:function(n){console.error(n)};function dv(n){this._internalRoot=n}Dp.prototype.render=dv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error($(409));Np(n,e,null,null)};Dp.prototype.unmount=dv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;To(function(){Np(null,n,null,null)}),e[es]=null}};function Dp(n){this._internalRoot=n}Dp.prototype.unstable_scheduleHydration=function(n){if(n){var e=L1();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Fs.length&&e!==0&&e<Fs[t].priority;t++);Fs.splice(t,0,n),t===0&&U1(n)}};function fv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Vp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function mE(){}function wV(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Rf(o);i.call(u)}}var o=iC(e,r,n,0,null,!1,!1,"",mE);return n._reactRootContainer=o,n[es]=o.current,gc(n.nodeType===8?n.parentNode:n),To(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=Rf(l);a.call(u)}}var l=cv(n,0,!1,null,null,!1,!1,"",mE);return n._reactRootContainer=l,n[es]=l.current,gc(n.nodeType===8?n.parentNode:n),To(function(){Np(e,l,t,r)}),l}function Op(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Rf(o);a.call(l)}}Np(e,o,n,s)}else o=wV(t,e,n,s,r);return Rf(o)}O1=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Pu(e.pendingLanes);t!==0&&(Ny(e,t|1),Tn(e,gt()),!(Ce&6)&&(Qa=gt()+500,xi()))}break;case 13:To(function(){var r=ts(n,1);if(r!==null){var s=ln();ir(r,n,1,s)}}),hv(n,1)}};Dy=function(n){if(n.tag===13){var e=ts(n,134217728);if(e!==null){var t=ln();ir(e,n,134217728,t)}hv(n,134217728)}};M1=function(n){if(n.tag===13){var e=ni(n),t=ts(n,e);if(t!==null){var r=ln();ir(t,n,e,r)}hv(n,e)}};L1=function(){return Pe};F1=function(n,e){var t=Pe;try{return Pe=n,e()}finally{Pe=t}};$g=function(n,e,t){switch(e){case"input":if(Lg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=Ap(r);if(!s)throw Error($(90));m1(r),Lg(r,s)}}}break;case"textarea":_1(n,t);break;case"select":e=t.value,e!=null&&Ra(n,!!t.multiple,e,!1)}};S1=ov;A1=To;var TV={usingClientEntryPoint:!1,Events:[ih,va,Ap,E1,I1,ov]},Tu={findFiberByHostInstance:so,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EV={bundleType:Tu.bundleType,version:Tu.version,rendererPackageName:Tu.rendererPackageName,rendererConfig:Tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=k1(n),n===null?null:n.stateNode},findFiberByHostInstance:Tu.findFiberByHostInstance||vV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gd.isDisabled&&gd.supportsFiber)try{Tp=gd.inject(EV),xr=gd}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TV;Ln.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fv(e))throw Error($(200));return yV(n,e,null,t)};Ln.createRoot=function(n,e){if(!fv(n))throw Error($(299));var t=!1,r="",s=oC;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=cv(n,1,!1,null,null,t,!1,r,s),n[es]=e.current,gc(n.nodeType===8?n.parentNode:n),new dv(e)};Ln.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error($(188)):(n=Object.keys(n).join(","),Error($(268,n)));return n=k1(e),n=n===null?null:n.stateNode,n};Ln.flushSync=function(n){return To(n)};Ln.hydrate=function(n,e,t){if(!Vp(e))throw Error($(200));return Op(null,n,e,!0,t)};Ln.hydrateRoot=function(n,e,t){if(!fv(n))throw Error($(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=oC;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=iC(e,null,n,1,t??null,s,!1,i,o),n[es]=e.current,gc(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Dp(e)};Ln.render=function(n,e,t){if(!Vp(e))throw Error($(200));return Op(null,n,e,!1,t)};Ln.unmountComponentAtNode=function(n){if(!Vp(n))throw Error($(40));return n._reactRootContainer?(To(function(){Op(null,null,n,!1,function(){n._reactRootContainer=null,n[es]=null})}),!0):!1};Ln.unstable_batchedUpdates=ov;Ln.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Vp(t))throw Error($(200));if(n==null||n._reactInternals===void 0)throw Error($(38));return Op(n,e,t,!1,r)};Ln.version="18.3.1-next-f1338f8080-20240426";function aC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aC)}catch(n){console.error(n)}}aC(),a1.exports=Ln;var IV=a1.exports,gE=IV;Pg.createRoot=gE.createRoot,Pg.hydrateRoot=gE.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ac(){return Ac=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ac.apply(this,arguments)}var Hs;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Hs||(Hs={}));const _E="popstate";function SV(n){n===void 0&&(n={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return I_("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Pf(s)}return CV(e,t,null,n)}function yt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function pv(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function AV(){return Math.random().toString(36).substr(2,8)}function yE(n,e){return{usr:n.state,key:n.key,idx:e}}function I_(n,e,t,r){return t===void 0&&(t=null),Ac({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Rl(e):e,{state:t,key:e&&e.key||r||AV()})}function Pf(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Rl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function CV(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Hs.Pop,l=null,u=h();u==null&&(u=0,o.replaceState(Ac({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function d(){a=Hs.Pop;let E=h(),y=E==null?null:E-u;u=E,l&&l({action:a,location:w.location,delta:y})}function f(E,y){a=Hs.Push;let T=I_(w.location,E,y);u=h()+1;let S=yE(T,u),N=w.createHref(T);try{o.pushState(S,"",N)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(N)}i&&l&&l({action:a,location:w.location,delta:1})}function m(E,y){a=Hs.Replace;let T=I_(w.location,E,y);u=h();let S=yE(T,u),N=w.createHref(T);o.replaceState(S,"",N),i&&l&&l({action:a,location:w.location,delta:0})}function g(E){let y=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof E=="string"?E:Pf(E);return T=T.replace(/ $/,"%20"),yt(y,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,y)}let w={get action(){return a},get location(){return n(s,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(_E,d),l=E,()=>{s.removeEventListener(_E,d),l=null}},createHref(E){return e(s,E)},createURL:g,encodeLocation(E){let y=g(E);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:m,go(E){return o.go(E)}};return w}var vE;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(vE||(vE={}));function xV(n,e,t){return t===void 0&&(t="/"),kV(n,e,t)}function kV(n,e,t,r){let s=typeof e=="string"?Rl(e):e,i=mv(s.pathname||"/",t);if(i==null)return null;let o=lC(n);RV(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=BV(i);a=FV(o[l],u)}return a}function lC(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(yt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=si([r,l.relativePath]),h=t.concat(l);i.children&&i.children.length>0&&(yt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),lC(i.children,e,h,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:MV(u,i.index),routesMeta:h})};return n.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of uC(i.path))s(i,o,l)}),e}function uC(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=uC(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function RV(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:LV(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const PV=/^:[\w-]+$/,bV=3,NV=2,DV=1,VV=10,OV=-2,wE=n=>n==="*";function MV(n,e){let t=n.split("/"),r=t.length;return t.some(wE)&&(r+=OV),e&&(r+=NV),t.filter(s=>!wE(s)).reduce((s,i)=>s+(PV.test(i)?bV:i===""?DV:VV),r)}function LV(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function FV(n,e,t){let{routesMeta:r}=n,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",d=UV({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},h),f=l.route;if(!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:si([i,d.pathname]),pathnameBase:GV(si([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=si([i,d.pathnameBase]))}return o}function UV(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=jV(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,h,d)=>{let{paramName:f,isOptional:m}=h;if(f==="*"){let w=a[d]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const g=a[d];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:n}}function jV(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),pv(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function BV(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return pv(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function mv(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const zV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qV=n=>zV.test(n);function $V(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Rl(n):n,i;if(t)if(qV(t))i=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),pv(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?i=TE(t.substring(1),"/"):i=TE(t,e)}else i=e;return{pathname:i,search:HV(r),hash:KV(s)}}function TE(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function cg(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function WV(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function gv(n,e){let t=WV(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function _v(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=Rl(n):(s=Ac({},n),yt(!s.pathname||!s.pathname.includes("?"),cg("?","pathname","search",s)),yt(!s.pathname||!s.pathname.includes("#"),cg("#","pathname","hash",s)),yt(!s.search||!s.search.includes("#"),cg("#","search","hash",s)));let i=n===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=$V(s,a),u=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}const si=n=>n.join("/").replace(/\/\/+/g,"/"),GV=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),HV=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,KV=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function QV(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const cC=["post","put","patch","delete"];new Set(cC);const YV=["get",...cC];new Set(YV);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cc(){return Cc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Cc.apply(this,arguments)}const yv=q.createContext(null),XV=q.createContext(null),ki=q.createContext(null),Mp=q.createContext(null),hs=q.createContext({outlet:null,matches:[],isDataRoute:!1}),hC=q.createContext(null);function JV(n,e){let{relative:t}=e===void 0?{}:e;Pl()||yt(!1);let{basename:r,navigator:s}=q.useContext(ki),{hash:i,pathname:o,search:a}=fC(n,{relative:t}),l=o;return r!=="/"&&(l=o==="/"?r:si([r,o])),s.createHref({pathname:l,search:a,hash:i})}function Pl(){return q.useContext(Mp)!=null}function bl(){return Pl()||yt(!1),q.useContext(Mp).location}function dC(n){q.useContext(ki).static||q.useLayoutEffect(n)}function ah(){let{isDataRoute:n}=q.useContext(hs);return n?f2():ZV()}function ZV(){Pl()||yt(!1);let n=q.useContext(yv),{basename:e,future:t,navigator:r}=q.useContext(ki),{matches:s}=q.useContext(hs),{pathname:i}=bl(),o=JSON.stringify(gv(s,t.v7_relativeSplatPath)),a=q.useRef(!1);return dC(()=>{a.current=!0}),q.useCallback(function(u,h){if(h===void 0&&(h={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let d=_v(u,JSON.parse(o),i,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:si([e,d.pathname])),(h.replace?r.replace:r.push)(d,h.state,h)},[e,r,o,i,n])}const e2=q.createContext(null);function t2(n){let e=q.useContext(hs).outlet;return e&&q.createElement(e2.Provider,{value:n},e)}function fC(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=q.useContext(ki),{matches:s}=q.useContext(hs),{pathname:i}=bl(),o=JSON.stringify(gv(s,r.v7_relativeSplatPath));return q.useMemo(()=>_v(n,JSON.parse(o),i,t==="path"),[n,o,i,t])}function n2(n,e){return r2(n,e)}function r2(n,e,t,r){Pl()||yt(!1);let{navigator:s}=q.useContext(ki),{matches:i}=q.useContext(hs),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=bl(),h;if(e){var d;let E=typeof e=="string"?Rl(e):e;l==="/"||(d=E.pathname)!=null&&d.startsWith(l)||yt(!1),h=E}else h=u;let f=h.pathname||"/",m=f;if(l!=="/"){let E=l.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(E.length).join("/")}let g=xV(n,{pathname:m}),w=l2(g&&g.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:si([l,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?l:si([l,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,t,r);return e&&w?q.createElement(Mp.Provider,{value:{location:Cc({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Hs.Pop}},w):w}function s2(){let n=d2(),e=QV(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),t?q.createElement("pre",{style:s},t):null,null)}const i2=q.createElement(s2,null);class o2 extends q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?q.createElement(hs.Provider,{value:this.props.routeContext},q.createElement(hC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function a2(n){let{routeContext:e,match:t,children:r}=n,s=q.useContext(yv);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),q.createElement(hs.Provider,{value:e},r)}function l2(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(s=t)==null?void 0:s.errors;if(a!=null){let h=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);h>=0||yt(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,u=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:m}=t,g=d.route.loader&&f[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,d,f)=>{let m,g=!1,w=null,E=null;t&&(m=a&&d.route.id?a[d.route.id]:void 0,w=d.route.errorElement||i2,l&&(u<0&&f===0?(p2("route-fallback"),g=!0,E=null):u===f&&(g=!0,E=d.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,f+1)),T=()=>{let S;return m?S=w:g?S=E:d.route.Component?S=q.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=h,q.createElement(a2,{match:d,routeContext:{outlet:h,matches:y,isDataRoute:t!=null},children:S})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?q.createElement(o2,{location:t.location,revalidation:t.revalidation,component:w,error:m,children:T(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):T()},null)}var pC=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(pC||{}),mC=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(mC||{});function u2(n){let e=q.useContext(yv);return e||yt(!1),e}function c2(n){let e=q.useContext(XV);return e||yt(!1),e}function h2(n){let e=q.useContext(hs);return e||yt(!1),e}function gC(n){let e=h2(),t=e.matches[e.matches.length-1];return t.route.id||yt(!1),t.route.id}function d2(){var n;let e=q.useContext(hC),t=c2(),r=gC();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function f2(){let{router:n}=u2(pC.UseNavigateStable),e=gC(mC.UseNavigateStable),t=q.useRef(!1);return dC(()=>{t.current=!0}),q.useCallback(function(s,i){i===void 0&&(i={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Cc({fromRouteId:e},i)))},[n,e])}const EE={};function p2(n,e,t){EE[n]||(EE[n]=!0)}function m2(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function hg(n){let{to:e,replace:t,state:r,relative:s}=n;Pl()||yt(!1);let{future:i,static:o}=q.useContext(ki),{matches:a}=q.useContext(hs),{pathname:l}=bl(),u=ah(),h=_v(e,gv(a,i.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(h);return q.useEffect(()=>u(JSON.parse(d),{replace:t,state:r,relative:s}),[u,d,s,t,r]),null}function g2(n){return t2(n.context)}function Vs(n){yt(!1)}function _2(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Hs.Pop,navigator:i,static:o=!1,future:a}=n;Pl()&&yt(!1);let l=e.replace(/^\/*/,"/"),u=q.useMemo(()=>({basename:l,navigator:i,static:o,future:Cc({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Rl(r));let{pathname:h="/",search:d="",hash:f="",state:m=null,key:g="default"}=r,w=q.useMemo(()=>{let E=mv(h,l);return E==null?null:{location:{pathname:E,search:d,hash:f,state:m,key:g},navigationType:s}},[l,h,d,f,m,g,s]);return w==null?null:q.createElement(ki.Provider,{value:u},q.createElement(Mp.Provider,{children:t,value:w}))}function y2(n){let{children:e,location:t}=n;return n2(S_(e),t)}new Promise(()=>{});function S_(n,e){e===void 0&&(e=[]);let t=[];return q.Children.forEach(n,(r,s)=>{if(!q.isValidElement(r))return;let i=[...e,s];if(r.type===q.Fragment){t.push.apply(t,S_(r.props.children,i));return}r.type!==Vs&&yt(!1),!r.props.index||!r.props.children||yt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=S_(r.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function A_(){return A_=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},A_.apply(this,arguments)}function v2(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function w2(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function T2(n,e){return n.button===0&&(!e||e==="_self")&&!w2(n)}const E2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],I2="6";try{window.__reactRouterVersion=I2}catch{}const S2="startTransition",IE=dN[S2];function A2(n){let{basename:e,children:t,future:r,window:s}=n,i=q.useRef();i.current==null&&(i.current=SV({window:s,v5Compat:!0}));let o=i.current,[a,l]=q.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},h=q.useCallback(d=>{u&&IE?IE(()=>l(d)):l(d)},[l,u]);return q.useLayoutEffect(()=>o.listen(h),[o,h]),q.useEffect(()=>m2(r),[r]),q.createElement(_2,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}const C2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",x2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_d=q.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:u,preventScrollReset:h,viewTransition:d}=e,f=v2(e,E2),{basename:m}=q.useContext(ki),g,w=!1;if(typeof u=="string"&&x2.test(u)&&(g=u,C2))try{let S=new URL(window.location.href),N=u.startsWith("//")?new URL(S.protocol+u):new URL(u),P=mv(N.pathname,m);N.origin===S.origin&&P!=null?u=P+N.search+N.hash:w=!0}catch{}let E=JV(u,{relative:s}),y=k2(u,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:d});function T(S){r&&r(S),S.defaultPrevented||y(S)}return q.createElement("a",A_({},f,{href:g||E,onClick:w||i?r:T,ref:t,target:l}))});var SE;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(SE||(SE={}));var AE;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(AE||(AE={}));function k2(n,e){let{target:t,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=ah(),u=bl(),h=fC(n,{relative:o});return q.useCallback(d=>{if(T2(d,t)){d.preventDefault();let f=r!==void 0?r:Pf(u)===Pf(h);l(n,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[u,l,h,r,s,t,n,i,o,a])}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var R2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),bt=(n,e)=>{const t=q.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:l,...u},h)=>q.createElement("svg",{ref:h,...R2,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${P2(n)}`,a].join(" "),...u},[...e.map(([d,f])=>q.createElement(d,f)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=bt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=bt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=bt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=bt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _C=bt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=bt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=bt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=bt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=bt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=bt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=bt("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=bt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=bt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=bt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=bt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=bt("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=bt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=bt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=bt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),H2=()=>{const{user:n}=q.useContext(Jo),t=(()=>{var i;((i=n==null?void 0:n.traumas)==null?void 0:i.length)>0;const r=[...(n==null?void 0:n.positive)||[],...(n==null?void 0:n.traumas)||[]],s=[{type:"music",title:"Melancholy Lo-Fi",subtitle:"To soothe your anxiety",icon:V.jsx(dg,{}),url:"https://open.spotify.com/playlist/37i9dQZF1DX8Ueb9CidzhR"},{type:"news",title:"Understanding Attachment",subtitle:"Psychology Today",icon:V.jsx($2,{}),url:"https://www.psychologytoday.com"},{type:"podcast",title:"The Trauma Cleanup",subtitle:"Episode 4: Healing",icon:V.jsx(CE,{}),url:"https://open.spotify.com/show/2v8IqRTMhM5vL6z8v6m5kO"}];return(r.includes("Anxiety")||r.includes("Melancholic"))&&s.unshift({type:"music",title:"Deep Focus Ambient",subtitle:"Calm for the mind",icon:V.jsx(dg,{}),url:"https://open.spotify.com/playlist/37i9dQZF1DX4sWspn04Zq1"}),(r.includes("Creative Soul")||r.includes("Passionate"))&&s.unshift({type:"podcast",title:"Creative Pep Talk",subtitle:"Fuel your fire",icon:V.jsx(CE,{}),url:"https://open.spotify.com/show/6pC9C7vN7Y5XqYpY9n5J2Y"}),s})();return V.jsxs("div",{className:"page-container",children:[V.jsx("h1",{style:{color:"var(--color-secondary)",fontSize:"2.2rem",marginBottom:"2rem",textAlign:"center",fontWeight:"800"},children:"Welcome Home"}),V.jsxs("section",{style:{marginBottom:"3rem"},children:[V.jsx("h3",{style:{marginBottom:"1.2rem",color:"var(--color-accent)",textTransform:"uppercase",fontSize:"0.8rem",letterSpacing:"2px",fontWeight:"bold"},children:"Daily Mood Mix"}),V.jsx("div",{style:{display:"flex",overflowX:"auto",gap:"1.2rem",paddingBottom:"1rem",scrollSnapType:"x mandatory"},children:[1,2,3].map(r=>V.jsxs("div",{style:{minWidth:"160px",height:"160px",flex:"0 0 auto",scrollSnapAlign:"start",backgroundColor:"rgba(100, 255, 218, 0.05)",borderRadius:"16px",display:"flex",flexDirection:"column",justifyContent:"flex-end",padding:"15px",border:"1px solid rgba(100, 255, 218, 0.1)",position:"relative",overflow:"hidden"},children:[V.jsx("div",{style:{position:"absolute",top:"15px",left:"15px",color:"var(--color-accent)"},children:V.jsx(dg,{size:20})}),V.jsxs("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:["Vibe ",r]})]},r))})]}),V.jsxs("section",{children:[V.jsx("h3",{style:{marginBottom:"1.2rem",color:"var(--color-accent)",textTransform:"uppercase",fontSize:"0.8rem",letterSpacing:"2px",fontWeight:"bold"},children:"Curated For Your Soul"}),V.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1.2rem"},children:t.map((r,s)=>V.jsxs("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",style:{backgroundColor:"rgba(255,255,255,0.03)",padding:"1.2rem",borderRadius:"16px",display:"flex",alignItems:"center",gap:"15px",border:"1px solid rgba(255,255,255,0.05)",transition:"transform 0.2s, background 0.2s",cursor:"pointer",textDecoration:"none",color:"inherit"},onMouseOver:i=>i.currentTarget.style.backgroundColor="rgba(255,255,255,0.06)",onMouseOut:i=>i.currentTarget.style.backgroundColor="rgba(255,255,255,0.03)",children:[V.jsx("div",{style:{width:"48px",height:"48px",minWidth:"48px",borderRadius:"12px",backgroundColor:"rgba(100,255,218,0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-accent)"},children:r.icon}),V.jsxs("div",{style:{overflow:"hidden"},children:[V.jsx("div",{style:{fontWeight:"bold",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:r.title}),V.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:r.subtitle})]})]},s))})]})]})},K2=()=>{};var xE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Q2=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},vC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,u=l?n[s+2]:0,h=i>>2,d=(i&3)<<4|a>>4;let f=(a&15)<<2|u>>6,m=u&63;l||(m=64,o||(f=64)),r.push(t[h],t[d],t[f],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(yC(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Q2(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||u==null||d==null)throw new Y2;const f=i<<2|a>>4;if(r.push(f),u!==64){const m=a<<4&240|u>>2;if(r.push(m),d!==64){const g=u<<6&192|d;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Y2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const X2=function(n){const e=yC(n);return vC.encodeByteArray(e,!0)},bf=function(n){return X2(n).replace(/\./g,"")},wC=function(n){try{return vC.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2=()=>TC().__FIREBASE_DEFAULTS__,Z2=()=>{if(typeof process>"u"||typeof xE>"u")return;const n=xE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},eO=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wC(n[1]);return e&&JSON.parse(e)},Lp=()=>{try{return K2()||J2()||Z2()||eO()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},EC=n=>{var e,t;return(t=(e=Lp())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},tO=n=>{const e=EC(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},IC=()=>{var n;return(n=Lp())==null?void 0:n.config},SC=n=>{var e;return(e=Lp())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function vv(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[bf(JSON.stringify(t)),bf(JSON.stringify(o)),""].join(".")}const Hu={};function sO(){const n={prod:[],emulator:[]};for(const e of Object.keys(Hu))Hu[e]?n.emulator.push(e):n.prod.push(e);return n}function iO(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let kE=!1;function AC(n,e){if(typeof window>"u"||typeof document>"u"||!Bo(window.location.host)||Hu[n]===e||Hu[n]||kE)return;Hu[n]=e;function t(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=sO().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{kE=!0,o()},f}function h(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=iO(r),m=t("text"),g=document.getElementById(m)||document.createElement("span"),w=t("learnmore"),E=document.getElementById(w)||document.createElement("a"),y=t("preprendIcon"),T=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const S=f.element;a(S),h(E,w);const N=u();l(T,y),S.append(T,g,E,N),document.body.appendChild(S)}i?(g.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xt())}function CC(){var e;const n=(e=Lp())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function aO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lO(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function uO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cO(){const n=xt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function xC(){return!CC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kC(){return!CC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function RC(){try{return typeof indexedDB=="object"}catch{return!1}}function hO(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO="FirebaseError";class ds extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=dO,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lh.prototype.create)}}class lh{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?fO(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new ds(s,a,r)}}function fO(n,e){return n.replace(pO,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const pO=/\{\$([^}]+)}/g;function mO(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function hr(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(RE(i)&&RE(o)){if(!hr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function RE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uh(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Nu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Du(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function gO(n,e){const t=new _O(n,e);return t.subscribe.bind(t)}class _O{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");yO(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=fg),s.error===void 0&&(s.error=fg),s.complete===void 0&&(s.complete=fg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yO(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function fg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(n){return n&&n._delegate?n._delegate:n}class Eo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new nO;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TO(e))try{this.getOrInitializeService({instanceIdentifier:Yi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Yi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yi){return this.instances.has(e)}getOptions(e=Yi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wO(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yi){return this.component?this.component.multipleInstances?e:Yi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wO(n){return n===Yi?void 0:n}function TO(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new vO(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ie||(Ie={}));const IO={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},SO=Ie.INFO,AO={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},CO=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=AO[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wv{constructor(e){this.name=e,this._logLevel=SO,this._logHandler=CO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?IO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const xO=(n,e)=>e.some(t=>n instanceof t);let PE,bE;function kO(){return PE||(PE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RO(){return bE||(bE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const PC=new WeakMap,C_=new WeakMap,bC=new WeakMap,pg=new WeakMap,Tv=new WeakMap;function PO(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(ii(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&PC.set(t,n)}).catch(()=>{}),Tv.set(e,n),e}function bO(n){if(C_.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});C_.set(n,e)}let x_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return C_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||bC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ii(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function NO(n){x_=n(x_)}function DO(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(mg(this),e,...t);return bC.set(r,e.sort?e.sort():[e]),ii(r)}:RO().includes(n)?function(...e){return n.apply(mg(this),e),ii(PC.get(this))}:function(...e){return ii(n.apply(mg(this),e))}}function VO(n){return typeof n=="function"?DO(n):(n instanceof IDBTransaction&&bO(n),xO(n,kO())?new Proxy(n,x_):n)}function ii(n){if(n instanceof IDBRequest)return PO(n);if(pg.has(n))return pg.get(n);const e=VO(n);return e!==n&&(pg.set(n,e),Tv.set(e,n)),e}const mg=n=>Tv.get(n);function OO(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=ii(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ii(o.result),l.oldVersion,l.newVersion,ii(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const MO=["get","getKey","getAll","getAllKeys","count"],LO=["put","add","delete","clear"],gg=new Map;function NE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(gg.get(e))return gg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=LO.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||MO.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),s&&l.done]))[0]};return gg.set(e,i),i}NO(n=>({...n,get:(e,t,r)=>NE(e,t)||n.get(e,t,r),has:(e,t)=>!!NE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(UO(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function UO(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const k_="@firebase/app",DE="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=new wv("@firebase/app"),jO="@firebase/app-compat",BO="@firebase/analytics-compat",zO="@firebase/analytics",qO="@firebase/app-check-compat",$O="@firebase/app-check",WO="@firebase/auth",GO="@firebase/auth-compat",HO="@firebase/database",KO="@firebase/data-connect",QO="@firebase/database-compat",YO="@firebase/functions",XO="@firebase/functions-compat",JO="@firebase/installations",ZO="@firebase/installations-compat",eM="@firebase/messaging",tM="@firebase/messaging-compat",nM="@firebase/performance",rM="@firebase/performance-compat",sM="@firebase/remote-config",iM="@firebase/remote-config-compat",oM="@firebase/storage",aM="@firebase/storage-compat",lM="@firebase/firestore",uM="@firebase/ai",cM="@firebase/firestore-compat",hM="firebase",dM="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="[DEFAULT]",fM={[k_]:"fire-core",[jO]:"fire-core-compat",[zO]:"fire-analytics",[BO]:"fire-analytics-compat",[$O]:"fire-app-check",[qO]:"fire-app-check-compat",[WO]:"fire-auth",[GO]:"fire-auth-compat",[HO]:"fire-rtdb",[KO]:"fire-data-connect",[QO]:"fire-rtdb-compat",[YO]:"fire-fn",[XO]:"fire-fn-compat",[JO]:"fire-iid",[ZO]:"fire-iid-compat",[eM]:"fire-fcm",[tM]:"fire-fcm-compat",[nM]:"fire-perf",[rM]:"fire-perf-compat",[sM]:"fire-rc",[iM]:"fire-rc-compat",[oM]:"fire-gcs",[aM]:"fire-gcs-compat",[lM]:"fire-fst",[cM]:"fire-fst-compat",[uM]:"fire-vertex","fire-js":"fire-js",[hM]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Df=new Map,pM=new Map,R_=new Map;function VE(n,e){try{n.container.addComponent(e)}catch(t){rs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ya(n){const e=n.name;if(R_.has(e))return rs.debug(`There were multiple attempts to register component ${e}.`),!1;R_.set(e,n);for(const t of Df.values())VE(t,n);for(const t of pM.values())VE(t,n);return!0}function ch(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function mM(n,e,t=Nf){ch(n,e).clearInstance(t)}function Pn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oi=new lh("app","Firebase",gM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Eo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl=dM;function NC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Nf,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw oi.create("bad-app-name",{appName:String(s)});if(t||(t=IC()),!t)throw oi.create("no-options");const i=Df.get(s);if(i){if(hr(t,i.options)&&hr(r,i.config))return i;throw oi.create("duplicate-app",{appName:s})}const o=new EO(s);for(const l of R_.values())o.addComponent(l);const a=new _M(t,r,o);return Df.set(s,a),a}function DC(n=Nf){const e=Df.get(n);if(!e&&n===Nf&&IC())return NC();if(!e)throw oi.create("no-app",{appName:n});return e}function ai(n,e,t){let r=fM[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rs.warn(o.join(" "));return}Ya(new Eo(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM="firebase-heartbeat-database",vM=1,xc="firebase-heartbeat-store";let _g=null;function VC(){return _g||(_g=OO(yM,vM,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(xc)}catch(t){console.warn(t)}}}}).catch(n=>{throw oi.create("idb-open",{originalErrorMessage:n.message})})),_g}async function wM(n){try{const t=(await VC()).transaction(xc),r=await t.objectStore(xc).get(OC(n));return await t.done,r}catch(e){if(e instanceof ds)rs.warn(e.message);else{const t=oi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rs.warn(t.message)}}}async function OE(n,e){try{const r=(await VC()).transaction(xc,"readwrite");await r.objectStore(xc).put(e,OC(n)),await r.done}catch(t){if(t instanceof ds)rs.warn(t.message);else{const r=oi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});rs.warn(r.message)}}}function OC(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM=1024,EM=30;class IM{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new AM(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ME();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>EM){const o=CM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){rs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ME(),{heartbeatsToSend:r,unsentEntries:s}=SM(this._heartbeatsCache.heartbeats),i=bf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return rs.warn(t),""}}}function ME(){return new Date().toISOString().substring(0,10)}function SM(n,e=TM){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),LE(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),LE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class AM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return RC()?hO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await wM(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return OE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return OE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function LE(n){return bf(JSON.stringify({version:2,heartbeats:n})).length}function CM(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xM(n){Ya(new Eo("platform-logger",e=>new FO(e),"PRIVATE")),Ya(new Eo("heartbeat",e=>new IM(e),"PRIVATE")),ai(k_,DE,n),ai(k_,DE,"esm2020"),ai("fire-js","")}xM("");var kM="firebase",RM="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ai(kM,RM,"app");function MC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PM=MC,LC=new lh("auth","Firebase",MC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf=new wv("@firebase/auth");function bM(n,...e){Vf.logLevel<=Ie.WARN&&Vf.warn(`Auth (${Nl}): ${n}`,...e)}function qd(n,...e){Vf.logLevel<=Ie.ERROR&&Vf.error(`Auth (${Nl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(n,...e){throw Iv(n,...e)}function or(n,...e){return Iv(n,...e)}function Ev(n,e,t){const r={...PM(),[e]:t};return new lh("auth","Firebase",r).create(e,{appName:n.name})}function Yr(n){return Ev(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function NM(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Kn(n,"argument-error"),Ev(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Iv(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return LC.create(n,...e)}function ue(n,e,...t){if(!n)throw Iv(e,...t)}function Wr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw qd(e),new Error(e)}function ss(n,e){n||Wr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function DM(){return FE()==="http:"||FE()==="https:"}function FE(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DM()||lO()||"connection"in navigator)?navigator.onLine:!0}function OM(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,t){this.shortDelay=e,this.longDelay=t,ss(t>e,"Short delay should be less than long delay!"),this.isMobile=oO()||uO()}get(){return VM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sv(n,e){ss(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],FM=new hh(3e4,6e4);function Ri(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Pi(n,e,t,r,s={}){return UC(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=uh({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:l,...i};return aO()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(u.credentials="include"),FC.fetch()(await jC(n,n.config.apiHost,t,a),u)})}async function UC(n,e,t){n._canInitEmulator=!1;const r={...MM,...e};try{const s=new jM(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw yd(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw yd(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw yd(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw yd(n,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Ev(n,h,u);Kn(n,h)}}catch(s){if(s instanceof ds)throw s;Kn(n,"network-request-failed",{message:String(s)})}}async function dh(n,e,t,r,s={}){const i=await Pi(n,e,t,r,s);return"mfaPendingCredential"in i&&Kn(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function jC(n,e,t,r){const s=`${e}${t}?${r}`,i=n,o=i.config.emulator?Sv(n.config,s):`${n.config.apiScheme}://${s}`;return LM.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function UM(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(or(this.auth,"network-request-failed")),FM.get())})}}function yd(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=or(n,e,r);return s.customData._tokenResponse=t,s}function UE(n){return n!==void 0&&n.enterprise!==void 0}class BM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return UM(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zM(n,e){return Pi(n,"GET","/v2/recaptchaConfig",Ri(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qM(n,e){return Pi(n,"POST","/v1/accounts:delete",e)}async function Of(n,e){return Pi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $M(n,e=!1){const t=Me(n),r=await t.getIdToken(e),s=Av(r);ue(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ku(yg(s.auth_time)),issuedAtTime:Ku(yg(s.iat)),expirationTime:Ku(yg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function yg(n){return Number(n)*1e3}function Av(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return qd("JWT malformed, contained fewer than 3 sections"),null;try{const s=wC(t);return s?JSON.parse(s):(qd("Failed to decode base64 JWT payload"),null)}catch(s){return qd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function jE(n){const e=Av(n);return ue(e,"internal-error"),ue(typeof e.exp<"u","internal-error"),ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ds&&WM(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function WM({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ku(this.lastLoginAt),this.creationTime=Ku(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mf(n){var d;const e=n.auth,t=await n.getIdToken(),r=await kc(n,Of(e,{idToken:t}));ue(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=(d=s.providerUserInfo)!=null&&d.length?BC(s.providerUserInfo):[],o=KM(n.providerData,i),a=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new b_(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function HM(n){const e=Me(n);await Mf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function KM(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function BC(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QM(n,e){const t=await UC(n,{},async()=>{const r=uh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=await jC(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(l.credentials="include"),FC.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YM(n,e){return Pi(n,"POST","/v2/accounts:revokeToken",Ri(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ue(e.idToken,"internal-error"),ue(typeof e.idToken<"u","internal-error"),ue(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):jE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ue(e.length!==0,"internal-error");const t=jE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await QM(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Oa;return r&&(ue(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ue(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ue(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Oa,this.toJSON())}_performRefresh(){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(n,e){ue(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class tr{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new GM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new b_(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await kc(this,this.stsTokenManager.getToken(this.auth,e));return ue(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return $M(this,e)}reload(){return HM(this)}_assign(e){this!==e&&(ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new tr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Mf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pn(this.auth.app))return Promise.reject(Yr(this.auth));const e=await this.getIdToken();return await kc(this,qM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:m,providerData:g,stsTokenManager:w}=t;ue(d&&w,e,"internal-error");const E=Oa.fromJSON(this.name,w);ue(typeof d=="string",e,"internal-error"),Rs(r,e.name),Rs(s,e.name),ue(typeof f=="boolean",e,"internal-error"),ue(typeof m=="boolean",e,"internal-error"),Rs(i,e.name),Rs(o,e.name),Rs(a,e.name),Rs(l,e.name),Rs(u,e.name),Rs(h,e.name);const y=new tr({uid:d,auth:e,email:s,emailVerified:f,displayName:r,isAnonymous:m,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:E,createdAt:u,lastLoginAt:h});return g&&Array.isArray(g)&&(y.providerData=g.map(T=>({...T}))),l&&(y._redirectEventId=l),y}static async _fromIdTokenResponse(e,t,r=!1){const s=new Oa;s.updateFromServerResponse(t);const i=new tr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Mf(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ue(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?BC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Oa;a.updateFromIdToken(r);const l=new tr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new b_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE=new Map;function Gr(n){ss(n instanceof Function,"Expected a class definition");let e=BE.get(n);return e?(ss(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,BE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}zC.type="NONE";const zE=zC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(n,e,t){return`firebase:${n}:${e}:${t}`}class Ma{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=$d(this.userKey,s.apiKey,i),this.fullPersistenceKey=$d("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Of(this.auth,{idToken:e}).catch(()=>{});return t?tr._fromGetAccountInfoResponse(this.auth,t,e):null}return tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ma(Gr(zE),e,r);const s=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Gr(zE);const o=$d(r,e.config.apiKey,e.name);let a=null;for(const u of t)try{const h=await u._get(o);if(h){let d;if(typeof h=="string"){const f=await Of(e,{idToken:h}).catch(()=>{});if(!f)break;d=await tr._fromGetAccountInfoResponse(e,f,h)}else d=tr._fromJSON(e,h);u!==i&&(a=d),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Ma(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Ma(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(GC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(KC(e))return"Blackberry";if(QC(e))return"Webos";if($C(e))return"Safari";if((e.includes("chrome/")||WC(e))&&!e.includes("edge/"))return"Chrome";if(HC(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function qC(n=xt()){return/firefox\//i.test(n)}function $C(n=xt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function WC(n=xt()){return/crios\//i.test(n)}function GC(n=xt()){return/iemobile/i.test(n)}function HC(n=xt()){return/android/i.test(n)}function KC(n=xt()){return/blackberry/i.test(n)}function QC(n=xt()){return/webos/i.test(n)}function Cv(n=xt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function XM(n=xt()){var e;return Cv(n)&&!!((e=window.navigator)!=null&&e.standalone)}function JM(){return cO()&&document.documentMode===10}function YC(n=xt()){return Cv(n)||HC(n)||QC(n)||KC(n)||/windows phone/i.test(n)||GC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XC(n,e=[]){let t;switch(n){case"Browser":t=qE(xt());break;case"Worker":t=`${qE(xt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Nl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eL(n,e={}){return Pi(n,"GET","/v2/passwordPolicy",Ri(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tL=6;class nL{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??tL,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $E(this),this.idTokenSubscription=new $E(this),this.beforeStateQueue=new ZM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=LC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Gr(t)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Ma.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Of(this,{idToken:e}),r=await tr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Pn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Mf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=OM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pn(this.app))return Promise.reject(Yr(this));const t=e?Me(e):null;return t&&ue(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pn(this.app)?Promise.reject(Yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pn(this.app)?Promise.reject(Yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eL(this),t=new nL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lh("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await YM(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Gr(e)||this._popupRedirectResolver;ue(t,this,"argument-error"),this.redirectPersistenceManager=await Ma.create(this,[Gr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ue(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=XC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(Pn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&bM(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function bi(n){return Me(n)}class $E{constructor(e){this.auth=e,this.observer=null,this.addObserver=gO(t=>this.observer=t)}get next(){return ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sL(n){Fp=n}function JC(n){return Fp.loadJS(n)}function iL(){return Fp.recaptchaEnterpriseScript}function oL(){return Fp.gapiScript}function aL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class lL{constructor(){this.enterprise=new uL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class uL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const cL="recaptcha-enterprise",ZC="NO_RECAPTCHA";class hL{constructor(e){this.type=cL,this.auth=bi(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{zM(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new BM(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;UE(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(ZC)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lL().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&UE(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=iL();l.length!==0&&(l+=a),JC(l).then(()=>{s(a,i,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function WE(n,e,t,r=!1,s=!1){const i=new hL(n);let o;if(s)o=ZC;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function N_(n,e,t,r,s){var i;if((i=n._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await WE(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await WE(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dL(n,e){const t=ch(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(hr(i,e??{}))return s;Kn(s,"already-initialized")}return t.initialize({options:e})}function fL(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Gr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function pL(n,e,t){const r=bi(n);ue(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=ex(e),{host:o,port:a}=mL(e),l=a===null?"":`:${a}`,u={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ue(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ue(hr(u,r.config.emulator)&&hr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Bo(o)?(vv(`${i}//${o}${l}`),AC("Auth",!0)):gL()}function ex(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mL(n){const e=ex(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:GE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:GE(o)}}}function GE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function gL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wr("not implemented")}_getIdTokenResponse(e){return Wr("not implemented")}_linkToIdToken(e,t){return Wr("not implemented")}_getReauthenticationResolver(e){return Wr("not implemented")}}async function _L(n,e){return Pi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yL(n,e){return dh(n,"POST","/v1/accounts:signInWithPassword",Ri(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vL(n,e){return dh(n,"POST","/v1/accounts:signInWithEmailLink",Ri(n,e))}async function wL(n,e){return dh(n,"POST","/v1/accounts:signInWithEmailLink",Ri(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends xv{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Rc(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Rc(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return N_(e,t,"signInWithPassword",yL);case"emailLink":return vL(e,{email:this._email,oobCode:this._password});default:Kn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return N_(e,r,"signUpPassword",_L);case"emailLink":return wL(e,{idToken:t,email:this._email,oobCode:this._password});default:Kn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function La(n,e){return dh(n,"POST","/v1/accounts:signInWithIdp",Ri(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL="http://localhost";class Io extends xv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Io(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Kn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const o=new Io(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return La(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,La(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,La(e,t)}buildRequest(){const e={requestUri:TL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=uh(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function IL(n){const e=Nu(Du(n)).link,t=e?Nu(Du(e)).deep_link_id:null,r=Nu(Du(n)).deep_link_id;return(r?Nu(Du(r)).link:null)||r||t||e||n}class kv{constructor(e){const t=Nu(Du(e)),r=t.apiKey??null,s=t.oobCode??null,i=EL(t.mode??null);ue(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=IL(e);try{return new kv(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(){this.providerId=Dl.PROVIDER_ID}static credential(e,t){return Rc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=kv.parseLink(t);return ue(r,"argument-error"),Rc._fromEmailAndCode(e,r.code,r.tenantId)}}Dl.PROVIDER_ID="password";Dl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Dl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh extends Rv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js extends fh{constructor(){super("facebook.com")}static credential(e){return Io._fromParams({providerId:js.PROVIDER_ID,signInMethod:js.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return js.credentialFromTaggedObject(e)}static credentialFromError(e){return js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return js.credential(e.oauthAccessToken)}catch{return null}}}js.FACEBOOK_SIGN_IN_METHOD="facebook.com";js.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr extends fh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Io._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return zr.credential(t,r)}catch{return null}}}zr.GOOGLE_SIGN_IN_METHOD="google.com";zr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs extends fh{constructor(){super("github.com")}static credential(e){return Io._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bs.credentialFromTaggedObject(e)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bs.credential(e.oauthAccessToken)}catch{return null}}}Bs.GITHUB_SIGN_IN_METHOD="github.com";Bs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs extends fh{constructor(){super("twitter.com")}static credential(e,t){return Io._fromParams({providerId:zs.PROVIDER_ID,signInMethod:zs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zs.credentialFromTaggedObject(e)}static credentialFromError(e){return zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return zs.credential(t,r)}catch{return null}}}zs.TWITTER_SIGN_IN_METHOD="twitter.com";zs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SL(n,e){return dh(n,"POST","/v1/accounts:signUp",Ri(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await tr._fromIdTokenResponse(e,r,s),o=HE(r);return new So({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=HE(r);return new So({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function HE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf extends ds{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Lf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Lf(e,t,r,s)}}function tx(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Lf._fromErrorAndOperation(n,i,e,r):i})}async function AL(n,e,t=!1){const r=await kc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return So._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CL(n,e,t=!1){const{auth:r}=n;if(Pn(r.app))return Promise.reject(Yr(r));const s="reauthenticate";try{const i=await kc(n,tx(r,s,e,n),t);ue(i.idToken,r,"internal-error");const o=Av(i.idToken);ue(o,r,"internal-error");const{sub:a}=o;return ue(n.uid===a,r,"user-mismatch"),So._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Kn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nx(n,e,t=!1){if(Pn(n.app))return Promise.reject(Yr(n));const r="signIn",s=await tx(n,r,e),i=await So._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function xL(n,e){return nx(bi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rx(n){const e=bi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kL(n,e,t){if(Pn(n.app))return Promise.reject(Yr(n));const r=bi(n),o=await N_(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",SL).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&rx(n),l}),a=await So._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function RL(n,e,t){return Pn(n.app)?Promise.reject(Yr(n)):xL(Me(n),Dl.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&rx(n),r})}function PL(n,e,t,r){return Me(n).onIdTokenChanged(e,t,r)}function bL(n,e,t){return Me(n).beforeAuthStateChanged(e,t)}function NL(n,e,t,r){return Me(n).onAuthStateChanged(e,t,r)}const Ff="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ff,"1"),this.storage.removeItem(Ff),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL=1e3,VL=10;class ix extends sx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=YC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);JM()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,VL):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},DL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ix.type="LOCAL";const OL=ix;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox extends sx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ox.type="SESSION";const ax=ox;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ML(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Up(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(t.origin,i)),l=await ML(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Up.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=Pv("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(d){const f=d;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(){return window}function FL(n){Rr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lx(){return typeof Rr().WorkerGlobalScope<"u"&&typeof Rr().importScripts=="function"}async function UL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function BL(){return lx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux="firebaseLocalStorageDb",zL=1,Uf="firebaseLocalStorage",cx="fbase_key";class ph{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function jp(n,e){return n.transaction([Uf],e?"readwrite":"readonly").objectStore(Uf)}function qL(){const n=indexedDB.deleteDatabase(ux);return new ph(n).toPromise()}function D_(){const n=indexedDB.open(ux,zL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Uf,{keyPath:cx})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Uf)?e(r):(r.close(),await qL(),e(await D_()))})})}async function KE(n,e,t){const r=jp(n,!0).put({[cx]:e,value:t});return new ph(r).toPromise()}async function $L(n,e){const t=jp(n,!1).get(e),r=await new ph(t).toPromise();return r===void 0?null:r.value}function QE(n,e){const t=jp(n,!0).delete(e);return new ph(t).toPromise()}const WL=800,GL=3;class hx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await D_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>GL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return lx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Up._getInstance(BL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await UL(),!this.activeServiceWorker)return;this.sender=new LL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await D_();return await KE(e,Ff,"1"),await QE(e,Ff),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>KE(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>$L(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>QE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=jp(s,!1).getAll();return new ph(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}hx.type="LOCAL";const HL=hx;new hh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(n,e){return e?Gr(e):(ue(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv extends xv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return La(e,this._buildIdpRequest())}_linkToIdToken(e,t){return La(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return La(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function KL(n){return nx(n.auth,new bv(n),n.bypassAuthState)}function QL(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),CL(t,new bv(n),n.bypassAuthState)}async function YL(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),AL(t,new bv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KL;case"linkViaPopup":case"linkViaRedirect":return YL;case"reauthViaPopup":case"reauthViaRedirect":return QL;default:Kn(this.auth,"internal-error")}}resolve(e){ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=new hh(2e3,1e4);async function JL(n,e,t){if(Pn(n.app))return Promise.reject(or(n,"operation-not-supported-in-this-environment"));const r=bi(n);NM(n,e,Rv);const s=dx(r,t);return new ao(r,"signInViaPopup",e,s).executeNotNull()}class ao extends fx{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ao.currentPopupAction&&ao.currentPopupAction.cancel(),ao.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ue(e,this.auth,"internal-error"),e}async onExecution(){ss(this.filter.length===1,"Popup operations only handle one event");const e=Pv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(or(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(or(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ao.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(or(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,XL.get())};e()}}ao.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL="pendingRedirect",Wd=new Map;class eF extends fx{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Wd.get(this.auth._key());if(!e){try{const r=await tF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Wd.set(this.auth._key(),e)}return this.bypassAuthState||Wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function tF(n,e){const t=sF(e),r=rF(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function nF(n,e){Wd.set(n._key(),e)}function rF(n){return Gr(n._redirectPersistence)}function sF(n){return $d(ZL,n.config.apiKey,n.name)}async function iF(n,e,t=!1){if(Pn(n.app))return Promise.reject(Yr(n));const r=bi(n),s=dx(r,e),o=await new eF(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=10*60*1e3;class aF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!lF(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!px(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(or(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=oF&&this.cachedEventUids.clear(),this.cachedEventUids.has(YE(e))}saveEventToCache(e){this.cachedEventUids.add(YE(e)),this.lastProcessedEventTime=Date.now()}}function YE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function px({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function lF(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return px(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uF(n,e={}){return Pi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hF=/^https?/;async function dF(n){if(n.config.emulator)return;const{authorizedDomains:e}=await uF(n);for(const t of e)try{if(fF(t))return}catch{}Kn(n,"unauthorized-domain")}function fF(n){const e=P_(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!hF.test(t))return!1;if(cF.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF=new hh(3e4,6e4);function XE(){const n=Rr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function mF(n){return new Promise((e,t)=>{var s,i,o;function r(){XE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{XE(),t(or(n,"network-request-failed"))},timeout:pF.get()})}if((i=(s=Rr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Rr().gapi)!=null&&o.load)r();else{const a=aL("iframefcb");return Rr()[a]=()=>{gapi.load?r():t(or(n,"network-request-failed"))},JC(`${oL()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Gd=null,e})}let Gd=null;function gF(n){return Gd=Gd||mF(n),Gd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F=new hh(5e3,15e3),yF="__/auth/iframe",vF="emulator/auth/iframe",wF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},TF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function EF(n){const e=n.config;ue(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Sv(e,vF):`https://${n.config.authDomain}/${yF}`,r={apiKey:e.apiKey,appName:n.name,v:Nl},s=TF.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${uh(r).slice(1)}`}async function IF(n){const e=await gF(n),t=Rr().gapi;return ue(t,n,"internal-error"),e.open({where:document.body,url:EF(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wF,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=or(n,"network-request-failed"),a=Rr().setTimeout(()=>{i(o)},_F.get());function l(){Rr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},AF=500,CF=600,xF="_blank",kF="http://localhost";class JE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function RF(n,e,t,r=AF,s=CF){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...SF,width:r.toString(),height:s.toString(),top:i,left:o},u=xt().toLowerCase();t&&(a=WC(u)?xF:t),qC(u)&&(e=e||kF,l.scrollbars="yes");const h=Object.entries(l).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(XM(u)&&a!=="_self")return PF(e||"",a),new JE(null);const d=window.open(e||"",a,h);ue(d,n,"popup-blocked");try{d.focus()}catch{}return new JE(d)}function PF(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF="__/auth/handler",NF="emulator/auth/handler",DF=encodeURIComponent("fac");async function ZE(n,e,t,r,s,i){ue(n.config.authDomain,n,"auth-domain-config-required"),ue(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Nl,eventId:s};if(e instanceof Rv){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",mO(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(e instanceof fh){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),u=l?`#${DF}=${encodeURIComponent(l)}`:"";return`${VF(n)}?${uh(a).slice(1)}${u}`}function VF({config:n}){return n.emulator?Sv(n,NF):`https://${n.authDomain}/${bF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg="webStorageSupport";class OF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ax,this._completeRedirectFn=iF,this._overrideRedirectResult=nF}async _openPopup(e,t,r,s){var o;ss((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await ZE(e,t,r,P_(),s);return RF(e,i,Pv())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await ZE(e,t,r,P_(),s);return FL(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ss(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await IF(e),r=new aF(e);return t.register("authEvent",s=>(ue(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(vg,{type:vg},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[vg];i!==void 0&&t(!!i),Kn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=dF(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return YC()||$C()||Cv()}}const MF=OF;var eI="@firebase/auth",tI="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FF(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function UF(n){Ya(new Eo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ue(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:XC(n)},u=new rL(r,s,i,l);return fL(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ya(new Eo("auth-internal",e=>{const t=bi(e.getProvider("auth").getImmediate());return(r=>new LF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ai(eI,tI,FF(n)),ai(eI,tI,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=5*60,BF=SC("authIdTokenMaxAge")||jF;let nI=null;const zF=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>BF)return;const s=t==null?void 0:t.token;nI!==s&&(nI=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function qF(n=DC()){const e=ch(n,"auth");if(e.isInitialized())return e.getImmediate();const t=dL(n,{popupRedirectResolver:MF,persistence:[HL,OL,ax]}),r=SC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=zF(i.toString());bL(t,o,()=>o(t.currentUser)),PL(t,a=>o(a))}}const s=EC("auth");return s&&pL(t,`http://${s}`),t}function $F(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}sL({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=or("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",$F().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});UF("Browser");var rI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var li,mx;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,v){function A(){}A.prototype=v.prototype,I.F=v.prototype,I.prototype=new A,I.prototype.constructor=I,I.D=function(x,C,b){for(var R=Array(arguments.length-2),W=2;W<arguments.length;W++)R[W-2]=arguments[W];return v.prototype[C].apply(x,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,v,A){A||(A=0);const x=Array(16);if(typeof v=="string")for(var C=0;C<16;++C)x[C]=v.charCodeAt(A++)|v.charCodeAt(A++)<<8|v.charCodeAt(A++)<<16|v.charCodeAt(A++)<<24;else for(C=0;C<16;++C)x[C]=v[A++]|v[A++]<<8|v[A++]<<16|v[A++]<<24;v=I.g[0],A=I.g[1],C=I.g[2];let b=I.g[3],R;R=v+(b^A&(C^b))+x[0]+3614090360&4294967295,v=A+(R<<7&4294967295|R>>>25),R=b+(C^v&(A^C))+x[1]+3905402710&4294967295,b=v+(R<<12&4294967295|R>>>20),R=C+(A^b&(v^A))+x[2]+606105819&4294967295,C=b+(R<<17&4294967295|R>>>15),R=A+(v^C&(b^v))+x[3]+3250441966&4294967295,A=C+(R<<22&4294967295|R>>>10),R=v+(b^A&(C^b))+x[4]+4118548399&4294967295,v=A+(R<<7&4294967295|R>>>25),R=b+(C^v&(A^C))+x[5]+1200080426&4294967295,b=v+(R<<12&4294967295|R>>>20),R=C+(A^b&(v^A))+x[6]+2821735955&4294967295,C=b+(R<<17&4294967295|R>>>15),R=A+(v^C&(b^v))+x[7]+4249261313&4294967295,A=C+(R<<22&4294967295|R>>>10),R=v+(b^A&(C^b))+x[8]+1770035416&4294967295,v=A+(R<<7&4294967295|R>>>25),R=b+(C^v&(A^C))+x[9]+2336552879&4294967295,b=v+(R<<12&4294967295|R>>>20),R=C+(A^b&(v^A))+x[10]+4294925233&4294967295,C=b+(R<<17&4294967295|R>>>15),R=A+(v^C&(b^v))+x[11]+2304563134&4294967295,A=C+(R<<22&4294967295|R>>>10),R=v+(b^A&(C^b))+x[12]+1804603682&4294967295,v=A+(R<<7&4294967295|R>>>25),R=b+(C^v&(A^C))+x[13]+4254626195&4294967295,b=v+(R<<12&4294967295|R>>>20),R=C+(A^b&(v^A))+x[14]+2792965006&4294967295,C=b+(R<<17&4294967295|R>>>15),R=A+(v^C&(b^v))+x[15]+1236535329&4294967295,A=C+(R<<22&4294967295|R>>>10),R=v+(C^b&(A^C))+x[1]+4129170786&4294967295,v=A+(R<<5&4294967295|R>>>27),R=b+(A^C&(v^A))+x[6]+3225465664&4294967295,b=v+(R<<9&4294967295|R>>>23),R=C+(v^A&(b^v))+x[11]+643717713&4294967295,C=b+(R<<14&4294967295|R>>>18),R=A+(b^v&(C^b))+x[0]+3921069994&4294967295,A=C+(R<<20&4294967295|R>>>12),R=v+(C^b&(A^C))+x[5]+3593408605&4294967295,v=A+(R<<5&4294967295|R>>>27),R=b+(A^C&(v^A))+x[10]+38016083&4294967295,b=v+(R<<9&4294967295|R>>>23),R=C+(v^A&(b^v))+x[15]+3634488961&4294967295,C=b+(R<<14&4294967295|R>>>18),R=A+(b^v&(C^b))+x[4]+3889429448&4294967295,A=C+(R<<20&4294967295|R>>>12),R=v+(C^b&(A^C))+x[9]+568446438&4294967295,v=A+(R<<5&4294967295|R>>>27),R=b+(A^C&(v^A))+x[14]+3275163606&4294967295,b=v+(R<<9&4294967295|R>>>23),R=C+(v^A&(b^v))+x[3]+4107603335&4294967295,C=b+(R<<14&4294967295|R>>>18),R=A+(b^v&(C^b))+x[8]+1163531501&4294967295,A=C+(R<<20&4294967295|R>>>12),R=v+(C^b&(A^C))+x[13]+2850285829&4294967295,v=A+(R<<5&4294967295|R>>>27),R=b+(A^C&(v^A))+x[2]+4243563512&4294967295,b=v+(R<<9&4294967295|R>>>23),R=C+(v^A&(b^v))+x[7]+1735328473&4294967295,C=b+(R<<14&4294967295|R>>>18),R=A+(b^v&(C^b))+x[12]+2368359562&4294967295,A=C+(R<<20&4294967295|R>>>12),R=v+(A^C^b)+x[5]+4294588738&4294967295,v=A+(R<<4&4294967295|R>>>28),R=b+(v^A^C)+x[8]+2272392833&4294967295,b=v+(R<<11&4294967295|R>>>21),R=C+(b^v^A)+x[11]+1839030562&4294967295,C=b+(R<<16&4294967295|R>>>16),R=A+(C^b^v)+x[14]+4259657740&4294967295,A=C+(R<<23&4294967295|R>>>9),R=v+(A^C^b)+x[1]+2763975236&4294967295,v=A+(R<<4&4294967295|R>>>28),R=b+(v^A^C)+x[4]+1272893353&4294967295,b=v+(R<<11&4294967295|R>>>21),R=C+(b^v^A)+x[7]+4139469664&4294967295,C=b+(R<<16&4294967295|R>>>16),R=A+(C^b^v)+x[10]+3200236656&4294967295,A=C+(R<<23&4294967295|R>>>9),R=v+(A^C^b)+x[13]+681279174&4294967295,v=A+(R<<4&4294967295|R>>>28),R=b+(v^A^C)+x[0]+3936430074&4294967295,b=v+(R<<11&4294967295|R>>>21),R=C+(b^v^A)+x[3]+3572445317&4294967295,C=b+(R<<16&4294967295|R>>>16),R=A+(C^b^v)+x[6]+76029189&4294967295,A=C+(R<<23&4294967295|R>>>9),R=v+(A^C^b)+x[9]+3654602809&4294967295,v=A+(R<<4&4294967295|R>>>28),R=b+(v^A^C)+x[12]+3873151461&4294967295,b=v+(R<<11&4294967295|R>>>21),R=C+(b^v^A)+x[15]+530742520&4294967295,C=b+(R<<16&4294967295|R>>>16),R=A+(C^b^v)+x[2]+3299628645&4294967295,A=C+(R<<23&4294967295|R>>>9),R=v+(C^(A|~b))+x[0]+4096336452&4294967295,v=A+(R<<6&4294967295|R>>>26),R=b+(A^(v|~C))+x[7]+1126891415&4294967295,b=v+(R<<10&4294967295|R>>>22),R=C+(v^(b|~A))+x[14]+2878612391&4294967295,C=b+(R<<15&4294967295|R>>>17),R=A+(b^(C|~v))+x[5]+4237533241&4294967295,A=C+(R<<21&4294967295|R>>>11),R=v+(C^(A|~b))+x[12]+1700485571&4294967295,v=A+(R<<6&4294967295|R>>>26),R=b+(A^(v|~C))+x[3]+2399980690&4294967295,b=v+(R<<10&4294967295|R>>>22),R=C+(v^(b|~A))+x[10]+4293915773&4294967295,C=b+(R<<15&4294967295|R>>>17),R=A+(b^(C|~v))+x[1]+2240044497&4294967295,A=C+(R<<21&4294967295|R>>>11),R=v+(C^(A|~b))+x[8]+1873313359&4294967295,v=A+(R<<6&4294967295|R>>>26),R=b+(A^(v|~C))+x[15]+4264355552&4294967295,b=v+(R<<10&4294967295|R>>>22),R=C+(v^(b|~A))+x[6]+2734768916&4294967295,C=b+(R<<15&4294967295|R>>>17),R=A+(b^(C|~v))+x[13]+1309151649&4294967295,A=C+(R<<21&4294967295|R>>>11),R=v+(C^(A|~b))+x[4]+4149444226&4294967295,v=A+(R<<6&4294967295|R>>>26),R=b+(A^(v|~C))+x[11]+3174756917&4294967295,b=v+(R<<10&4294967295|R>>>22),R=C+(v^(b|~A))+x[2]+718787259&4294967295,C=b+(R<<15&4294967295|R>>>17),R=A+(b^(C|~v))+x[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(C+(R<<21&4294967295|R>>>11))&4294967295,I.g[2]=I.g[2]+C&4294967295,I.g[3]=I.g[3]+b&4294967295}r.prototype.v=function(I,v){v===void 0&&(v=I.length);const A=v-this.blockSize,x=this.C;let C=this.h,b=0;for(;b<v;){if(C==0)for(;b<=A;)s(this,I,b),b+=this.blockSize;if(typeof I=="string"){for(;b<v;)if(x[C++]=I.charCodeAt(b++),C==this.blockSize){s(this,x),C=0;break}}else for(;b<v;)if(x[C++]=I[b++],C==this.blockSize){s(this,x),C=0;break}}this.h=C,this.o+=v},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;v=this.o*8;for(var A=I.length-8;A<I.length;++A)I[A]=v&255,v/=256;for(this.v(I),I=Array(16),v=0,A=0;A<4;++A)for(let x=0;x<32;x+=8)I[v++]=this.g[A]>>>x&255;return I};function i(I,v){var A=a;return Object.prototype.hasOwnProperty.call(A,I)?A[I]:A[I]=v(I)}function o(I,v){this.h=v;const A=[];let x=!0;for(let C=I.length-1;C>=0;C--){const b=I[C]|0;x&&b==v||(A[C]=b,x=!1)}this.g=A}var a={};function l(I){return-128<=I&&I<128?i(I,function(v){return new o([v|0],v<0?-1:0)}):new o([I|0],I<0?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return d;if(I<0)return E(u(-I));const v=[];let A=1;for(let x=0;I>=A;x++)v[x]=I/A|0,A*=4294967296;return new o(v,0)}function h(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return E(h(I.substring(1),v));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=u(Math.pow(v,8));let x=d;for(let b=0;b<I.length;b+=8){var C=Math.min(8,I.length-b);const R=parseInt(I.substring(b,b+C),v);C<8?(C=u(Math.pow(v,C)),x=x.j(C).add(u(R))):(x=x.j(A),x=x.add(u(R)))}return x}var d=l(0),f=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(w(this))return-E(this).m();let I=0,v=1;for(let A=0;A<this.g.length;A++){const x=this.i(A);I+=(x>=0?x:4294967296+x)*v,v*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(g(this))return"0";if(w(this))return"-"+E(this).toString(I);const v=u(Math.pow(I,6));var A=this;let x="";for(;;){const C=N(A,v).g;A=y(A,C.j(v));let b=((A.g.length>0?A.g[0]:A.h)>>>0).toString(I);if(A=C,g(A))return b+x;for(;b.length<6;)b="0"+b;x=b+x}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function g(I){if(I.h!=0)return!1;for(let v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function w(I){return I.h==-1}n.l=function(I){return I=y(this,I),w(I)?-1:g(I)?0:1};function E(I){const v=I.g.length,A=[];for(let x=0;x<v;x++)A[x]=~I.g[x];return new o(A,~I.h).add(f)}n.abs=function(){return w(this)?E(this):this},n.add=function(I){const v=Math.max(this.g.length,I.g.length),A=[];let x=0;for(let C=0;C<=v;C++){let b=x+(this.i(C)&65535)+(I.i(C)&65535),R=(b>>>16)+(this.i(C)>>>16)+(I.i(C)>>>16);x=R>>>16,b&=65535,R&=65535,A[C]=R<<16|b}return new o(A,A[A.length-1]&-2147483648?-1:0)};function y(I,v){return I.add(E(v))}n.j=function(I){if(g(this)||g(I))return d;if(w(this))return w(I)?E(this).j(E(I)):E(E(this).j(I));if(w(I))return E(this.j(E(I)));if(this.l(m)<0&&I.l(m)<0)return u(this.m()*I.m());const v=this.g.length+I.g.length,A=[];for(var x=0;x<2*v;x++)A[x]=0;for(x=0;x<this.g.length;x++)for(let C=0;C<I.g.length;C++){const b=this.i(x)>>>16,R=this.i(x)&65535,W=I.i(C)>>>16,se=I.i(C)&65535;A[2*x+2*C]+=R*se,T(A,2*x+2*C),A[2*x+2*C+1]+=b*se,T(A,2*x+2*C+1),A[2*x+2*C+1]+=R*W,T(A,2*x+2*C+1),A[2*x+2*C+2]+=b*W,T(A,2*x+2*C+2)}for(I=0;I<v;I++)A[I]=A[2*I+1]<<16|A[2*I];for(I=v;I<2*v;I++)A[I]=0;return new o(A,0)};function T(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function S(I,v){this.g=I,this.h=v}function N(I,v){if(g(v))throw Error("division by zero");if(g(I))return new S(d,d);if(w(I))return v=N(E(I),v),new S(E(v.g),E(v.h));if(w(v))return v=N(I,E(v)),new S(E(v.g),v.h);if(I.g.length>30){if(w(I)||w(v))throw Error("slowDivide_ only works with positive integers.");for(var A=f,x=v;x.l(I)<=0;)A=P(A),x=P(x);var C=D(A,1),b=D(x,1);for(x=D(x,2),A=D(A,2);!g(x);){var R=b.add(x);R.l(I)<=0&&(C=C.add(A),b=R),x=D(x,1),A=D(A,1)}return v=y(I,C.j(v)),new S(C,v)}for(C=d;I.l(v)>=0;){for(A=Math.max(1,Math.floor(I.m()/v.m())),x=Math.ceil(Math.log(A)/Math.LN2),x=x<=48?1:Math.pow(2,x-48),b=u(A),R=b.j(v);w(R)||R.l(I)>0;)A-=x,b=u(A),R=b.j(v);g(b)&&(b=f),C=C.add(b),I=y(I,R)}return new S(C,I)}n.B=function(I){return N(this,I).h},n.and=function(I){const v=Math.max(this.g.length,I.g.length),A=[];for(let x=0;x<v;x++)A[x]=this.i(x)&I.i(x);return new o(A,this.h&I.h)},n.or=function(I){const v=Math.max(this.g.length,I.g.length),A=[];for(let x=0;x<v;x++)A[x]=this.i(x)|I.i(x);return new o(A,this.h|I.h)},n.xor=function(I){const v=Math.max(this.g.length,I.g.length),A=[];for(let x=0;x<v;x++)A[x]=this.i(x)^I.i(x);return new o(A,this.h^I.h)};function P(I){const v=I.g.length+1,A=[];for(let x=0;x<v;x++)A[x]=I.i(x)<<1|I.i(x-1)>>>31;return new o(A,I.h)}function D(I,v){const A=v>>5;v%=32;const x=I.g.length-A,C=[];for(let b=0;b<x;b++)C[b]=v>0?I.i(b+A)>>>v|I.i(b+A+1)<<32-v:I.i(b+A);return new o(C,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,mx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,li=o}).apply(typeof rI<"u"?rI:typeof self<"u"?self:typeof window<"u"?window:{});var vd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gx,Vu,_x,Hd,V_,yx,vx,wx;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof vd=="object"&&vd];for(var p=0;p<c.length;++p){var _=c[p];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=t(this);function s(c,p){if(p)e:{var _=r;c=c.split(".");for(var k=0;k<c.length-1;k++){var M=c[k];if(!(M in _))break e;_=_[M]}c=c[c.length-1],k=_[c],p=p(k),p!=k&&p!=null&&e(_,c,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(p){var _=[],k;for(k in p)Object.prototype.hasOwnProperty.call(p,k)&&_.push([k,p[k]]);return _}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,_){return c.call.apply(c.bind,arguments)}function u(c,p,_){return u=l,u.apply(null,arguments)}function h(c,p){var _=Array.prototype.slice.call(arguments,1);return function(){var k=_.slice();return k.push.apply(k,arguments),c.apply(this,k)}}function d(c,p){function _(){}_.prototype=p.prototype,c.Z=p.prototype,c.prototype=new _,c.prototype.constructor=c,c.Ob=function(k,M,F){for(var Q=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)Q[ge-2]=arguments[ge];return p.prototype[M].apply(k,Q)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function m(c){const p=c.length;if(p>0){const _=Array(p);for(let k=0;k<p;k++)_[k]=c[k];return _}return[]}function g(c,p){for(let k=1;k<arguments.length;k++){const M=arguments[k];var _=typeof M;if(_=_!="object"?_:M?Array.isArray(M)?"array":_:"null",_=="array"||_=="object"&&typeof M.length=="number"){_=c.length||0;const F=M.length||0;c.length=_+F;for(let Q=0;Q<F;Q++)c[_+Q]=M[Q]}else c.push(M)}}class w{constructor(p,_){this.i=p,this.j=_,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function E(c){o.setTimeout(()=>{throw c},0)}function y(){var c=I;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class T{constructor(){this.h=this.g=null}add(p,_){const k=S.get();k.set(p,_),this.h?this.h.next=k:this.g=k,this.h=k}}var S=new w(()=>new N,c=>c.reset());class N{constructor(){this.next=this.g=this.h=null}set(p,_){this.h=p,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let P,D=!1,I=new T,v=()=>{const c=Promise.resolve(void 0);P=()=>{c.then(A)}};function A(){for(var c;c=y();){try{c.h.call(c.g)}catch(_){E(_)}var p=S;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}D=!1}function x(){this.u=this.u,this.C=this.C}x.prototype.u=!1,x.prototype.dispose=function(){this.u||(this.u=!0,this.N())},x.prototype[Symbol.dispose]=function(){this.dispose()},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var b=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const _=()=>{};o.addEventListener("test",_,p),o.removeEventListener("test",_,p)}catch{}return c}();function R(c){return/^[\s\xa0]*$/.test(c)}function W(c,p){C.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}d(W,C),W.prototype.init=function(c,p){const _=this.type=c.type,k=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(_=="mouseover"?p=c.fromElement:_=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&W.Z.h.call(this)},W.prototype.h=function(){W.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var se="closure_listenable_"+(Math.random()*1e6|0),ee=0;function re(c,p,_,k,M){this.listener=c,this.proxy=null,this.src=p,this.type=_,this.capture=!!k,this.ha=M,this.key=++ee,this.da=this.fa=!1}function j(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function z(c,p,_){for(const k in c)p.call(_,c[k],k,c)}function G(c,p){for(const _ in c)p.call(void 0,c[_],_,c)}function Z(c){const p={};for(const _ in c)p[_]=c[_];return p}const le="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function dt(c,p){let _,k;for(let M=1;M<arguments.length;M++){k=arguments[M];for(_ in k)c[_]=k[_];for(let F=0;F<le.length;F++)_=le[F],Object.prototype.hasOwnProperty.call(k,_)&&(c[_]=k[_])}}function Le(c){this.src=c,this.g={},this.h=0}Le.prototype.add=function(c,p,_,k,M){const F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);const Q=Ee(c,p,k,M);return Q>-1?(p=c[Q],_||(p.fa=!1)):(p=new re(p,this.src,F,!!k,M),p.fa=_,c.push(p)),p};function fe(c,p){const _=p.type;if(_ in c.g){var k=c.g[_],M=Array.prototype.indexOf.call(k,p,void 0),F;(F=M>=0)&&Array.prototype.splice.call(k,M,1),F&&(j(p),c.g[_].length==0&&(delete c.g[_],c.h--))}}function Ee(c,p,_,k){for(let M=0;M<c.length;++M){const F=c[M];if(!F.da&&F.listener==p&&F.capture==!!_&&F.ha==k)return M}return-1}var Qe="closure_lm_"+(Math.random()*1e6|0),oe={};function gr(c,p,_,k,M){if(Array.isArray(p)){for(let F=0;F<p.length;F++)gr(c,p[F],_,k,M);return null}return _=Fe(_),c&&c[se]?c.J(p,_,a(k)?!!k.capture:!1,M):Lr(c,p,_,!1,k,M)}function Lr(c,p,_,k,M,F){if(!p)throw Error("Invalid event type");const Q=a(M)?!!M.capture:!!M;let ge=ae(c);if(ge||(c[Qe]=ge=new Le(c)),_=ge.add(p,_,k,Q,F),_.proxy)return _;if(k=ws(),_.proxy=k,k.src=c,k.listener=_,c.addEventListener)b||(M=Q),M===void 0&&(M=!1),c.addEventListener(p.toString(),k,M);else if(c.attachEvent)c.attachEvent(Bh(p.toString()),k);else if(c.addListener&&c.removeListener)c.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return _}function ws(){function c(_){return p.call(c.src,c.listener,_)}const p=J;return c}function Fr(c,p,_,k,M){if(Array.isArray(p))for(var F=0;F<p.length;F++)Fr(c,p[F],_,k,M);else k=a(k)?!!k.capture:!!k,_=Fe(_),c&&c[se]?(c=c.i,F=String(p).toString(),F in c.g&&(p=c.g[F],_=Ee(p,_,k,M),_>-1&&(j(p[_]),Array.prototype.splice.call(p,_,1),p.length==0&&(delete c.g[F],c.h--)))):c&&(c=ae(c))&&(p=c.g[p.toString()],c=-1,p&&(c=Ee(p,_,k,M)),(_=c>-1?p[c]:null)&&Xl(_))}function Xl(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[se])fe(p.i,c);else{var _=c.type,k=c.proxy;p.removeEventListener?p.removeEventListener(_,k,c.capture):p.detachEvent?p.detachEvent(Bh(_),k):p.addListener&&p.removeListener&&p.removeListener(k),(_=ae(p))?(fe(_,c),_.h==0&&(_.src=null,p[Qe]=null)):j(c)}}}function Bh(c){return c in oe?oe[c]:oe[c]="on"+c}function J(c,p){if(c.da)c=!0;else{p=new W(p,this);const _=c.listener,k=c.ha||c.src;c.fa&&Xl(c),c=_.call(k,p)}return c}function ae(c){return c=c[Qe],c instanceof Le?c:null}var rt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Fe(c){return typeof c=="function"?c:(c[rt]||(c[rt]=function(p){return c.handleEvent(p)}),c[rt])}function he(){x.call(this),this.i=new Le(this),this.M=this,this.G=null}d(he,x),he.prototype[se]=!0,he.prototype.removeEventListener=function(c,p,_,k){Fr(this,c,p,_,k)};function ye(c,p){var _,k=c.G;if(k)for(_=[];k;k=k.G)_.push(k);if(c=c.M,k=p.type||p,typeof p=="string")p=new C(p,c);else if(p instanceof C)p.target=p.target||c;else{var M=p;p=new C(k,c),dt(p,M)}M=!0;let F,Q;if(_)for(Q=_.length-1;Q>=0;Q--)F=p.g=_[Q],M=zt(F,k,!0,p)&&M;if(F=p.g=c,M=zt(F,k,!0,p)&&M,M=zt(F,k,!1,p)&&M,_)for(Q=0;Q<_.length;Q++)F=p.g=_[Q],M=zt(F,k,!1,p)&&M}he.prototype.N=function(){if(he.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const _=c.g[p];for(let k=0;k<_.length;k++)j(_[k]);delete c.g[p],c.h--}}this.G=null},he.prototype.J=function(c,p,_,k){return this.i.add(String(c),p,!1,_,k)},he.prototype.K=function(c,p,_,k){return this.i.add(String(c),p,!0,_,k)};function zt(c,p,_,k){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let M=!0;for(let F=0;F<p.length;++F){const Q=p[F];if(Q&&!Q.da&&Q.capture==_){const ge=Q.listener,St=Q.ha||Q.src;Q.fa&&fe(c.i,Q),M=ge.call(St,k)!==!1&&M}}return M&&!k.defaultPrevented}function _r(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function Ts(c){c.g=_r(()=>{c.g=null,c.i&&(c.i=!1,Ts(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class Jl extends x{constructor(p,_){super(),this.m=p,this.l=_,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Ts(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bi(c){x.call(this),this.h=c,this.g={}}d(Bi,x);var zh=[];function gT(c){z(c.g,function(p,_){this.g.hasOwnProperty(_)&&Xl(p)},c),c.g={}}Bi.prototype.N=function(){Bi.Z.N.call(this),gT(this)},Bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Tm=o.JSON.stringify,Ab=o.JSON.parse,Cb=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function _T(){}function yT(){}var Zl={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Em(){C.call(this,"d")}d(Em,C);function Im(){C.call(this,"c")}d(Im,C);var zi={},vT=null;function qh(){return vT=vT||new he}zi.Ia="serverreachability";function wT(c){C.call(this,zi.Ia,c)}d(wT,C);function eu(c){const p=qh();ye(p,new wT(p))}zi.STAT_EVENT="statevent";function TT(c,p){C.call(this,zi.STAT_EVENT,c),this.stat=p}d(TT,C);function rn(c){const p=qh();ye(p,new TT(p,c))}zi.Ja="timingevent";function ET(c,p){C.call(this,zi.Ja,c),this.size=p}d(ET,C);function tu(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function nu(){this.g=!0}nu.prototype.ua=function(){this.g=!1};function xb(c,p,_,k,M,F){c.info(function(){if(c.g)if(F){var Q="",ge=F.split("&");for(let Oe=0;Oe<ge.length;Oe++){var St=ge[Oe].split("=");if(St.length>1){const Dt=St[0];St=St[1];const vr=Dt.split("_");Q=vr.length>=2&&vr[1]=="type"?Q+(Dt+"="+St+"&"):Q+(Dt+"=redacted&")}}}else Q=null;else Q=F;return"XMLHTTP REQ ("+k+") [attempt "+M+"]: "+p+`
`+_+`
`+Q})}function kb(c,p,_,k,M,F,Q){c.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+M+"]: "+p+`
`+_+`
`+F+" "+Q})}function Zo(c,p,_,k){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Pb(c,_)+(k?" "+k:"")})}function Rb(c,p){c.info(function(){return"TIMEOUT: "+p})}nu.prototype.info=function(){};function Pb(c,p){if(!c.g)return p;if(!p)return null;try{const F=JSON.parse(p);if(F){for(c=0;c<F.length;c++)if(Array.isArray(F[c])){var _=F[c];if(!(_.length<2)){var k=_[1];if(Array.isArray(k)&&!(k.length<1)){var M=k[0];if(M!="noop"&&M!="stop"&&M!="close")for(let Q=1;Q<k.length;Q++)k[Q]=""}}}}return Tm(F)}catch{return p}}var $h={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},IT={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ST;function Sm(){}d(Sm,_T),Sm.prototype.g=function(){return new XMLHttpRequest},ST=new Sm;function ru(c){return encodeURIComponent(String(c))}function bb(c){var p=1;c=c.split(":");const _=[];for(;p>0&&c.length;)_.push(c.shift()),p--;return c.length&&_.push(c.join(":")),_}function Es(c,p,_,k){this.j=c,this.i=p,this.l=_,this.S=k||1,this.V=new Bi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new AT}function AT(){this.i=null,this.g="",this.h=!1}var CT={},Am={};function Cm(c,p,_){c.M=1,c.A=Gh(yr(p)),c.u=_,c.R=!0,xT(c,null)}function xT(c,p){c.F=Date.now(),Wh(c),c.B=yr(c.A);var _=c.B,k=c.S;Array.isArray(k)||(k=[String(k)]),jT(_.i,"t",k),c.C=0,_=c.j.L,c.h=new AT,c.g=s0(c.j,_?p:null,!c.u),c.P>0&&(c.O=new Jl(u(c.Y,c,c.g),c.P)),p=c.V,_=c.g,k=c.ba;var M="readystatechange";Array.isArray(M)||(M&&(zh[0]=M.toString()),M=zh);for(let F=0;F<M.length;F++){const Q=gr(_,M[F],k||p.handleEvent,!1,p.h||p);if(!Q)break;p.g[Q.key]=Q}p=c.J?Z(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),eu(),xb(c.i,c.v,c.B,c.l,c.S,c.u)}Es.prototype.ba=function(c){c=c.target;const p=this.O;p&&As(c)==3?p.j():this.Y(c)},Es.prototype.Y=function(c){try{if(c==this.g)e:{const ge=As(this.g),St=this.g.ya(),Oe=this.g.ca();if(!(ge<3)&&(ge!=3||this.g&&(this.h.h||this.g.la()||HT(this.g)))){this.K||ge!=4||St==7||(St==8||Oe<=0?eu(3):eu(2)),xm(this);var p=this.g.ca();this.X=p;var _=Nb(this);if(this.o=p==200,kb(this.i,this.v,this.B,this.l,this.S,ge,p),this.o){if(this.U&&!this.L){t:{if(this.g){var k,M=this.g;if((k=M.g?M.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(k)){var F=k;break t}}F=null}if(c=F)Zo(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,km(this,c);else{this.o=!1,this.m=3,rn(12),qi(this),su(this);break e}}if(this.R){c=!0;let Dt;for(;!this.K&&this.C<_.length;)if(Dt=Db(this,_),Dt==Am){ge==4&&(this.m=4,rn(14),c=!1),Zo(this.i,this.l,null,"[Incomplete Response]");break}else if(Dt==CT){this.m=4,rn(15),Zo(this.i,this.l,_,"[Invalid Chunk]"),c=!1;break}else Zo(this.i,this.l,Dt,null),km(this,Dt);if(kT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ge!=4||_.length!=0||this.h.h||(this.m=1,rn(16),c=!1),this.o=this.o&&c,!c)Zo(this.i,this.l,_,"[Invalid Chunked Response]"),qi(this),su(this);else if(_.length>0&&!this.W){this.W=!0;var Q=this.j;Q.g==this&&Q.aa&&!Q.P&&(Q.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),Mm(Q),Q.P=!0,rn(11))}}else Zo(this.i,this.l,_,null),km(this,_);ge==4&&qi(this),this.o&&!this.K&&(ge==4?e0(this.j,this):(this.o=!1,Wh(this)))}else Hb(this.g),p==400&&_.indexOf("Unknown SID")>0?(this.m=3,rn(12)):(this.m=0,rn(13)),qi(this),su(this)}}}catch{}finally{}};function Nb(c){if(!kT(c))return c.g.la();const p=HT(c.g);if(p==="")return"";let _="";const k=p.length,M=As(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return qi(c),su(c),"";c.h.i=new o.TextDecoder}for(let F=0;F<k;F++)c.h.h=!0,_+=c.h.i.decode(p[F],{stream:!(M&&F==k-1)});return p.length=0,c.h.g+=_,c.C=0,c.h.g}function kT(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Db(c,p){var _=c.C,k=p.indexOf(`
`,_);return k==-1?Am:(_=Number(p.substring(_,k)),isNaN(_)?CT:(k+=1,k+_>p.length?Am:(p=p.slice(k,k+_),c.C=k+_,p)))}Es.prototype.cancel=function(){this.K=!0,qi(this)};function Wh(c){c.T=Date.now()+c.H,RT(c,c.H)}function RT(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=tu(u(c.aa,c),p)}function xm(c){c.D&&(o.clearTimeout(c.D),c.D=null)}Es.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Rb(this.i,this.B),this.M!=2&&(eu(),rn(17)),qi(this),this.m=2,su(this)):RT(this,this.T-c)};function su(c){c.j.I==0||c.K||e0(c.j,c)}function qi(c){xm(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,gT(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function km(c,p){try{var _=c.j;if(_.I!=0&&(_.g==c||Rm(_.h,c))){if(!c.L&&Rm(_.h,c)&&_.I==3){try{var k=_.Ba.g.parse(p)}catch{k=null}if(Array.isArray(k)&&k.length==3){var M=k;if(M[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<c.F)Xh(_),Qh(_);else break e;Om(_),rn(18)}}else _.xa=M[1],0<_.xa-_.K&&M[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=tu(u(_.Va,_),6e3));NT(_.h)<=1&&_.ta&&(_.ta=void 0)}else Wi(_,11)}else if((c.L||_.g==c)&&Xh(_),!R(p))for(M=_.Ba.g.parse(p),p=0;p<M.length;p++){let Oe=M[p];const Dt=Oe[0];if(!(Dt<=_.K))if(_.K=Dt,Oe=Oe[1],_.I==2)if(Oe[0]=="c"){_.M=Oe[1],_.ba=Oe[2];const vr=Oe[3];vr!=null&&(_.ka=vr,_.j.info("VER="+_.ka));const Gi=Oe[4];Gi!=null&&(_.za=Gi,_.j.info("SVER="+_.za));const Cs=Oe[5];Cs!=null&&typeof Cs=="number"&&Cs>0&&(k=1.5*Cs,_.O=k,_.j.info("backChannelRequestTimeoutMs_="+k)),k=_;const xs=c.g;if(xs){const Zh=xs.g?xs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zh){var F=k.h;F.g||Zh.indexOf("spdy")==-1&&Zh.indexOf("quic")==-1&&Zh.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Pm(F,F.h),F.h=null))}if(k.G){const Lm=xs.g?xs.g.getResponseHeader("X-HTTP-Session-Id"):null;Lm&&(k.wa=Lm,ze(k.J,k.G,Lm))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-c.F,_.j.info("Handshake RTT: "+_.T+"ms")),k=_;var Q=c;if(k.na=r0(k,k.L?k.ba:null,k.W),Q.L){DT(k.h,Q);var ge=Q,St=k.O;St&&(ge.H=St),ge.D&&(xm(ge),Wh(ge)),k.g=Q}else JT(k);_.i.length>0&&Yh(_)}else Oe[0]!="stop"&&Oe[0]!="close"||Wi(_,7);else _.I==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Wi(_,7):Vm(_):Oe[0]!="noop"&&_.l&&_.l.qa(Oe),_.A=0)}}eu(4)}catch{}}var Vb=class{constructor(c,p){this.g=c,this.map=p}};function PT(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function bT(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function NT(c){return c.h?1:c.g?c.g.size:0}function Rm(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Pm(c,p){c.g?c.g.add(p):c.h=p}function DT(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}PT.prototype.cancel=function(){if(this.i=VT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function VT(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const _ of c.g.values())p=p.concat(_.G);return p}return m(c.i)}var OT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ob(c,p){if(c){c=c.split("&");for(let _=0;_<c.length;_++){const k=c[_].indexOf("=");let M,F=null;k>=0?(M=c[_].substring(0,k),F=c[_].substring(k+1)):M=c[_],p(M,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function Is(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof Is?(this.l=c.l,iu(this,c.j),this.o=c.o,this.g=c.g,ou(this,c.u),this.h=c.h,bm(this,BT(c.i)),this.m=c.m):c&&(p=String(c).match(OT))?(this.l=!1,iu(this,p[1]||"",!0),this.o=au(p[2]||""),this.g=au(p[3]||"",!0),ou(this,p[4]),this.h=au(p[5]||"",!0),bm(this,p[6]||"",!0),this.m=au(p[7]||"")):(this.l=!1,this.i=new uu(null,this.l))}Is.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(lu(p,MT,!0),":");var _=this.g;return(_||p=="file")&&(c.push("//"),(p=this.o)&&c.push(lu(p,MT,!0),"@"),c.push(ru(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&c.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&c.push("/"),c.push(lu(_,_.charAt(0)=="/"?Fb:Lb,!0))),(_=this.i.toString())&&c.push("?",_),(_=this.m)&&c.push("#",lu(_,jb)),c.join("")},Is.prototype.resolve=function(c){const p=yr(this);let _=!!c.j;_?iu(p,c.j):_=!!c.o,_?p.o=c.o:_=!!c.g,_?p.g=c.g:_=c.u!=null;var k=c.h;if(_)ou(p,c.u);else if(_=!!c.h){if(k.charAt(0)!="/")if(this.g&&!this.h)k="/"+k;else{var M=p.h.lastIndexOf("/");M!=-1&&(k=p.h.slice(0,M+1)+k)}if(M=k,M==".."||M==".")k="";else if(M.indexOf("./")!=-1||M.indexOf("/.")!=-1){k=M.lastIndexOf("/",0)==0,M=M.split("/");const F=[];for(let Q=0;Q<M.length;){const ge=M[Q++];ge=="."?k&&Q==M.length&&F.push(""):ge==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),k&&Q==M.length&&F.push("")):(F.push(ge),k=!0)}k=F.join("/")}else k=M}return _?p.h=k:_=c.i.toString()!=="",_?bm(p,BT(c.i)):_=!!c.m,_&&(p.m=c.m),p};function yr(c){return new Is(c)}function iu(c,p,_){c.j=_?au(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function ou(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function bm(c,p,_){p instanceof uu?(c.i=p,Bb(c.i,c.l)):(_||(p=lu(p,Ub)),c.i=new uu(p,c.l))}function ze(c,p,_){c.i.set(p,_)}function Gh(c){return ze(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function au(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function lu(c,p,_){return typeof c=="string"?(c=encodeURI(c).replace(p,Mb),_&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Mb(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var MT=/[#\/\?@]/g,Lb=/[#\?:]/g,Fb=/[#\?]/g,Ub=/[#\?@]/g,jb=/#/g;function uu(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function $i(c){c.g||(c.g=new Map,c.h=0,c.i&&Ob(c.i,function(p,_){c.add(decodeURIComponent(p.replace(/\+/g," ")),_)}))}n=uu.prototype,n.add=function(c,p){$i(this),this.i=null,c=ea(this,c);let _=this.g.get(c);return _||this.g.set(c,_=[]),_.push(p),this.h+=1,this};function LT(c,p){$i(c),p=ea(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function FT(c,p){return $i(c),p=ea(c,p),c.g.has(p)}n.forEach=function(c,p){$i(this),this.g.forEach(function(_,k){_.forEach(function(M){c.call(p,M,k,this)},this)},this)};function UT(c,p){$i(c);let _=[];if(typeof p=="string")FT(c,p)&&(_=_.concat(c.g.get(ea(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)_=_.concat(c[p]);return _}n.set=function(c,p){return $i(this),this.i=null,c=ea(this,c),FT(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},n.get=function(c,p){return c?(c=UT(this,c),c.length>0?String(c[0]):p):p};function jT(c,p,_){LT(c,p),_.length>0&&(c.i=null,c.g.set(ea(c,p),m(_)),c.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let k=0;k<p.length;k++){var _=p[k];const M=ru(_);_=UT(this,_);for(let F=0;F<_.length;F++){let Q=M;_[F]!==""&&(Q+="="+ru(_[F])),c.push(Q)}}return this.i=c.join("&")};function BT(c){const p=new uu;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function ea(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function Bb(c,p){p&&!c.j&&($i(c),c.i=null,c.g.forEach(function(_,k){const M=k.toLowerCase();k!=M&&(LT(this,k),jT(this,M,_))},c)),c.j=p}function zb(c,p){const _=new nu;if(o.Image){const k=new Image;k.onload=h(Ss,_,"TestLoadImage: loaded",!0,p,k),k.onerror=h(Ss,_,"TestLoadImage: error",!1,p,k),k.onabort=h(Ss,_,"TestLoadImage: abort",!1,p,k),k.ontimeout=h(Ss,_,"TestLoadImage: timeout",!1,p,k),o.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=c}else p(!1)}function qb(c,p){const _=new nu,k=new AbortController,M=setTimeout(()=>{k.abort(),Ss(_,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:k.signal}).then(F=>{clearTimeout(M),F.ok?Ss(_,"TestPingServer: ok",!0,p):Ss(_,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(M),Ss(_,"TestPingServer: error",!1,p)})}function Ss(c,p,_,k,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),k(_)}catch{}}function $b(){this.g=new Cb}function Nm(c){this.i=c.Sb||null,this.h=c.ab||!1}d(Nm,_T),Nm.prototype.g=function(){return new Hh(this.i,this.h)};function Hh(c,p){he.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(Hh,he),n=Hh.prototype,n.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,hu(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,cu(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,hu(this)),this.g&&(this.readyState=3,hu(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;zT(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function zT(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?cu(this):hu(this),this.readyState==3&&zT(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,cu(this))},n.Na=function(c){this.g&&(this.response=c,cu(this))},n.ga=function(){this.g&&cu(this)};function cu(c){c.readyState=4,c.l=null,c.j=null,c.B=null,hu(c)}n.setRequestHeader=function(c,p){this.A.append(c,p)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var _=p.next();!_.done;)_=_.value,c.push(_[0]+": "+_[1]),_=p.next();return c.join(`\r
`)};function hu(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Hh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function qT(c){let p="";return z(c,function(_,k){p+=k,p+=":",p+=_,p+=`\r
`}),p}function Dm(c,p,_){e:{for(k in _){var k=!1;break e}k=!0}k||(_=qT(_),typeof c=="string"?_!=null&&ru(_):ze(c,p,_))}function ut(c){he.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(ut,he);var Wb=/^https?$/i,Gb=["POST","PUT"];n=ut.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,p,_,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ST.g(),this.g.onreadystatechange=f(u(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(F){$T(this,F);return}if(c=_||"",_=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var M in k)_.set(M,k[M]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const F of k.keys())_.set(F,k.get(F));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(_.keys()).find(F=>F.toLowerCase()=="content-type"),M=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Gb,p,void 0)>=0)||k||M||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,Q]of _)this.g.setRequestHeader(F,Q);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(F){$T(this,F)}};function $T(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,WT(c),Kh(c)}function WT(c){c.A||(c.A=!0,ye(c,"complete"),ye(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,ye(this,"complete"),ye(this,"abort"),Kh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Kh(this,!0)),ut.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?GT(this):this.Xa())},n.Xa=function(){GT(this)};function GT(c){if(c.h&&typeof i<"u"){if(c.v&&As(c)==4)setTimeout(c.Ca.bind(c),0);else if(ye(c,"readystatechange"),As(c)==4){c.h=!1;try{const F=c.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var _;if(!(_=p)){var k;if(k=F===0){let Q=String(c.D).match(OT)[1]||null;!Q&&o.self&&o.self.location&&(Q=o.self.location.protocol.slice(0,-1)),k=!Wb.test(Q?Q.toLowerCase():"")}_=k}if(_)ye(c,"complete"),ye(c,"success");else{c.o=6;try{var M=As(c)>2?c.g.statusText:""}catch{M=""}c.l=M+" ["+c.ca()+"]",WT(c)}}finally{Kh(c)}}}}function Kh(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const _=c.g;c.g=null,p||ye(c,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function As(c){return c.g?c.g.readyState:0}n.ca=function(){try{return As(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Ab(p)}};function HT(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Hb(c){const p={};c=(c.g&&As(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<c.length;k++){if(R(c[k]))continue;var _=bb(c[k]);const M=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const F=p[M]||[];p[M]=F,F.push(_)}G(p,function(k){return k.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function du(c,p,_){return _&&_.internalChannelParams&&_.internalChannelParams[c]||p}function KT(c){this.za=0,this.i=[],this.j=new nu,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=du("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=du("baseRetryDelayMs",5e3,c),this.Za=du("retryDelaySeedMs",1e4,c),this.Ta=du("forwardChannelMaxRetries",2,c),this.va=du("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new PT(c&&c.concurrentRequestLimit),this.Ba=new $b,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=KT.prototype,n.ka=8,n.I=1,n.connect=function(c,p,_,k){rn(0),this.W=c,this.H=p||{},_&&k!==void 0&&(this.H.OSID=_,this.H.OAID=k),this.F=this.X,this.J=r0(this,null,this.W),Yh(this)};function Vm(c){if(QT(c),c.I==3){var p=c.V++,_=yr(c.J);if(ze(_,"SID",c.M),ze(_,"RID",p),ze(_,"TYPE","terminate"),fu(c,_),p=new Es(c,c.j,p),p.M=2,p.A=Gh(yr(_)),_=!1,o.navigator&&o.navigator.sendBeacon)try{_=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!_&&o.Image&&(new Image().src=p.A,_=!0),_||(p.g=s0(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Wh(p)}n0(c)}function Qh(c){c.g&&(Mm(c),c.g.cancel(),c.g=null)}function QT(c){Qh(c),c.v&&(o.clearTimeout(c.v),c.v=null),Xh(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Yh(c){if(!bT(c.h)&&!c.m){c.m=!0;var p=c.Ea;P||v(),D||(P(),D=!0),I.add(p,c),c.D=0}}function Kb(c,p){return NT(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=tu(u(c.Ea,c,p),t0(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const M=new Es(this,this.j,c);let F=this.o;if(this.U&&(F?(F=Z(F),dt(F,this.U)):F=this.U),this.u!==null||this.R||(M.J=F,F=null),this.S)e:{for(var p=0,_=0;_<this.i.length;_++){t:{var k=this.i[_];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(p+=k,p>4096){p=_;break e}if(p===4096||_===this.i.length-1){p=_+1;break e}}p=1e3}else p=1e3;p=XT(this,M,p),_=yr(this.J),ze(_,"RID",c),ze(_,"CVER",22),this.G&&ze(_,"X-HTTP-Session-Id",this.G),fu(this,_),F&&(this.R?p="headers="+ru(qT(F))+"&"+p:this.u&&Dm(_,this.u,F)),Pm(this.h,M),this.Ra&&ze(_,"TYPE","init"),this.S?(ze(_,"$req",p),ze(_,"SID","null"),M.U=!0,Cm(M,_,null)):Cm(M,_,p),this.I=2}}else this.I==3&&(c?YT(this,c):this.i.length==0||bT(this.h)||YT(this))};function YT(c,p){var _;p?_=p.l:_=c.V++;const k=yr(c.J);ze(k,"SID",c.M),ze(k,"RID",_),ze(k,"AID",c.K),fu(c,k),c.u&&c.o&&Dm(k,c.u,c.o),_=new Es(c,c.j,_,c.D+1),c.u===null&&(_.J=c.o),p&&(c.i=p.G.concat(c.i)),p=XT(c,_,1e3),_.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Pm(c.h,_),Cm(_,k,p)}function fu(c,p){c.H&&z(c.H,function(_,k){ze(p,k,_)}),c.l&&z({},function(_,k){ze(p,k,_)})}function XT(c,p,_){_=Math.min(c.i.length,_);const k=c.l?u(c.l.Ka,c.l,c):null;e:{var M=c.i;let ge=-1;for(;;){const St=["count="+_];ge==-1?_>0?(ge=M[0].g,St.push("ofs="+ge)):ge=0:St.push("ofs="+ge);let Oe=!0;for(let Dt=0;Dt<_;Dt++){var F=M[Dt].g;const vr=M[Dt].map;if(F-=ge,F<0)ge=Math.max(0,M[Dt].g-100),Oe=!1;else try{F="req"+F+"_"||"";try{var Q=vr instanceof Map?vr:Object.entries(vr);for(const[Gi,Cs]of Q){let xs=Cs;a(Cs)&&(xs=Tm(Cs)),St.push(F+Gi+"="+encodeURIComponent(xs))}}catch(Gi){throw St.push(F+"type="+encodeURIComponent("_badmap")),Gi}}catch{k&&k(vr)}}if(Oe){Q=St.join("&");break e}}Q=void 0}return c=c.i.splice(0,_),p.G=c,Q}function JT(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;P||v(),D||(P(),D=!0),I.add(p,c),c.A=0}}function Om(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=tu(u(c.Da,c),t0(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,ZT(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=tu(u(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,rn(10),Qh(this),ZT(this))};function Mm(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function ZT(c){c.g=new Es(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=yr(c.na);ze(p,"RID","rpc"),ze(p,"SID",c.M),ze(p,"AID",c.K),ze(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ze(p,"TO",c.ia),ze(p,"TYPE","xmlhttp"),fu(c,p),c.u&&c.o&&Dm(p,c.u,c.o),c.O&&(c.g.H=c.O);var _=c.g;c=c.ba,_.M=1,_.A=Gh(yr(p)),_.u=null,_.R=!0,xT(_,c)}n.Va=function(){this.C!=null&&(this.C=null,Qh(this),Om(this),rn(19))};function Xh(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function e0(c,p){var _=null;if(c.g==p){Xh(c),Mm(c),c.g=null;var k=2}else if(Rm(c.h,p))_=p.G,DT(c.h,p),k=1;else return;if(c.I!=0){if(p.o)if(k==1){_=p.u?p.u.length:0,p=Date.now()-p.F;var M=c.D;k=qh(),ye(k,new ET(k,_)),Yh(c)}else JT(c);else if(M=p.m,M==3||M==0&&p.X>0||!(k==1&&Kb(c,p)||k==2&&Om(c)))switch(_&&_.length>0&&(p=c.h,p.i=p.i.concat(_)),M){case 1:Wi(c,5);break;case 4:Wi(c,10);break;case 3:Wi(c,6);break;default:Wi(c,2)}}}function t0(c,p){let _=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(_*=2),_*p}function Wi(c,p){if(c.j.info("Error code "+p),p==2){var _=u(c.bb,c),k=c.Ua;const M=!k;k=new Is(k||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||iu(k,"https"),Gh(k),M?zb(k.toString(),_):qb(k.toString(),_)}else rn(2);c.I=0,c.l&&c.l.pa(p),n0(c),QT(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),rn(2)):(this.j.info("Failed to ping google.com"),rn(1))};function n0(c){if(c.I=0,c.ja=[],c.l){const p=VT(c.h);(p.length!=0||c.i.length!=0)&&(g(c.ja,p),g(c.ja,c.i),c.h.i.length=0,m(c.i),c.i.length=0),c.l.oa()}}function r0(c,p,_){var k=_ instanceof Is?yr(_):new Is(_);if(k.g!="")p&&(k.g=p+"."+k.g),ou(k,k.u);else{var M=o.location;k=M.protocol,p=p?p+"."+M.hostname:M.hostname,M=+M.port;const F=new Is(null);k&&iu(F,k),p&&(F.g=p),M&&ou(F,M),_&&(F.h=_),k=F}return _=c.G,p=c.wa,_&&p&&ze(k,_,p),ze(k,"VER",c.ka),fu(c,k),k}function s0(c,p,_){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new ut(new Nm({ab:_})):new ut(c.ma),p.Fa(c.L),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function i0(){}n=i0.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Jh(){}Jh.prototype.g=function(c,p){return new xn(c,p)};function xn(c,p){he.call(this),this.g=new KT(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!R(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!R(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new ta(this)}d(xn,he),xn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Vm(this.g)},xn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var _={};_.__data__=c,c=_}else this.v&&(_={},_.__data__=Tm(c),c=_);p.i.push(new Vb(p.Ya++,c)),p.I==3&&Yh(p)},xn.prototype.N=function(){this.g.l=null,delete this.j,Vm(this.g),delete this.g,xn.Z.N.call(this)};function o0(c){Em.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const _ in p){c=_;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}d(o0,Em);function a0(){Im.call(this),this.status=1}d(a0,Im);function ta(c){this.g=c}d(ta,i0),ta.prototype.ra=function(){ye(this.g,"a")},ta.prototype.qa=function(c){ye(this.g,new o0(c))},ta.prototype.pa=function(c){ye(this.g,new a0)},ta.prototype.oa=function(){ye(this.g,"b")},Jh.prototype.createWebChannel=Jh.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,wx=function(){return new Jh},vx=function(){return qh()},yx=zi,V_={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},$h.NO_ERROR=0,$h.TIMEOUT=8,$h.HTTP_ERROR=6,Hd=$h,IT.COMPLETE="complete",_x=IT,yT.EventType=Zl,Zl.OPEN="a",Zl.CLOSE="b",Zl.ERROR="c",Zl.MESSAGE="d",he.prototype.listen=he.prototype.J,Vu=yT,ut.prototype.listenOnce=ut.prototype.K,ut.prototype.getLastError=ut.prototype.Ha,ut.prototype.getLastErrorCode=ut.prototype.ya,ut.prototype.getStatus=ut.prototype.ca,ut.prototype.getResponseJson=ut.prototype.La,ut.prototype.getResponseText=ut.prototype.la,ut.prototype.send=ut.prototype.ea,ut.prototype.setWithCredentials=ut.prototype.Fa,gx=ut}).apply(typeof vd<"u"?vd:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mt.UNAUTHENTICATED=new Mt(null),Mt.GOOGLE_CREDENTIALS=new Mt("google-credentials-uid"),Mt.FIRST_PARTY=new Mt("first-party-uid"),Mt.MOCK_USER=new Mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vl="12.9.0";function WF(n){Vl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=new wv("@firebase/firestore");function ua(){return fi.logLevel}function GF(n){fi.setLogLevel(n)}function B(n,...e){if(fi.logLevel<=Ie.DEBUG){const t=e.map(Nv);fi.debug(`Firestore (${Vl}): ${n}`,...t)}}function _t(n,...e){if(fi.logLevel<=Ie.ERROR){const t=e.map(Nv);fi.error(`Firestore (${Vl}): ${n}`,...t)}}function An(n,...e){if(fi.logLevel<=Ie.WARN){const t=e.map(Nv);fi.warn(`Firestore (${Vl}): ${n}`,...t)}}function Nv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Tx(n,r,t)}function Tx(n,e,t){let r=`FIRESTORE (${Vl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw _t(r),new Error(r)}function ne(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||Tx(e,s,r)}function HF(n,e){n||X(57014,e)}function K(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends ds{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ix{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Mt.UNAUTHENTICATED))}shutdown(){}}class KF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class QF{constructor(e){this.t=e,this.currentUser=Mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ne(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Ut;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ut,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ut)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ne(typeof r.accessToken=="string",31837,{l:r}),new Ex(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ne(e===null||typeof e=="string",2055,{h:e}),new Mt(e)}}class YF{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Mt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class XF{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new YF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class O_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class JF{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ne(this.o===void 0,3512);const r=i=>{i.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new O_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new O_(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class ZF{getToken(){return Promise.resolve(new O_(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=e4(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function ce(n,e){return n<e?-1:n>e?1:0}function M_(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return wg(s)===wg(i)?ce(s,i):wg(s)?1:-1}return ce(n.length,e.length)}const t4=55296,n4=57343;function wg(n){const e=n.charCodeAt(0);return e>=t4&&e<=n4}function Xa(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Sx(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="__name__";class Er{constructor(e,t,r){t===void 0?t=0:t>e.length&&X(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&X(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Er.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Er?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=Er.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return ce(e.length,t.length)}static compareSegments(e,t){const r=Er.isNumericId(e),s=Er.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Er.extractNumericId(e).compare(Er.extractNumericId(t)):M_(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return li.fromString(e.substring(4,e.length-2))}}class ve extends Er{construct(e,t,r){return new ve(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new U(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new ve(t)}static emptyPath(){return new ve([])}}const r4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ge extends Er{construct(e,t,r){return new Ge(e,t,r)}static isValidIdentifier(e){return r4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ge.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===L_}static keyField(){return new Ge([L_])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new U(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new U(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new U(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new U(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ge(t)}static emptyPath(){return new Ge([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.path=e}static fromPath(e){return new H(ve.fromString(e))}static fromName(e){return new H(ve.fromString(e).popFirst(5))}static empty(){return new H(ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ve.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new H(new ve(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dv(n,e,t){if(!t)throw new U(L.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Ax(n,e,t,r){if(e===!0&&r===!0)throw new U(L.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sI(n){if(!H.isDocumentKey(n))throw new U(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function iI(n){if(H.isDocumentKey(n))throw new U(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Cx(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function zp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":X(12329,{type:typeof n})}function we(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new U(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=zp(n);throw new U(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function xx(n,e){if(e<=0)throw new U(L.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(n,e){const t={typeString:n};return e&&(t.value=e),t}function zo(n,e){if(!Cx(n))throw new U(L.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(s&&typeof o!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new U(L.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI=-62135596800,aI=1e6;class xe{static now(){return xe.fromMillis(Date.now())}static fromDate(e){return xe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*aI);return new xe(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new U(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new U(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oI)throw new U(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/aI}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zo(e,xe._jsonSchema))return new xe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-oI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xe._jsonSchemaVersion="firestore/timestamp/1.0",xe._jsonSchema={type:It("string",xe._jsonSchemaVersion),seconds:It("number"),nanoseconds:It("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{static fromTimestamp(e){return new ie(e)}static min(){return new ie(new xe(0,0))}static max(){return new ie(new xe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja=-1;class Za{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function F_(n){return n.fields.find(e=>e.kind===2)}function Xi(n){return n.fields.filter(e=>e.kind!==2)}function s4(n,e){let t=ce(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=i4(n.fields[r],e.fields[r]),t!==0)return t;return ce(n.fields.length,e.fields.length)}Za.UNKNOWN_ID=-1;class fo{constructor(e,t){this.fieldPath=e,this.kind=t}}function i4(n,e){const t=Ge.comparator(n.fieldPath,e.fieldPath);return t!==0?t:ce(n.kind,e.kind)}class el{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new el(0,On.min())}}function kx(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ie.fromTimestamp(r===1e9?new xe(t+1,0):new xe(t,r));return new On(s,H.empty(),e)}function Rx(n){return new On(n.readTime,n.key,Ja)}class On{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new On(ie.min(),H.empty(),Ja)}static max(){return new On(ie.max(),H.empty(),Ja)}}function Vv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=H.comparator(n.documentKey,e.documentKey),t!==0?t:ce(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ni(n){if(n.code!==L.FAILED_PRECONDITION||n.message!==Px)throw n;B("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&X(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof O?t:O.resolve(t)}catch(t){return O.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):O.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):O.reject(t)}static resolve(e){return new O((t,r)=>{t(e)})}static reject(e){return new O((t,r)=>{r(e)})}static waitFor(e){return new O((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=O.resolve(!1);for(const r of e)t=t.next(s=>s?O.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const u=l;t(e[u]).next(h=>{o[u]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,t){return new O((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn="SimpleDb";class qp{static open(e,t,r,s){try{return new qp(t,e.transaction(s,r))}catch(i){throw new Qu(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ut,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Qu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Ov(r.target.error);this.S.reject(new Qu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(B(Rn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new a4(t)}}class Pr{static delete(e){return B(Rn,"Removing database:",e),Zi(TC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!RC())return!1;if(Pr.F())return!0;const e=xt(),t=Pr.M(e),r=0<t&&t<10,s=Nx(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Pr.M(xt())===12.2&&_t("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(B(Rn,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new Qu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new U(L.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new U(L.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Qu(e,o))},s.onupgradeneeded=i=>{B(Rn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{B(Rn,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=qp.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),O.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(B(Rn,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Nx(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class o4{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Zi(this.U.delete())}}class Qu extends U{constructor(e,t){super(L.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Di(n){return n.name==="IndexedDbTransactionError"}class a4{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(B(Rn,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(B(Rn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Zi(r)}add(e){return B(Rn,"ADD",this.store.name,e,e),Zi(this.store.add(e))}get(e){return Zi(this.store.get(e)).next(t=>(t===void 0&&(t=null),B(Rn,"GET",this.store.name,e,t),t))}delete(e){return B(Rn,"DELETE",this.store.name,e),Zi(this.store.delete(e))}count(){return B(Rn,"COUNT",this.store.name),Zi(this.store.count())}H(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.J(i,(a,l)=>{o.push(l)}).next(()=>o)}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,t){B(Rn,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const s=this.cursor(r);return this.J(s,(i,o,a)=>a.delete())}ee(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.J(s,t)}te(e){const t=this.cursor({});return new O((r,s)=>{t.onerror=i=>{const o=Ov(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}J(e,t){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new o4(a),u=t(a.primaryKey,a.value,l);if(u instanceof O){const h=u.catch(d=>(l.done(),O.reject(d)));r.push(h)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Zi(n){return new O((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=Ov(r.target.error);t(s)}})}let lI=!1;function Ov(n){const e=Pr.M(xt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new U("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return lI||(lI=!0,setTimeout(()=>{throw r},0)),r}}return n}const Yu="IndexBackfiller";class l4{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){B(Yu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();B(Yu,`Documents written: ${t}`)}catch(t){Di(t)?B(Yu,"Ignoring IndexedDB error during index backfill: ",t):await Ni(t)}await this.re(6e4)})}}class u4{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const r=new Set;let s=t,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return B(Yu,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(B(Yu,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}_e(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=Rx(i);Vv(o,r)>0&&(r=o)}),new On(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=-1;function mh(n){return n==null}function Pc(n){return n===0&&1/n==-1/0}function Dx(n){return typeof n=="number"&&Number.isInteger(n)&&!Pc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf="";function Zt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=uI(e)),e=c4(n.get(t),e);return uI(e)}function c4(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case jf:t+="";break;default:t+=i}}return t}function uI(n){return n+jf+""}function Ar(n){const e=n.length;if(ne(e>=2,64408,{path:n}),e===2)return ne(n.charAt(0)===jf&&n.charAt(1)==="",56145,{path:n}),ve.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf(jf,i);switch((o<0||o>t)&&X(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:X(61167,{path:n})}i=o+2}return new ve(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji="remoteDocuments",gh="owner",ra="owner",bc="mutationQueues",h4="userId",Jn="mutations",cI="batchId",lo="userMutationsIndex",hI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(n,e){return[n,Zt(e)]}function Vx(n,e,t){return[n,Zt(e),t]}const d4={},tl="documentMutations",Bf="remoteDocumentsV14",f4=["prefixPath","collectionGroup","readTime","documentId"],Qd="documentKeyIndex",p4=["prefixPath","collectionGroup","documentId"],Ox="collectionGroupIndex",m4=["collectionGroup","readTime","prefixPath","documentId"],Nc="remoteDocumentGlobal",U_="remoteDocumentGlobalKey",nl="targets",Mx="queryTargetsIndex",g4=["canonicalId","targetId"],rl="targetDocuments",_4=["targetId","path"],Mv="documentTargetsIndex",y4=["path","targetId"],zf="targetGlobalKey",po="targetGlobal",Dc="collectionParents",v4=["collectionId","parent"],sl="clientMetadata",w4="clientId",$p="bundles",T4="bundleId",Wp="namedQueries",E4="name",Lv="indexConfiguration",I4="indexId",j_="collectionGroupIndex",S4="collectionGroup",Xu="indexState",A4=["indexId","uid"],Lx="sequenceNumberIndex",C4=["uid","sequenceNumber"],Ju="indexEntries",x4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Fx="documentKeyIndex",k4=["indexId","uid","orderedDocumentKey"],Gp="documentOverlays",R4=["userId","collectionPath","documentId"],B_="collectionPathOverlayIndex",P4=["userId","collectionPath","largestBatchId"],Ux="collectionGroupOverlayIndex",b4=["userId","collectionGroup","largestBatchId"],Fv="globals",N4="name",jx=[bc,Jn,tl,Ji,nl,gh,po,rl,sl,Nc,Dc,$p,Wp],D4=[...jx,Gp],Bx=[bc,Jn,tl,Bf,nl,gh,po,rl,sl,Nc,Dc,$p,Wp,Gp],zx=Bx,Uv=[...zx,Lv,Xu,Ju],V4=Uv,qx=[...Uv,Fv],O4=qx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_ extends bx{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Nt(n,e){const t=K(n);return Pr.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $x(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function Wx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,t){this.comparator=e,this.root=t||$t.EMPTY}insert(e,t){return new je(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$t.BLACK,null,null))}remove(e){return new je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$t.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wd(this.root,e,this.comparator,!1)}getReverseIterator(){return new wd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wd(this.root,e,this.comparator,!0)}}class wd{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $t{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??$t.RED,this.left=s??$t.EMPTY,this.right=i??$t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new $t(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return $t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return $t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw X(43730,{key:this.key,value:this.value});if(this.right.isRed())throw X(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw X(27949);return e+(this.isRed()?0:1)}}$t.EMPTY=null,$t.RED=!0,$t.BLACK=!1;$t.EMPTY=new class{constructor(){this.size=0}get key(){throw X(57766)}get value(){throw X(16141)}get color(){throw X(16727)}get left(){throw X(29726)}get right(){throw X(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new $t(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.comparator=e,this.data=new je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fI(this.data.getIterator())}getIteratorFrom(e){return new fI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof be)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new be(this.comparator);return t.data=e,t}}class fI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function sa(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new _n([])}unionWith(e){let t=new be(Ge.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new _n(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xa(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Gx("Invalid base64 string: "+i):i}}(e);return new at(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new at(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const L4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function is(n){if(ne(!!n,39018),typeof n=="string"){let e=0;const t=L4.exec(n);if(ne(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Xe(n.seconds),nanos:Xe(n.nanos)}}function Xe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function os(n){return typeof n=="string"?at.fromBase64String(n):at.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx="server_timestamp",Kx="__type__",Qx="__previous_value__",Yx="__local_write_time__";function Hp(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Kx])==null?void 0:r.stringValue)===Hx}function Kp(n){const e=n.mapValue.fields[Qx];return Hp(e)?Kp(e):e}function Vc(n){const e=is(n.mapValue.fields[Yx].timestampValue);return new xe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,t,r,s,i,o,a,l,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=h,this.apiKey=d}}const Oc="(default)";class pi{constructor(e,t){this.projectId=e,this.database=t||Oc}static empty(){return new pi("","")}get isDefaultDatabase(){return this.database===Oc}isEqual(e){return e instanceof pi&&e.projectId===this.projectId&&e.database===this.database}}function U4(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new U(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pi(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="__type__",Xx="__max__",Ks={mapValue:{fields:{__type__:{stringValue:Xx}}}},Bv="__vector__",il="value",Yd={nullValue:"NULL_VALUE"};function mi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Hp(n)?4:Jx(n)?9007199254740991:Qp(n)?10:11:X(28295,{value:n})}function Nr(n,e){if(n===e)return!0;const t=mi(n);if(t!==mi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Vc(n).isEqual(Vc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=is(s.timestampValue),a=is(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return os(s.bytesValue).isEqual(os(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Xe(s.geoPointValue.latitude)===Xe(i.geoPointValue.latitude)&&Xe(s.geoPointValue.longitude)===Xe(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Xe(s.integerValue)===Xe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Xe(s.doubleValue),a=Xe(i.doubleValue);return o===a?Pc(o)===Pc(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Xa(n.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(dI(o)!==dI(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Nr(o[l],a[l])))return!1;return!0}(n,e);default:return X(52216,{left:n})}}function Mc(n,e){return(n.values||[]).find(t=>Nr(t,e))!==void 0}function gi(n,e){if(n===e)return 0;const t=mi(n),r=mi(e);if(t!==r)return ce(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ce(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Xe(i.integerValue||i.doubleValue),l=Xe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return pI(n.timestampValue,e.timestampValue);case 4:return pI(Vc(n),Vc(e));case 5:return M_(n.stringValue,e.stringValue);case 6:return function(i,o){const a=os(i),l=os(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=ce(a[u],l[u]);if(h!==0)return h}return ce(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ce(Xe(i.latitude),Xe(o.latitude));return a!==0?a:ce(Xe(i.longitude),Xe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return mI(n.arrayValue,e.arrayValue);case 10:return function(i,o){var f,m,g,w;const a=i.fields||{},l=o.fields||{},u=(f=a[il])==null?void 0:f.arrayValue,h=(m=l[il])==null?void 0:m.arrayValue,d=ce(((g=u==null?void 0:u.values)==null?void 0:g.length)||0,((w=h==null?void 0:h.values)==null?void 0:w.length)||0);return d!==0?d:mI(u,h)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ks.mapValue&&o===Ks.mapValue)return 0;if(i===Ks.mapValue)return 1;if(o===Ks.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const f=M_(l[d],h[d]);if(f!==0)return f;const m=gi(a[l[d]],u[h[d]]);if(m!==0)return m}return ce(l.length,h.length)}(n.mapValue,e.mapValue);default:throw X(23264,{he:t})}}function pI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ce(n,e);const t=is(n),r=is(e),s=ce(t.seconds,r.seconds);return s!==0?s:ce(t.nanos,r.nanos)}function mI(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=gi(t[s],r[s]);if(i)return i}return ce(t.length,r.length)}function ol(n){return q_(n)}function q_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=is(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return os(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return H.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=q_(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${q_(t.fields[o])}`;return s+"}"}(n.mapValue):X(61005,{value:n})}function Xd(n){switch(mi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Kp(n);return e?16+Xd(e):16;case 5:return 2*n.stringValue.length;case 6:return os(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Xd(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Vi(r.fields,(i,o)=>{s+=i.length+Xd(o)}),s}(n.mapValue);default:throw X(13486,{value:n})}}function Ao(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function $_(n){return!!n&&"integerValue"in n}function Lc(n){return!!n&&"arrayValue"in n}function gI(n){return!!n&&"nullValue"in n}function _I(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jd(n){return!!n&&"mapValue"in n}function Qp(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[jv])==null?void 0:r.stringValue)===Bv}function Zu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Vi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Zu(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Zu(n.arrayValue.values[t]);return e}return{...n}}function Jx(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Xx}const Zx={mapValue:{fields:{[jv]:{stringValue:Bv},[il]:{arrayValue:{}}}}};function j4(n){return"nullValue"in n?Yd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ao(pi.empty(),H.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Qp(n)?Zx:{mapValue:{}}:X(35942,{value:n})}function B4(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ao(pi.empty(),H.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Zx:"mapValue"in n?Qp(n)?{mapValue:{}}:Ks:X(61959,{value:n})}function yI(n,e){const t=gi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function vI(n,e){const t=gi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.value=e}static empty(){return new Lt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zu(t)}setAll(e){let t=Ge.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Zu(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Jd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Vi(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Lt(Zu(this.value))}}function ek(n){const e=[];return Vi(n.fields,(t,r)=>{const s=new Ge([t]);if(Jd(r)){const i=ek(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new _n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new We(e,0,ie.min(),ie.min(),ie.min(),Lt.empty(),0)}static newFoundDocument(e,t,r,s){return new We(e,1,t,ie.min(),r,s,0)}static newNoDocument(e,t){return new We(e,2,t,ie.min(),ie.min(),Lt.empty(),0)}static newUnknownDocument(e,t){return new We(e,3,t,ie.min(),ie.min(),Lt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof We&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new We(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t){this.position=e,this.inclusive=t}}function wI(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=H.comparator(H.fromName(o.referenceValue),t.key):r=gi(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function TI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Nr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,t="asc"){this.field=e,this.dir=t}}function z4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{}class Se extends tk{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new q4(e,t,r):t==="array-contains"?new G4(e,r):t==="in"?new ak(e,r):t==="not-in"?new H4(e,r):t==="array-contains-any"?new K4(e,r):new Se(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new $4(e,r):new W4(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(gi(t,this.value)):t!==null&&mi(this.value)===mi(t)&&this.matchesComparison(gi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ke extends tk{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ke(e,t)}matches(e){return al(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function al(n){return n.op==="and"}function W_(n){return n.op==="or"}function zv(n){return nk(n)&&al(n)}function nk(n){for(const e of n.filters)if(e instanceof ke)return!1;return!0}function G_(n){if(n instanceof Se)return n.field.canonicalString()+n.op.toString()+ol(n.value);if(zv(n))return n.filters.map(e=>G_(e)).join(",");{const e=n.filters.map(t=>G_(t)).join(",");return`${n.op}(${e})`}}function rk(n,e){return n instanceof Se?function(r,s){return s instanceof Se&&r.op===s.op&&r.field.isEqual(s.field)&&Nr(r.value,s.value)}(n,e):n instanceof ke?function(r,s){return s instanceof ke&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&rk(o,s.filters[a]),!0):!1}(n,e):void X(19439)}function sk(n,e){const t=n.filters.concat(e);return ke.create(t,n.op)}function ik(n){return n instanceof Se?function(t){return`${t.field.canonicalString()} ${t.op} ${ol(t.value)}`}(n):n instanceof ke?function(t){return t.op.toString()+" {"+t.getFilters().map(ik).join(" ,")+"}"}(n):"Filter"}class q4 extends Se{constructor(e,t,r){super(e,t,r),this.key=H.fromName(r.referenceValue)}matches(e){const t=H.comparator(e.key,this.key);return this.matchesComparison(t)}}class $4 extends Se{constructor(e,t){super(e,"in",t),this.keys=ok("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class W4 extends Se{constructor(e,t){super(e,"not-in",t),this.keys=ok("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ok(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(r=>H.fromName(r.referenceValue))}class G4 extends Se{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Lc(t)&&Mc(t.arrayValue,this.value)}}class ak extends Se{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Mc(this.value.arrayValue,t)}}class H4 extends Se{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Mc(this.value.arrayValue,t)}}class K4 extends Se{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Lc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Mc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function H_(n,e=null,t=[],r=[],s=null,i=null,o=null){return new Q4(n,e,t,r,s,i,o)}function Co(n){const e=K(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>G_(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),mh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ol(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ol(r)).join(",")),e.Te=t}return e.Te}function _h(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!z4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!TI(n.startAt,e.startAt)&&TI(n.endAt,e.endAt)}function qf(n){return H.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function $f(n,e){return n.filters.filter(t=>t instanceof Se&&t.field.isEqual(e))}function EI(n,e,t){let r=Yd,s=!0;for(const i of $f(n,e)){let o=Yd,a=!0;switch(i.op){case"<":case"<=":o=j4(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Yd}yI({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];yI({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function II(n,e,t){let r=Ks,s=!0;for(const i of $f(n,e)){let o=Ks,a=!0;switch(i.op){case">=":case">":o=B4(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Ks}vI({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];vI({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function lk(n,e,t,r,s,i,o,a){return new fs(n,e,t,r,s,i,o,a)}function Ol(n){return new fs(n)}function SI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Y4(n){return H.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function qv(n){return n.collectionGroup!==null}function Fa(n){const e=K(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new be(Ge.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Fc(i,r))}),t.has(Ge.keyField().canonicalString())||e.Ie.push(new Fc(Ge.keyField(),r))}return e.Ie}function en(n){const e=K(n);return e.Ee||(e.Ee=ck(e,Fa(n))),e.Ee}function uk(n){const e=K(n);return e.Re||(e.Re=ck(e,n.explicitOrderBy)),e.Re}function ck(n,e){if(n.limitType==="F")return H_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Fc(s.field,i)});const t=n.endAt?new _i(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new _i(n.startAt.position,n.startAt.inclusive):null;return H_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function K_(n,e){const t=n.filters.concat([e]);return new fs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function X4(n,e){const t=n.explicitOrderBy.concat([e]);return new fs(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Wf(n,e,t){return new fs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function J4(n,e){return new fs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Z4(n,e){return new fs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function yh(n,e){return _h(en(n),en(e))&&n.limitType===e.limitType}function hk(n){return`${Co(en(n))}|lt:${n.limitType}`}function ca(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>ik(s)).join(", ")}]`),mh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>ol(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>ol(s)).join(",")),`Target(${r})`}(en(n))}; limitType=${n.limitType})`}function vh(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):H.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of Fa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const u=wI(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Fa(r),s)||r.endAt&&!function(o,a,l){const u=wI(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Fa(r),s))}(n,e)}function dk(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function fk(n){return(e,t)=>{let r=!1;for(const s of Fa(n)){const i=e5(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function e5(n,e,t){const r=n.field.isKeyField()?H.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),u=a.data.field(i);return l!==null&&u!==null?gi(l,u):X(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return X(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Vi(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Wx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5=new je(H.comparator);function yn(){return t5}const pk=new je(H.comparator);function Ou(...n){let e=pk;for(const t of n)e=e.insert(t.key,t);return e}function mk(n){let e=pk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Cr(){return ec()}function gk(){return ec()}function ec(){return new ps(n=>n.toString(),(n,e)=>n.isEqual(e))}const n5=new je(H.comparator),r5=new be(H.comparator);function pe(...n){let e=r5;for(const t of n)e=e.add(t);return e}const s5=new be(ce);function $v(){return s5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pc(e)?"-0":e}}function _k(n){return{integerValue:""+n}}function yk(n,e){return Dx(e)?_k(e):Wv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(){this._=void 0}}function i5(n,e,t){return n instanceof ll?function(s,i){const o={fields:{[Kx]:{stringValue:Hx},[Yx]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Hp(i)&&(i=Kp(i)),i&&(o.fields[Qx]=i),{mapValue:o}}(t,e):n instanceof xo?wk(n,e):n instanceof ko?Tk(n,e):function(s,i){const o=vk(s,i),a=AI(o)+AI(s.Ae);return $_(o)&&$_(s.Ae)?_k(a):Wv(s.serializer,a)}(n,e)}function o5(n,e,t){return n instanceof xo?wk(n,e):n instanceof ko?Tk(n,e):t}function vk(n,e){return n instanceof ul?function(r){return $_(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ll extends Yp{}class xo extends Yp{constructor(e){super(),this.elements=e}}function wk(n,e){const t=Ek(e);for(const r of n.elements)t.some(s=>Nr(s,r))||t.push(r);return{arrayValue:{values:t}}}class ko extends Yp{constructor(e){super(),this.elements=e}}function Tk(n,e){let t=Ek(e);for(const r of n.elements)t=t.filter(s=>!Nr(s,r));return{arrayValue:{values:t}}}class ul extends Yp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function AI(n){return Xe(n.integerValue||n.doubleValue)}function Ek(n){return Lc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e,t){this.field=e,this.transform=t}}function a5(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof xo&&s instanceof xo||r instanceof ko&&s instanceof ko?Xa(r.elements,s.elements,Nr):r instanceof ul&&s instanceof ul?Nr(r.Ae,s.Ae):r instanceof ll&&s instanceof ll}(n.transform,e.transform)}class l5{constructor(e,t){this.version=e,this.transformResults=t}}class et{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new et}static exists(e){return new et(void 0,e)}static updateTime(e){return new et(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Xp{}function Ik(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ll(n.key,et.none()):new Ml(n.key,n.data,et.none());{const t=n.data,r=Lt.empty();let s=new be(Ge.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ms(n.key,r,new _n(s.toArray()),et.none())}}function u5(n,e,t){n instanceof Ml?function(s,i,o){const a=s.value.clone(),l=xI(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof ms?function(s,i,o){if(!Zd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=xI(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Sk(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function tc(n,e,t,r){return n instanceof Ml?function(i,o,a,l){if(!Zd(i.precondition,o))return a;const u=i.value.clone(),h=kI(i.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof ms?function(i,o,a,l){if(!Zd(i.precondition,o))return a;const u=kI(i.fieldTransforms,l,o),h=o.data;return h.setAll(Sk(i)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(n,e,t,r):function(i,o,a){return Zd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function c5(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=vk(r.transform,s||null);i!=null&&(t===null&&(t=Lt.empty()),t.set(r.field,i))}return t||null}function CI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Xa(r,s,(i,o)=>a5(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ml extends Xp{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ms extends Xp{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Sk(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function xI(n,e,t){const r=new Map;ne(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,o5(o,a,t[s]))}return r}function kI(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,i5(i,o,e))}return r}class Ll extends Xp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Gv extends Xp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&u5(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=tc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=tc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=gk();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=Ik(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&Xa(this.mutations,e.mutations,(t,r)=>CI(t,r))&&Xa(this.baseMutations,e.baseMutations,(t,r)=>CI(t,r))}}class Kv{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ne(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return n5}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Kv(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt,Ae;function Ck(n){switch(n){case L.OK:return X(64938);case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0;default:return X(15467,{code:n})}}function xk(n){if(n===void 0)return _t("GRPC error has no .code"),L.UNKNOWN;switch(n){case Tt.OK:return L.OK;case Tt.CANCELLED:return L.CANCELLED;case Tt.UNKNOWN:return L.UNKNOWN;case Tt.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case Tt.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case Tt.INTERNAL:return L.INTERNAL;case Tt.UNAVAILABLE:return L.UNAVAILABLE;case Tt.UNAUTHENTICATED:return L.UNAUTHENTICATED;case Tt.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case Tt.NOT_FOUND:return L.NOT_FOUND;case Tt.ALREADY_EXISTS:return L.ALREADY_EXISTS;case Tt.PERMISSION_DENIED:return L.PERMISSION_DENIED;case Tt.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case Tt.ABORTED:return L.ABORTED;case Tt.OUT_OF_RANGE:return L.OUT_OF_RANGE;case Tt.UNIMPLEMENTED:return L.UNIMPLEMENTED;case Tt.DATA_LOSS:return L.DATA_LOSS;default:return X(39323,{code:n})}}(Ae=Tt||(Tt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nc=null;function d5(n){if(nc)throw new Error("a TestingHooksSpi instance is already set");nc=n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5=new li([4294967295,4294967295],0);function RI(n){const e=kk().encode(n),t=new mx;return t.update(e),new Uint8Array(t.digest())}function PI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new li([t,r],0),new li([s,i],0)]}class Yv{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Mu(`Invalid padding: ${t}`);if(r<0)throw new Mu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Mu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=li.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(li.fromNumber(r)));return s.compare(f5)===1&&(s=new li([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=RI(e),[r,s]=PI(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Yv(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const t=RI(e),[r,s]=PI(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Mu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Eh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Th(ie.min(),s,new je(ce),yn(),pe())}}class Eh{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Eh(r,t,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,t,r,s){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Rk{constructor(e,t){this.targetId=e,this.Ce=t}}class Pk{constructor(e,t,r=at.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class bI{constructor(){this.ve=0,this.Fe=NI(),this.Me=at.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=pe(),t=pe(),r=pe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:X(38017,{changeType:i})}}),new Eh(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=NI()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ne(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class p5{constructor(e){this.Ge=e,this.ze=new Map,this.je=yn(),this.He=Td(),this.Je=Td(),this.Ze=new je(ce)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:X(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,s)=>{this.rt(s)&&t(s)})}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(qf(i))if(r===0){const o=new H(i.path);this.et(t,o,We.newNoDocument(o,ie.min()))}else ne(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,u)}nc==null||nc.lt(function(h,d,f,m,g){var y,T,S;const w={localCacheCount:h,existenceFilterCount:d.count,databaseId:f.database,projectId:f.projectId},E=d.unchangedNames;return E&&(w.bloomFilter={applied:g===0,hashCount:(E==null?void 0:E.hashCount)??0,bitmapLength:((T=(y=E==null?void 0:E.bits)==null?void 0:y.bitmap)==null?void 0:T.length)??0,padding:((S=E==null?void 0:E.bits)==null?void 0:S.padding)??0,mightContain:N=>(m==null?void 0:m.mightContain(N))??!1}),w}(o,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=os(r).toUint8Array()}catch(l){if(l instanceof Gx)return An("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Yv(o,s,i)}catch(l){return An(l instanceof Mu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(t,i,null),s++)}),s}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&qf(a.target)){const l=new H(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,We.newNoDocument(l,e))}i.Be&&(t.set(o,i.ke()),i.Ke())}});let r=pe();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Th(e,t,this.Ze,this.je,r);return this.je=yn(),this.He=Td(),this.Je=Td(),this.Ze=new je(ce),s}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.qe(t,1):s.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new bI,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new be(ce),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new be(ce),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||B("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new bI),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Td(){return new je(H.comparator)}function NI(){return new je(H.comparator)}const m5={asc:"ASCENDING",desc:"DESCENDING"},g5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_5={and:"AND",or:"OR"};class y5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Q_(n,e){return n.useProto3Json||mh(e)?e:{value:e}}function cl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function v5(n,e){return cl(n,e.toTimestamp())}function vt(n){return ne(!!n,49232),ie.fromTimestamp(function(t){const r=is(t);return new xe(r.seconds,r.nanos)}(n))}function Xv(n,e){return Y_(n,e).canonicalString()}function Y_(n,e){const t=function(s){return new ve(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Nk(n){const e=ve.fromString(n);return ne(Bk(e),10190,{key:e.toString()}),e}function Uc(n,e){return Xv(n.databaseId,e.path)}function br(n,e){const t=Nk(e);if(t.get(1)!==n.databaseId.projectId)throw new U(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new U(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new H(Ok(t))}function Dk(n,e){return Xv(n.databaseId,e)}function Vk(n){const e=Nk(n);return e.length===4?ve.emptyPath():Ok(e)}function X_(n){return new ve(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ok(n){return ne(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function DI(n,e,t){return{name:Uc(n,e),fields:t.value.mapValue.fields}}function Jp(n,e,t){const r=br(n,e.name),s=vt(e.updateTime),i=e.createTime?vt(e.createTime):ie.min(),o=new Lt({mapValue:{fields:e.fields}}),a=We.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function w5(n,e){return"found"in e?function(r,s){ne(!!s.found,43571),s.found.name,s.found.updateTime;const i=br(r,s.found.name),o=vt(s.found.updateTime),a=s.found.createTime?vt(s.found.createTime):ie.min(),l=new Lt({mapValue:{fields:s.found.fields}});return We.newFoundDocument(i,o,a,l)}(n,e):"missing"in e?function(r,s){ne(!!s.missing,3894),ne(!!s.readTime,22933);const i=br(r,s.missing),o=vt(s.readTime);return We.newNoDocument(i,o)}(n,e):X(7234,{result:e})}function T5(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:X(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,h){return u.useProto3Json?(ne(h===void 0||typeof h=="string",58123),at.fromBase64String(h||"")):(ne(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),at.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?L.UNKNOWN:xk(u.code);return new U(h,u.message||"")}(o);t=new Pk(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=br(n,r.document.name),i=vt(r.document.updateTime),o=r.document.createTime?vt(r.document.createTime):ie.min(),a=new Lt({mapValue:{fields:r.document.fields}}),l=We.newFoundDocument(s,i,o,a),u=r.targetIds||[],h=r.removedTargetIds||[];t=new ef(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=br(n,r.document),i=r.readTime?vt(r.readTime):ie.min(),o=We.newNoDocument(s,i),a=r.removedTargetIds||[];t=new ef([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=br(n,r.document),i=r.removedTargetIds||[];t=new ef([],i,s,null)}else{if(!("filter"in e))return X(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new h5(s,i),a=r.targetId;t=new Rk(a,o)}}return t}function jc(n,e){let t;if(e instanceof Ml)t={update:DI(n,e.key,e.value)};else if(e instanceof Ll)t={delete:Uc(n,e.key)};else if(e instanceof ms)t={update:DI(n,e.key,e.data),updateMask:x5(e.fieldMask)};else{if(!(e instanceof Gv))return X(16599,{dt:e.type});t={verify:Uc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ll)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof xo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ko)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ul)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw X(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:v5(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:X(27497)}(n,e.precondition)),t}function J_(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?et.updateTime(vt(i.updateTime)):i.exists!==void 0?et.exists(i.exists):et.none()}(e.currentDocument):et.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)ne(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new ll;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new xo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new ko(h)}else"increment"in a?l=new ul(o,a.increment):X(16584,{proto:a});const u=Ge.fromServerFormat(a.fieldPath);return new wh(u,l)}(n,s)):[];if(e.update){e.update.name;const s=br(n,e.update.name),i=new Lt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new _n(u.map(h=>Ge.fromServerFormat(h)))}(e.updateMask);return new ms(s,i,o,t,r)}return new Ml(s,i,t,r)}if(e.delete){const s=br(n,e.delete);return new Ll(s,t)}if(e.verify){const s=br(n,e.verify);return new Gv(s,t)}return X(1463,{proto:e})}function E5(n,e){return n&&n.length>0?(ne(e!==void 0,14353),n.map(t=>function(s,i){let o=s.updateTime?vt(s.updateTime):vt(i);return o.isEqual(ie.min())&&(o=vt(i)),new l5(o,s.transformResults||[])}(t,e))):[]}function Mk(n,e){return{documents:[Dk(n,e.path)]}}function Zp(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Dk(n,s);const i=function(u){if(u.length!==0)return jk(ke.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(h=>function(f){return{field:qs(f.field),direction:S5(f.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Q_(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:t,parent:s}}function Lk(n,e,t,r){const{ft:s,parent:i}=Zp(n,e),o={},a=[];let l=0;return t.forEach(u=>{const h=r?u.alias:"aggregate_"+l++;o[h]=u.alias,u.aggregateType==="count"?a.push({alias:h,count:{}}):u.aggregateType==="avg"?a.push({alias:h,avg:{field:qs(u.fieldPath)}}):u.aggregateType==="sum"&&a.push({alias:h,sum:{field:qs(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function Fk(n){let e=Vk(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ne(r===1,65062);const h=t.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];t.where&&(i=function(d){const f=Uk(d);return f instanceof ke&&zv(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(g){return new Fc(ha(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,mh(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(d){const f=!!d.before,m=d.values||[];return new _i(m,f)}(t.startAt));let u=null;return t.endAt&&(u=function(d){const f=!d.before,m=d.values||[];return new _i(m,f)}(t.endAt)),lk(e,s,o,i,a,"F",l,u)}function I5(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Uk(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ha(t.unaryFilter.field);return Se.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ha(t.unaryFilter.field);return Se.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ha(t.unaryFilter.field);return Se.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ha(t.unaryFilter.field);return Se.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return X(61313);default:return X(60726)}}(n):n.fieldFilter!==void 0?function(t){return Se.create(ha(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return X(58110);default:return X(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ke.create(t.compositeFilter.filters.map(r=>Uk(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return X(1026)}}(t.compositeFilter.op))}(n):X(30097,{filter:n})}function S5(n){return m5[n]}function A5(n){return g5[n]}function C5(n){return _5[n]}function qs(n){return{fieldPath:n.canonicalString()}}function ha(n){return Ge.fromServerFormat(n.fieldPath)}function jk(n){return n instanceof Se?function(t){if(t.op==="=="){if(_I(t.value))return{unaryFilter:{field:qs(t.field),op:"IS_NAN"}};if(gI(t.value))return{unaryFilter:{field:qs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(_I(t.value))return{unaryFilter:{field:qs(t.field),op:"IS_NOT_NAN"}};if(gI(t.value))return{unaryFilter:{field:qs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qs(t.field),op:A5(t.op),value:t.value}}}(n):n instanceof ke?function(t){const r=t.getFilters().map(s=>jk(s));return r.length===1?r[0]:{compositeFilter:{op:C5(t.op),filters:r}}}(n):X(54877,{filter:n})}function x5(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Bk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function zk(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,t,r,s,i=ie.min(),o=ie.min(),a=at.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Hr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.yt=e}}function k5(n,e){let t;if(e.document)t=Jp(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=H.fromSegments(e.noDocument.path),s=Po(e.noDocument.readTime);t=We.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return X(56709);{const r=H.fromSegments(e.unknownDocument.path),s=Po(e.unknownDocument.version);t=We.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new xe(s[0],s[1]);return ie.fromTimestamp(i)}(e.readTime)),t}function VI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Gf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Uc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:cl(i,o.version.toTimestamp()),createTime:cl(i,o.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ro(e.version)};else{if(!e.isUnknownDocument())return X(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ro(e.version)}}return r}function Gf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ro(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Po(n){const e=new xe(n.seconds,n.nanoseconds);return ie.fromTimestamp(e)}function eo(n,e){const t=(e.baseMutations||[]).map(i=>J_(n.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>J_(n.yt,i)),s=xe.fromMillis(e.localWriteTimeMs);return new Hv(e.batchId,s,t,r)}function Lu(n){const e=Po(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Po(n.lastLimboFreeSnapshotVersion):ie.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){const o=i.documents.length;return ne(o===1,1966,{count:o}),en(Ol(Vk(i.documents[0])))}(n.query):function(i){return en(Fk(i))}(n.query),new Hr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,at.fromBase64String(n.resumeToken))}function $k(n,e){const t=Ro(e.snapshotVersion),r=Ro(e.lastLimboFreeSnapshotVersion);let s;s=qf(e.target)?Mk(n.yt,e.target):Zp(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Co(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function em(n){const e=Fk({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wf(e,e.limit,"L"):e}function Tg(n,e){return new Qv(e.largestBatchId,J_(n.yt,e.overlayMutation))}function OI(n,e){const t=e.path.lastSegment();return[n,Zt(e.path.popLast()),t]}function MI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ro(r.readTime),documentKey:Zt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{getBundleMetadata(e,t){return LI(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Po(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return LI(e).put(function(s){return{bundleId:s.id,createTime:Ro(vt(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return FI(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:em(i.bundledQuery),readTime:Po(i.readTime)}}(r)})}saveNamedQuery(e,t){return FI(e).put(function(s){return{name:s.name,readTime:Ro(vt(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function LI(n){return Nt(n,$p)}function FI(n){return Nt(n,Wp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new tm(e,r)}getOverlay(e,t){return Eu(e).get(OI(this.userId,t)).next(r=>r?Tg(this.serializer,r):null)}getOverlays(e,t){const r=Cr();return O.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new Qv(t,o);s.push(this.bt(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Zt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Eu(e).X(B_,a))}),O.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Cr(),i=Zt(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Eu(e).H(B_,o).next(a=>{for(const l of a){const u=Tg(this.serializer,l);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Cr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Eu(e).ee({index:Ux,range:a},(l,u,h)=>{const d=Tg(this.serializer,u);i.size()<s||d.largestBatchId===o?(i.set(d.getKey(),d),o=d.largestBatchId):h.done()}).next(()=>i)}bt(e,t){return Eu(e).put(function(s,i,o){const[a,l,u]=OI(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:jc(s.yt,o.mutation)}}(this.serializer,this.userId,t))}}function Eu(n){return Nt(n,Gp)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{St(e){return Nt(e,Fv)}getSessionToken(e){return this.St(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?at.fromUint8Array(r):at.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Xe(e.integerValue));else if("doubleValue"in e){const r=Xe(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Pc(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=is(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(os(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Jx(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Qp(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):X(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const s of Object.keys(r))this.Ot(s,t),this.Ct(r[s],t)}kt(e,t){var o,a;const r=e.fields||{};this.Ft(t,53);const s=il,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(t,15),t.Mt(Xe(i)),this.Ot(s,t),this.Ct(r[s],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const s of r)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),H.fromName(e).path.forEach(r=>{this.Ft(t,60),this.$t(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}to.Wt=new to;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia=255;function b5(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function UI(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=b5(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class N5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const s=t.codePointAt(0);this.Ht(240|s>>>18),this.Ht(128|63&s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s)}}this.Jt()}Yt(e){const t=this.en(e),r=UI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),r=UI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(ia),this.sn(255)}_n(){this.an(ia),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===ia?(this.sn(ia),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===ia?(this.an(ia),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class D5{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class V5{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Iu{constructor(){this.cn=new N5,this.ascending=new D5(this.cn),this.descending=new V5(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,t,r,s){this.hn=e,this.Pn=t,this.Tn=r,this.In=s}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new no(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:tf(this.Tn),directionalValue:tf(this.In),orderedDocumentKey:tf(t),documentKey:r.path.toArray()}}An(e,t,r){const s=this.Rn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Ps(n,e){let t=n.hn-e.hn;return t!==0?t:(t=jI(n.Tn,e.Tn),t!==0?t:(t=jI(n.In,e.In),t!==0?t:H.comparator(n.Pn,e.Pn)))}function jI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function tf(n){return kC()?function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r}(n):n}function BI(n){return typeof n!="string"?n:function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(n)}class zI{constructor(e){this.Vn=new be((t,r)=>Ge.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(ne(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=F_(e);if(t!==void 0&&!this.pn(t))return!1;const r=Xi(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.pn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){const a=this.Vn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.yn(a,l)||!this.wn(this.dn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.dn.length||!this.wn(this.dn[o++],a))return!1}return!0}bn(){if(this.fn)return null;let e=new be(Ge.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new fo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new fo(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new fo(r.field,r.dir==="asc"?0:1)));return new Za(Za.UNKNOWN_ID,this.collectionId,t,el.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(n){var t,r;if(ne(n instanceof Se||n instanceof ke,20012),n instanceof Se){if(n instanceof ak){const s=((r=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map(i=>Se.create(n.field,"==",i)))||[];return ke.create(s,"or")}return n}const e=n.filters.map(s=>Wk(s));return ke.create(e,n.op)}function O5(n){if(n.getFilters().length===0)return[];const e=ty(Wk(n));return ne(Gk(e),7391),Z_(e)||ey(e)?[e]:e.getFilters()}function Z_(n){return n instanceof Se}function ey(n){return n instanceof ke&&zv(n)}function Gk(n){return Z_(n)||ey(n)||function(t){if(t instanceof ke&&W_(t)){for(const r of t.getFilters())if(!Z_(r)&&!ey(r))return!1;return!0}return!1}(n)}function ty(n){if(ne(n instanceof Se||n instanceof ke,34018),n instanceof Se)return n;if(n.filters.length===1)return ty(n.filters[0]);const e=n.filters.map(r=>ty(r));let t=ke.create(e,n.op);return t=Hf(t),Gk(t)?t:(ne(t instanceof ke,64498),ne(al(t),40251),ne(t.filters.length>1,57927),t.filters.reduce((r,s)=>Jv(r,s)))}function Jv(n,e){let t;return ne(n instanceof Se||n instanceof ke,38388),ne(e instanceof Se||e instanceof ke,25473),t=n instanceof Se?e instanceof Se?function(s,i){return ke.create([s,i],"and")}(n,e):qI(n,e):e instanceof Se?qI(e,n):function(s,i){if(ne(s.filters.length>0&&i.filters.length>0,48005),al(s)&&al(i))return sk(s,i.getFilters());const o=W_(s)?s:i,a=W_(s)?i:s,l=o.filters.map(u=>Jv(u,a));return ke.create(l,"or")}(n,e),Hf(t)}function qI(n,e){if(al(e))return sk(e,n.getFilters());{const t=e.filters.map(r=>Jv(n,r));return ke.create(t,"or")}}function Hf(n){if(ne(n instanceof Se||n instanceof ke,11850),n instanceof Se)return n;const e=n.getFilters();if(e.length===1)return Hf(e[0]);if(nk(n))return n;const t=e.map(s=>Hf(s)),r=[];return t.forEach(s=>{s instanceof Se?r.push(s):s instanceof ke&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:ke.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(){this.Sn=new Zv}addToCollectionParentIndex(e,t){return this.Sn.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(On.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(On.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}}class Zv{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new be(ve.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new be(ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I="IndexedDbIndexManager",Ed=new Uint8Array(0);class L5{constructor(e,t){this.databaseId=t,this.Dn=new Zv,this.Cn=new ps(r=>Co(r),(r,s)=>_h(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.Dn.add(t)});const i={collectionId:r,parent:Zt(s)};return WI(e).put(i)}return O.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Sx(t),""],!1,!0);return WI(e).H(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Ar(o.parent))}return r})}addFieldIndex(e,t){const r=Su(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=aa(e);return i.next(a=>{o.put(MI(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Su(e),s=aa(e),i=oa(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Su(e),r=oa(e),s=aa(e);return t.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,t){return O.forEach(this.vn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new zI(r).bn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=oa(e);let s=!0;const i=new Map;return O.forEach(this.vn(t),o=>this.Fn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=pe();const a=[];return O.forEach(i,(l,u)=>{B($I,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(N=>`${N.fieldPath}:${N.kind}`).join(",")}`}(l)} to execute ${Co(t)}`);const h=function(S,N){const P=F_(N);if(P===void 0)return null;for(const D of $f(S,P.fieldPath))switch(D.op){case"array-contains-any":return D.value.arrayValue.values||[];case"array-contains":return[D.value]}return null}(u,l),d=function(S,N){const P=new Map;for(const D of Xi(N))for(const I of $f(S,D.fieldPath))switch(I.op){case"==":case"in":P.set(D.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return P.set(D.fieldPath.canonicalString(),I.value),Array.from(P.values())}return null}(u,l),f=function(S,N){const P=[];let D=!0;for(const I of Xi(N)){const v=I.kind===0?EI(S,I.fieldPath,S.startAt):II(S,I.fieldPath,S.startAt);P.push(v.value),D&&(D=v.inclusive)}return new _i(P,D)}(u,l),m=function(S,N){const P=[];let D=!0;for(const I of Xi(N)){const v=I.kind===0?II(S,I.fieldPath,S.endAt):EI(S,I.fieldPath,S.endAt);P.push(v.value),D&&(D=v.inclusive)}return new _i(P,D)}(u,l),g=this.Mn(l,u,f),w=this.Mn(l,u,m),E=this.xn(l,u,d),y=this.On(l.indexId,h,g,f.inclusive,w,m.inclusive,E);return O.forEach(y,T=>r.Z(T,t.limit).next(S=>{S.forEach(N=>{const P=H.fromSegments(N.documentKey);o.has(P)||(o=o.add(P),a.push(P))})}))}).next(()=>a)}return O.resolve(null)})}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=O5(ke.create(e.filters,"and")).map(r=>H_(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t),t)}On(e,t,r,s,i,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,i.length),u=l/(t!=null?t.length:1),h=[];for(let d=0;d<l;++d){const f=t?this.Nn(t[d/u]):Ed,m=this.Bn(e,f,r[d%u],s),g=this.Ln(e,f,i[d%u],o),w=a.map(E=>this.Bn(e,f,E,!0));h.push(...this.createRange(m,g,w))}return h}Bn(e,t,r,s){const i=new no(e,H.empty(),t,r);return s?i:i.En()}Ln(e,t,r,s){const i=new no(e,H.empty(),t,r);return s?i.En():i}Fn(e,t){const r=new zI(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.gn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.vn(t);return O.forEach(s,i=>this.Fn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new be(Ge.comparator),h=!1;for(const d of l.filters)for(const f of d.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?h=!0:u=u.add(f.field));for(const d of l.orderBy)d.field.isKeyField()||(u=u.add(d.field));return u.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}kn(e,t){const r=new Iu;for(const s of Xi(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.ln(s.kind);to.Wt.Dt(i,o)}return r.un()}Nn(e){const t=new Iu;return to.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new Iu;return to.Wt.Dt(Ao(this.databaseId,t),r.ln(function(i){const o=Xi(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}xn(e,t,r){if(r===null)return[];let s=[];s.push(new Iu);let i=0;for(const o of Xi(e)){const a=r[i++];for(const l of s)if(this.qn(t,o.fieldPath)&&Lc(a))s=this.Un(s,o,a);else{const u=l.ln(o.kind);to.Wt.Dt(a,u)}}return this.$n(s)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new Iu;l.seed(a.un()),to.Wt.Dt(o,l.ln(t.kind)),i.push(l)}return i}qn(e,t){return!!e.filters.find(r=>r instanceof Se&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Su(e),s=aa(e);return(t?r.H(j_,IDBKeyRange.bound(t,t)):r.H()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,d){const f=d?new el(d.sequenceNumber,new On(Po(d.readTime),new H(Ar(d.documentKey)),d.largestBatchId)):el.empty(),m=h.fields.map(([g,w])=>new fo(Ge.fromServerFormat(g),w));return new Za(h.indexId,h.collectionGroup,m,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ce(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Su(e),i=aa(e);return this.Wn(e).next(o=>s.H(j_,IDBKeyRange.bound(t,t)).next(a=>O.forEach(a,l=>i.put(MI(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return O.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,l=>this.Qn(e,s,l).next(u=>{const h=this.Gn(i,l);return u.isEqual(h)?O.resolve():this.zn(e,i,l,u,h)}))))})}jn(e,t,r,s){return oa(e).put(s.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,s){return oa(e).delete(s.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const s=oa(e);let i=new be(Ps);return s.ee({index:Fx,range:IDBKeyRange.only([r.indexId,this.uid,tf(this.Kn(r,t))])},(o,a)=>{i=i.add(new no(r.indexId,t,BI(a.arrayValue),BI(a.directionalValue)))}).next(()=>i)}Gn(e,t){let r=new be(Ps);const s=this.kn(t,e);if(s==null)return r;const i=F_(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Lc(o))for(const a of o.arrayValue.values||[])r=r.add(new no(t.indexId,e.key,this.Nn(a),s))}else r=r.add(new no(t.indexId,e.key,Ed,s));return r}zn(e,t,r,s,i){B($I,"Updating index entries for document '%s'",t.key);const o=[];return function(l,u,h,d,f){const m=l.getIterator(),g=u.getIterator();let w=sa(m),E=sa(g);for(;w||E;){let y=!1,T=!1;if(w&&E){const S=h(w,E);S<0?T=!0:S>0&&(y=!0)}else w!=null?T=!0:y=!0;y?(d(E),E=sa(g)):T?(f(w),w=sa(m)):(w=sa(m),E=sa(g))}}(s,i,Ps,a=>{o.push(this.jn(e,t,r,a))},a=>{o.push(this.Hn(e,t,r,a))}),O.waitFor(o)}Wn(e){let t=1;return aa(e).ee({index:Lx,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Ps(o,a)).filter((o,a,l)=>!a||Ps(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Ps(o,e),l=Ps(o,t);if(a===0)s[0]=e.En();else if(a>0&&l<0)s.push(o),s.push(o.En());else if(l>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Jn(s[o],s[o+1]))return[];const a=s[o].An(this.uid,Ed,H.empty()),l=s[o+1].An(this.uid,Ed,H.empty());i.push(IDBKeyRange.bound(a,l))}return i}Jn(e,t){return Ps(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(GI)}getMinOffset(e,t){return O.mapArray(this.vn(t),r=>this.Fn(e,r).next(s=>s||X(44426))).next(GI)}}function WI(n){return Nt(n,Dc)}function oa(n){return Nt(n,Ju)}function Su(n){return Nt(n,Lv)}function aa(n){return Nt(n,Xu)}function GI(n){ne(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;Vv(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new On(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Hk=41943040;class Xt{static withCacheSize(e){return new Xt(e,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(n,e,t){const r=n.store(Jn),s=n.store(tl),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.ee({range:o},(h,d,f)=>(a++,f.delete()));i.push(l.next(()=>{ne(a===1,47070,{batchId:t.batchId})}));const u=[];for(const h of t.mutations){const d=Vx(e,h.key.path,t.batchId);i.push(s.delete(d)),u.push(h.key)}return O.waitFor(i).next(()=>u)}function Kf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw X(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xt.DEFAULT_COLLECTION_PERCENTILE=10,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xt.DEFAULT=new Xt(Hk,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xt.DISABLED=new Xt(-1,0,0);class nm{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static wt(e,t,r,s){ne(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new nm(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bs(e).ee({index:lo,range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=da(e),o=bs(e);return o.add({}).next(a=>{ne(typeof a=="number",49019);const l=new Hv(a,t,r,s),u=function(m,g,w){const E=w.baseMutations.map(T=>jc(m.yt,T)),y=w.mutations.map(T=>jc(m.yt,T));return{userId:g,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:E,mutations:y}}(this.serializer,this.userId,l),h=[];let d=new be((f,m)=>ce(f.canonicalString(),m.canonicalString()));for(const f of s){const m=Vx(this.userId,f.key.path,a);d=d.add(f.key.path.popLast()),h.push(o.put(u)),h.push(i.put(m,d4))}return d.forEach(f=>{h.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Zn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,t){return bs(e).get(t).next(r=>r?(ne(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),eo(this.serializer,r)):null)}Xn(e,t){return this.Zn[t]?O.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Zn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return bs(e).ee({index:lo,range:s},(o,a,l)=>{a.userId===this.userId&&(ne(a.batchId>=r,47524,{Yn:r}),i=eo(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=ui;return bs(e).ee({index:lo,range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ui],[this.userId,Number.POSITIVE_INFINITY]);return bs(e).H(lo,t).next(r=>r.map(s=>eo(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Kd(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return da(e).ee({range:s},(o,a,l)=>{const[u,h,d]=o,f=Ar(h);if(u===this.userId&&t.path.isEqual(f))return bs(e).get(d).next(m=>{if(!m)throw X(61480,{er:o,batchId:d});ne(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:d}),i.push(eo(this.serializer,m))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new be(ce);const s=[];return t.forEach(i=>{const o=Kd(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=da(e).ee({range:a},(u,h,d)=>{const[f,m,g]=u,w=Ar(m);f===this.userId&&i.path.isEqual(w)?r=r.add(g):d.done()});s.push(l)}),O.waitFor(s).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Kd(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new be(ce);return da(e).ee({range:o},(l,u,h)=>{const[d,f,m]=l,g=Ar(f);d===this.userId&&r.isPrefixOf(g)?g.length===s&&(a=a.add(m)):h.done()}).next(()=>this.tr(e,a))}tr(e,t){const r=[],s=[];return t.forEach(i=>{s.push(bs(e).get(i).next(o=>{if(o===null)throw X(35274,{batchId:i});ne(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(eo(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return Kk(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.nr(t.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return da(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Ar(i[1]);s.push(l)}else a.done()}).next(()=>{ne(s.length===0,56720,{rr:s.map(i=>i.canonicalString())})})})}containsKey(e,t){return Qk(e,this.userId,t)}ir(e){return Yk(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:ui,lastStreamToken:""})}}function Qk(n,e,t){const r=Kd(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return da(n).ee({range:i,Y:!0},(a,l,u)=>{const[h,d,f]=a;h===e&&d===s&&(o=!0),u.done()}).next(()=>o)}function bs(n){return Nt(n,Jn)}function da(n){return Nt(n,tl)}function Yk(n){return Nt(n,bc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new bo(0)}static ar(){return new bo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next(t=>{const r=new bo(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(t=>ie.fromTimestamp(new xe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.ur(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.cr(e,s)))}addTargetData(e,t){return this.lr(e,t).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>la(e).delete(t.targetId)).next(()=>this.ur(e)).next(r=>(ne(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return la(e).ee((o,a)=>{const l=Lu(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,t){return la(e).ee((r,s)=>{const i=Lu(s);t(i)})}ur(e){return KI(e).get(zf).next(t=>(ne(t!==null,2888),t))}cr(e,t){return KI(e).put(zf,t)}lr(e,t){return la(e).put($k(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Co(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return la(e).ee({range:s,index:Mx},(o,a,l)=>{const u=Lu(a);_h(t,u.target)&&(i=u,l.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=$s(e);return t.forEach(o=>{const a=Zt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,t,r){const s=$s(e);return O.forEach(t,i=>{const o=Zt(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=$s(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=$s(e);let i=pe();return s.ee({range:r,Y:!0},(o,a,l)=>{const u=Ar(o[1]),h=new H(u);i=i.add(h)}).next(()=>i)}containsKey(e,t){const r=Zt(t.path),s=IDBKeyRange.bound([r],[Sx(r)],!1,!0);let i=0;return $s(e).ee({index:Mv,Y:!0,range:s},([o,a],l,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}At(e,t){return la(e).get(t).next(r=>r?Lu(r):null)}}function la(n){return Nt(n,nl)}function KI(n){return Nt(n,po)}function $s(n){return Nt(n,rl)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="LruGarbageCollector",Xk=1048576;function YI([n,e],[t,r]){const s=ce(n,t);return s===0?ce(e,r):s}class U5{constructor(e){this.Pr=e,this.buffer=new be(YI),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();YI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Jk{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){B(QI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Di(t)?B(QI,"Ignoring IndexedDB error during garbage collection: ",t):await Ni(t)}await this.Ar(3e5)})}}class j5{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return O.resolve(gn.ce);const r=new U5(t);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.mr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(HI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HI):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,s,i,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(e,s))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,t))).next(d=>(i=d,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),ua()<=Ie.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:d})))}}function Zk(n,e){return new j5(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(e,t){this.db=e,this.garbageCollector=Zk(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}pr(e){let t=0;return this.mr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,(r,s)=>t(s))}addReference(e,t,r){return Id(e,r)}removeReference(e,t,r){return Id(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Id(e,t)}wr(e,t){return function(s,i){let o=!1;return Yk(s).te(a=>Qk(s,a,i).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.yr(e,(o,a)=>{if(a<=t){const l=this.wr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ie.min()),$s(e).delete(function(d){return[0,Zt(d.path)]}(o))))});s.push(l)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Id(e,t)}yr(e,t){const r=$s(e);let s,i=gn.ce;return r.ee({index:Mv},([o,a],{path:l,sequenceNumber:u})=>{o===0?(i!==gn.ce&&t(new H(Ar(s)),i),i=u,s=l):i=gn.ce}).next(()=>{i!==gn.ce&&t(new H(Ar(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Id(n,e){return $s(n).put(function(r,s){return{targetId:0,path:Zt(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.changes=new ps(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,We.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Hi(e).put(r)}removeEntry(e,t,r){return Hi(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Gf(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=We.newInvalidDocument(t);return Hi(e).ee({index:Qd,range:IDBKeyRange.only(Au(t))},(s,i)=>{r=this.Sr(t,i)}).next(()=>r)}Dr(e,t){let r={size:0,document:We.newInvalidDocument(t)};return Hi(e).ee({index:Qd,range:IDBKeyRange.only(Au(t))},(s,i)=>{r={document:this.Sr(t,i),size:Kf(i)}}).next(()=>r)}getEntries(e,t){let r=yn();return this.Cr(e,t,(s,i)=>{const o=this.Sr(s,i);r=r.insert(s,o)}).next(()=>r)}vr(e,t){let r=yn(),s=new je(H.comparator);return this.Cr(e,t,(i,o)=>{const a=this.Sr(i,o);r=r.insert(i,a),s=s.insert(i,Kf(o))}).next(()=>({documents:r,Fr:s}))}Cr(e,t,r){if(t.isEmpty())return O.resolve();let s=new be(ZI);t.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Au(s.first()),Au(s.last())),o=s.getIterator();let a=o.getNext();return Hi(e).ee({index:Qd,range:i},(l,u,h)=>{const d=H.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&ZI(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?h.j(Au(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Gf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hi(e).H(IDBKeyRange.bound(a,l,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let h=yn();for(const d of u){const f=this.Sr(H.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);f.isFoundDocument()&&(vh(t,f)||s.has(f.key))&&(h=h.insert(f.key,f))}return h})}getAllFromCollectionGroup(e,t,r,s){let i=yn();const o=JI(t,r),a=JI(t,On.max());return Hi(e).ee({index:Ox,range:IDBKeyRange.bound(o,a,!0)},(l,u,h)=>{const d=this.Sr(H.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(d.key,d),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new q5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return XI(e).get(U_).next(t=>(ne(!!t,20021),t))}br(e,t){return XI(e).put(U_,t)}Sr(e,t){if(t){const r=k5(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ie.min())))return r}return We.newInvalidDocument(e)}}function tR(n){return new z5(n)}class q5 extends eR{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new ps(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new be((i,o)=>ce(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Or.get(i);if(t.push(this.Mr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=VI(this.Mr.serializer,o);s=s.add(i.path.popLast());const u=Kf(l);r+=u-a.size,t.push(this.Mr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=VI(this.Mr.serializer,o.convertToNoDocument(ie.min()));t.push(this.Mr.addEntry(e,i,l))}}),s.forEach(i=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Mr.updateMetadata(e,r)),O.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next(r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Mr.vr(e,t).next(({documents:r,Fr:s})=>(s.forEach((i,o)=>{this.Or.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function XI(n){return Nt(n,Nc)}function Hi(n){return Nt(n,Bf)}function Au(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function JI(n,e){const t=e.documentKey.path.toArray();return[n,Gf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ZI(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=ce(t[i],r[i]),s)return s;return s=ce(t.length,r.length),s||(s=ce(t[t.length-2],r[r.length-2]),s||ce(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&tc(r.mutation,s,_n.empty(),xe.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=pe()){const s=Cr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Ou();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Cr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pe()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=yn();const o=ec(),a=function(){return ec()}();return t.forEach((l,u)=>{const h=r.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof ms)?i=i.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),tc(h.mutation,u,h.mutation.getFieldMask(),xe.now())):o.set(u.key,_n.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,h)=>o.set(u,h)),t.forEach((u,h)=>a.set(u,new $5(h,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,t){const r=ec();let s=new je((o,a)=>o-a),i=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let h=r.get(l)||_n.empty();h=a.applyToLocalView(u,h),r.set(l,h);const d=(s.get(a.batchId)||pe()).add(l);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,d=gk();h.forEach(f=>{if(!i.has(f)){const m=Ik(t.get(f),r.get(f));m!==null&&d.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return Y4(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):qv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):O.resolve(Cr());let a=Ja,l=i;return o.next(u=>O.forEach(u,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,pe())).next(h=>({batchId:a,changes:mk(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new H(t)).next(r=>{let s=Ou();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Ou();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,l=>{const u=function(d,f){return new fs(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,We.newInvalidDocument(h)))});let a=Ou();return o.forEach((l,u)=>{const h=i.get(l);h!==void 0&&tc(h.mutation,u,_n.empty(),xe.now()),vh(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return O.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:vt(s.createTime)}}(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,function(s){return{name:s.name,query:em(s.bundledQuery),readTime:vt(s.readTime)}}(t)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(){this.overlays=new je(H.comparator),this.Lr=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Cr();return O.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.bt(e,t,i)}),O.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Lr.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){const s=Cr(),i=t.length+1,o=new H(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new je((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let h=i.get(u.largestBatchId);h===null&&(h=Cr(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=Cr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=s)););return O.resolve(a)}bt(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Qv(t,r));let i=this.Lr.get(t);i===void 0&&(i=pe(),this.Lr.set(t,i)),this.Lr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(){this.kr=new be(Vt.Kr),this.qr=new be(Vt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new Vt(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Vt(e,t))}Qr(e,t){e.forEach(r=>this.removeReference(r,t))}Gr(e){const t=new H(new ve([])),r=new Vt(t,e),s=new Vt(t,e+1),i=[];return this.qr.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new H(new ve([])),r=new Vt(t,e),s=new Vt(t,e+1);let i=pe();return this.qr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Vt(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Vt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return H.comparator(e.key,t.key)||ce(e.Hr,t.Hr)}static Ur(e,t){return ce(e.Hr,t.Hr)||H.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K5{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new be(Vt.Kr)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Hv(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.Jr=this.Jr.add(new Vt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,t){return O.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.Xr(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?ui:this.Yn-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Vt(t,0),s=new Vt(t,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new be(ce);return t.forEach(s=>{const i=new Vt(s,0),o=new Vt(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),O.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;H.isDocumentKey(i)||(i=i.child(""));const o=new Vt(new H(i),0);let a=new be(ce);return this.Jr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(l.Hr)),!0)},o),O.resolve(this.Yr(a))}Yr(e){const t=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ne(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return O.forEach(t.mutations,s=>{const i=new Vt(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){const r=new Vt(t,0),s=this.Jr.firstAfterOrEqual(r);return O.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e){this.ti=e,this.docs=function(){return new je(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():We.newInvalidDocument(t))}getEntries(e,t){let r=yn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():We.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=yn();const o=t.path,a=new H(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Vv(Rx(h),r)<=0||(s.has(h.key)||vh(t,h))&&(i=i.insert(h.key,h.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,t,r,s){X(9500)}ni(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Y5(this)}getSize(e){return O.resolve(this.size)}}class Y5 extends eR{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(e){this.persistence=e,this.ri=new ps(t=>Co(t),_h),this.lastRemoteSnapshotVersion=ie.min(),this.highestTargetId=0,this.ii=0,this.si=new ew,this.targetCount=0,this.oi=bo._r()}forEachTarget(e,t){return this.ri.forEach((r,s)=>t(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),O.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new bo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.lr(t),O.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),O.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,t){this._i={},this.overlays={},this.ai=new gn(0),this.ui=!1,this.ui=!0,this.ci=new H5,this.referenceDelegate=e(this),this.li=new X5(this),this.indexManager=new M5,this.remoteDocumentCache=function(s){return new Q5(s)}(r=>this.referenceDelegate.hi(r)),this.serializer=new qk(t),this.Pi=new W5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new G5,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new K5(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){B("MemoryPersistence","Starting transaction:",e);const s=new J5(this.ai.next());return this.referenceDelegate.Ti(),r(s).next(i=>this.referenceDelegate.Ii(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,t){return O.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}}class J5 extends bx{constructor(e){super(),this.currentSequenceNumber=e}}class rm{constructor(e){this.persistence=e,this.Ri=new ew,this.Ai=null}static Vi(e){return new rm(e)}get di(){if(this.Ai)return this.Ai;throw X(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),O.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.di,r=>{const s=H.fromPath(r);return this.mi(e,s).next(i=>{i||t.removeEntry(s,ie.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return O.or([()=>O.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Qf{constructor(e,t){this.persistence=e,this.fi=new ps(r=>Zt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=Zk(this,t)}static Vi(e,t){return new Qf(e,t)}Ti(){}Ii(e){return O.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}pr(e){let t=0;return this.mr(e,r=>{t++}).next(()=>t)}mr(e,t){return O.forEach(this.fi,(r,s)=>this.wr(e,r,s).next(i=>i?O.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,o=>this.wr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,ie.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),O.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),O.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Xd(e.data.value)),t}wr(e,t,r){return O.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.fi.get(t);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(e){this.serializer=e}k(e,t,r,s){const i=new qp("createOrUpgrade",t);r<1&&s>=1&&(function(l){l.createObjectStore(gh)}(e),function(l){l.createObjectStore(bc,{keyPath:h4}),l.createObjectStore(Jn,{keyPath:cI,autoIncrement:!0}).createIndex(lo,hI,{unique:!0}),l.createObjectStore(tl)}(e),eS(e),function(l){l.createObjectStore(Ji)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(rl),l.deleteObjectStore(nl),l.deleteObjectStore(po)}(e),eS(e)),o=o.next(()=>function(l){const u=l.store(po),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ie.min().toTimestamp(),targetCount:0};return u.put(zf,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(Jn).H().next(d=>{l.deleteObjectStore(Jn),l.createObjectStore(Jn,{keyPath:cI,autoIncrement:!0}).createIndex(lo,hI,{unique:!0});const f=u.store(Jn),m=d.map(g=>f.put(g));return O.waitFor(m)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(sl,{keyPath:w4})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.gi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Nc)}(e),this.pi(i)))),r<7&&s>=7&&(o=o.next(()=>this.yi(i))),r<8&&s>=8&&(o=o.next(()=>this.wi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.bi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore($p,{keyPath:T4})})(e),function(l){l.createObjectStore(Wp,{keyPath:E4})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(Gp,{keyPath:R4});u.createIndex(B_,P4,{unique:!1}),u.createIndex(Ux,b4,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(Bf,{keyPath:f4});u.createIndex(Qd,p4),u.createIndex(Ox,m4)}(e)).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(Ji))),r<14&&s>=14&&(o=o.next(()=>this.Di(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(Lv,{keyPath:I4,autoIncrement:!0}).createIndex(j_,S4,{unique:!1}),l.createObjectStore(Xu,{keyPath:A4}).createIndex(Lx,C4,{unique:!1}),l.createObjectStore(Ju,{keyPath:x4}).createIndex(Fx,k4,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore(Xu).clear()}).next(()=>{t.objectStore(Ju).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Fv,{keyPath:N4})})(e)})),r<18&&s>=18&&kC()&&(o=o.next(()=>{t.objectStore(Xu).clear()}).next(()=>{t.objectStore(Ju).clear()})),o}pi(e){let t=0;return e.store(Ji).ee((r,s)=>{t+=Kf(s)}).next(()=>{const r={byteSize:t};return e.store(Nc).put(U_,r)})}gi(e){const t=e.store(bc),r=e.store(Jn);return t.H().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,ui],[i.userId,i.lastAcknowledgedBatchId]);return r.H(lo,o).next(a=>O.forEach(a,l=>{ne(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=eo(this.serializer,l);return Kk(e,i.userId,u).next(()=>{})}))}))}yi(e){const t=e.store(rl),r=e.store(Ji);return e.store(po).get(zf).next(s=>{const i=[];return r.ee((o,a)=>{const l=new ve(o),u=function(d){return[0,Zt(d)]}(l);i.push(t.get(u).next(h=>h?O.resolve():(d=>t.put({targetId:0,path:Zt(d),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(i))})}wi(e,t){e.createObjectStore(Dc,{keyPath:v4});const r=t.store(Dc),s=new Zv,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Zt(l)})}};return t.store(Ji).ee({Y:!0},(o,a)=>{const l=new ve(o);return i(l.popLast())}).next(()=>t.store(tl).ee({Y:!0},([o,a,l],u)=>{const h=Ar(a);return i(h.popLast())}))}bi(e){const t=e.store(nl);return t.ee((r,s)=>{const i=Lu(s),o=$k(this.serializer,i);return t.put(o)})}Si(e,t){const r=t.store(Ji),s=[];return r.ee((i,o)=>{const a=t.store(Bf),l=function(d){return d.document?new H(ve.fromString(d.document.name).popFirst(5)):d.noDocument?H.fromSegments(d.noDocument.path):d.unknownDocument?H.fromSegments(d.unknownDocument.path):X(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(u))}).next(()=>O.waitFor(s))}Di(e,t){const r=t.store(Jn),s=tR(this.serializer),i=new tw(rm.Vi,this.serializer.yt);return r.H().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??pe();eo(this.serializer,l).keys().forEach(h=>u=u.add(h)),a.set(l.userId,u)}),O.forEach(a,(l,u)=>{const h=new Mt(u),d=tm.wt(this.serializer,h),f=i.getIndexManager(h),m=nm.wt(h,this.serializer,f,i.referenceDelegate);return new nR(s,m,d,f).recalculateAndSaveOverlaysForDocumentKeys(new z_(t,gn.ce),l).next()})})}}function eS(n){n.createObjectStore(rl,{keyPath:_4}).createIndex(Mv,y4,{unique:!0}),n.createObjectStore(nl,{keyPath:"targetId"}).createIndex(Mx,g4,{unique:!0}),n.createObjectStore(po)}const Ns="IndexedDbPersistence",Eg=18e5,Ig=5e3,Sg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rR="main";class nw{constructor(e,t,r,s,i,o,a,l,u,h,d=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=i,this.window=o,this.document=a,this.Fi=u,this.Mi=h,this.xi=d,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=f=>Promise.resolve(),!nw.v())throw new U(L.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new B5(this,s),this.Ki=t+rR,this.serializer=new qk(l),this.qi=new Pr(this.Ki,this.xi,new Z5(this.serializer)),this.ci=new P5,this.li=new F5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=tR(this.serializer),this.Pi=new R5,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,h===!1&&_t(Ns,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new U(L.FAILED_PRECONDITION,Sg);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new gn(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Sd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Ji(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(Di(e))return B(Ns,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return B(Ns,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return Cu(e).get(ra).next(t=>O.resolve(this.Xi(t)))}Yi(e){return Sd(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Eg)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Nt(t,sl);return r.H().next(s=>{const i=this.ns(s,Eg),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?O.resolve(!0):Cu(e).get(ra).next(t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ig)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new U(L.FAILED_PRECONDITION,Sg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Sd(e).H().next(r=>this.ns(r,Ig).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&B(Ns,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[gh,sl],e=>{const t=new z_(e,gn.ce);return this.Ji(t).next(()=>this.Yi(t))}),this.qi.close(),this.ls()}ns(e,t){return e.filter(r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>Sd(e).H().next(t=>this.ns(t,Eg).map(r=>r.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return nm.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new L5(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return tm.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){B(Ns,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(l){return l===18?O4:l===17?qx:l===16?V4:l===15?Uv:l===14?zx:l===13?Bx:l===12?D4:l===11?jx:void X(60245)}(this.xi);let o;return this.qi.runTransaction(e,s,i,a=>(o=new z_(a,this.ai?this.ai.next():gn.ce),t==="readwrite-primary"?this.ji(o).next(l=>!!l||this.Hi(o)).next(l=>{if(!l)throw _t(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new U(L.FAILED_PRECONDITION,Px);return r(o)}).next(l=>this.Zi(o).next(()=>l)):this.Ps(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ps(e){return Cu(e).get(ra).next(t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ig)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new U(L.FAILED_PRECONDITION,Sg)})}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Cu(e).put(ra,t)}static v(){return Pr.v()}Ji(e){const t=Cu(e);return t.get(ra).next(r=>this.Xi(r)?(B(Ns,"Releasing primary lease."),t.delete(ra)):O.resolve())}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(_t(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;xC()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const r=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return B(Ns,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return _t(Ns,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){_t("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Cu(n){return Nt(n,gh)}function Sd(n){return Nt(n,sl)}function rw(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=s}static Es(e,t){let r=pe(),s=pe();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new sw(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return xC()?8:Nx(xt())>0?6:4}()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.gs(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ps(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new eU;return this.ys(e,t,o).next(a=>{if(i.result=a,this.As)return this.ws(e,t,o,a.size)})}).next(()=>i.result)}ws(e,t,r,s){return r.documentReadCount<this.Vs?(ua()<=Ie.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",ca(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),O.resolve()):(ua()<=Ie.DEBUG&&B("QueryEngine","Query:",ca(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(ua()<=Ie.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",ca(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,en(t))):O.resolve())}gs(e,t){if(SI(t))return O.resolve(null);let r=en(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Wf(t,null,"F"),r=en(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=pe(...i);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.bs(t,a);return this.Ss(t,u,o,l.readTime)?this.gs(e,Wf(t,null,"F")):this.Ds(e,u,t,l)}))})))}ps(e,t,r,s){return SI(t)||s.isEqual(ie.min())?O.resolve(null):this.fs.getDocuments(e,r).next(i=>{const o=this.bs(t,i);return this.Ss(t,o,r,s)?O.resolve(null):(ua()<=Ie.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ca(t)),this.Ds(e,o,t,kx(s,Ja)).next(a=>a))})}bs(e,t){let r=new be(fk(e));return t.forEach((s,i)=>{vh(e,i)&&(r=r.add(i))}),r}Ss(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,t,r){return ua()<=Ie.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",ca(t)),this.fs.getDocumentsMatchingQuery(e,t,On.min(),r)}Ds(e,t,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iw="LocalStore",tU=3e8;class nU{constructor(e,t,r,s){this.persistence=e,this.Cs=t,this.serializer=s,this.vs=new je(ce),this.Fs=new ps(i=>Co(i),_h),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nR(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}}function iR(n,e,t,r){return new nU(n,e,t,r)}async function oR(n,e){const t=K(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.Os(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=pe();for(const u of s){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of i){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(u=>({Ns:u,removedBatchIds:o,addedBatchIds:a}))})})}function rU(n,e){const t=K(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.xs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,h){const d=u.batch,f=d.keys();let m=O.resolve();return f.forEach(g=>{m=m.next(()=>h.getEntry(l,g)).next(w=>{const E=u.docVersions.get(g);ne(E!==null,48541),w.version.compareTo(E)<0&&(d.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),h.addEntry(w)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=pe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function aR(n){const e=K(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function sU(n,e){const t=K(n),r=e.snapshotVersion;let s=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.xs.newChangeBuffer({trackRemovals:!0});s=t.vs;const a=[];e.targetChanges.forEach((h,d)=>{const f=s.get(d);if(!f)return;a.push(t.li.removeMatchingKeys(i,h.removedDocuments,d).next(()=>t.li.addMatchingKeys(i,h.addedDocuments,d)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?m=m.withResumeToken(at.EMPTY_BYTE_STRING,ie.min()).withLastLimboFreeSnapshotVersion(ie.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,r)),s=s.insert(d,m),function(w,E,y){return w.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=tU?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(f,m,h)&&a.push(t.li.updateTargetData(i,m))});let l=yn(),u=pe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(lR(i,o,e.documentUpdates).next(h=>{l=h.Bs,u=h.Ls})),!r.isEqual(ie.min())){const h=t.li.getLastRemoteSnapshotVersion(i).next(d=>t.li.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(t.vs=s,i))}function lR(n,e,t){let r=pe(),s=pe();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=yn();return t.forEach((a,l)=>{const u=i.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ie.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):B(iw,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Bs:o,Ls:s}})}function iU(n,e){const t=K(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ui),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hl(n,e){const t=K(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.li.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):t.li.allocateTargetId(r).next(o=>(s=new Hr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r})}async function dl(n,e,t){const r=K(n),s=r.vs.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Di(o))throw o;B(iw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function Yf(n,e,t){const r=K(n);let s=ie.min(),i=pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){const d=K(l),f=d.Fs.get(h);return f!==void 0?O.resolve(d.vs.get(f)):d.li.getTargetData(u,h)}(r,o,en(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?s:ie.min(),t?i:pe())).next(a=>(hR(r,dk(e),a),{documents:a,ks:i})))}function uR(n,e){const t=K(n),r=K(t.li),s=t.vs.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function cR(n,e){const t=K(n),r=t.Ms.get(e)||ie.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.xs.getAllFromCollectionGroup(s,e,kx(r,Ja),Number.MAX_SAFE_INTEGER)).then(s=>(hR(t,e,s),s))}function hR(n,e,t){let r=n.Ms.get(e)||ie.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ms.set(e,r)}async function oU(n,e,t,r){const s=K(n);let i=pe(),o=yn();for(const u of t){const h=e.Ks(u.metadata.name);u.document&&(i=i.add(h));const d=e.qs(u);d.setReadTime(e.Us(u.metadata.readTime)),o=o.insert(h,d)}const a=s.xs.newChangeBuffer({trackRemovals:!0}),l=await hl(s,function(h){return en(Ol(ve.fromString(`__bundle__/docs/${h}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>lR(u,a,o).next(h=>(a.apply(u),h)).next(h=>s.li.removeMatchingKeysForTargetId(u,l.targetId).next(()=>s.li.addMatchingKeys(u,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,h.Bs,h.Ls)).next(()=>h.Bs)))}async function aU(n,e,t=pe()){const r=await hl(n,en(em(e.bundledQuery))),s=K(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=vt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Pi.saveNamedQuery(i,e);const a=r.withResumeToken(at.EMPTY_BYTE_STRING,o);return s.vs=s.vs.insert(a.targetId,a),s.li.updateTargetData(i,a).next(()=>s.li.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.li.addMatchingKeys(i,t,r.targetId)).next(()=>s.Pi.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR="firestore_clients";function tS(n,e){return`${dR}_${n}_${e}`}const fR="firestore_mutations";function nS(n,e,t){let r=`${fR}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const pR="firestore_targets";function Ag(n,e){return`${pR}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir="SharedClientState";class Xf{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static $s(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new U(s.error.code,s.error.message))),o?new Xf(e,t,s.state,i):(_t(Ir,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class rc{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new U(r.error.code,r.error.message))),i?new rc(e,r.state,s):(_t(Ir,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Jf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=$v();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=Dx(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Jf(e,i):(_t(Ir,`Failed to parse client data for instance '${e}': ${t}`),null)}}class ow{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new ow(t.clientId,t.onlineState):(_t(Ir,`Failed to parse online state: ${e}`),null)}}class ny{constructor(){this.activeTargetIds=$v()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Cg{constructor(e,t,r,s,i){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new je(ce),this.started=!1,this.Zs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=tS(this.persistenceKey,this.zs),this.Ys=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Js=this.Js.insert(this.zs,new ny),this.eo=new RegExp(`^${dR}_${o}_([^_]*)$`),this.no=new RegExp(`^${fR}_${o}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${pR}_${o}_(\\d+)$`),this.io=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.so=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const s=this.getItem(tS(this.persistenceKey,r));if(s){const i=Jf.$s(r,s);i&&(this.Js=this.Js.insert(i.clientId,i))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Ag(this.persistenceKey,e));if(s){const i=rc.$s(e,s);i&&(r=i.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ag(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.lo(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return B(Ir,"READ",e,t),t}setItem(e,t){B(Ir,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){B(Ir,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(B(Ir,"EVENT",t.key,t.newValue),t.key===this.Xs)return void _t("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=function(i){let o=gn.ce;if(i!=null)try{const a=JSON.parse(i);ne(typeof a=="number",30636,{yo:i}),o=a}catch(a){_t(Ir,"Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==gn.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map(s=>this.syncEngine.bo(s)))}}}else this.Zs.push(t)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const s=new Xf(this.currentUser,e,t,r),i=nS(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Ws())}lo(e){const t=nS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const s=Ag(this.persistenceKey,e),i=new rc(e,t,r);this.setItem(s,i.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return Jf.$s(r,t)}Vo(e,t){const r=this.no.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Xf.$s(new Mt(i),s,t)}fo(e,t){const r=this.ro.exec(e),s=Number(r[1]);return rc.$s(s,t)}_o(e){return ow.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);B(Ir,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),s=this.uo(this.Js),i=this.uo(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.Co(o,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=$v();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class mR{constructor(){this.vo=new ny,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new ny,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS="ConnectivityMonitor";class sS{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){B(rS,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){B(rS,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ad=null;function ry(){return Ad===null?Ad=function(){return 268435456+Math.round(2147483648*Math.random())}():Ad++,"0x"+Ad.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg="RestConnection",uU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class cU{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===Oc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,t,r,s,i){const o=ry(),a=this.Qo(e,t.toUriEncodedString());B(xg,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,s,i);const{host:u}=new URL(a),h=Bo(u);return this.zo(e,a,l,r,h).then(d=>(B(xg,`Received RPC '${e}' ${o}: `,d),d),d=>{throw An(xg,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",r),d})}jo(e,t,r,s,i,o){return this.Wo(e,t,r,s,i)}Go(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Qo(e,t){const r=uU[e];let s=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection",xu=(n,e,t)=>{n.listen(e,r=>{try{t(r)}catch(s){setTimeout(()=>{throw s},0)}})};class Ua extends cU{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Ua.c_){const e=vx();xu(e,yx.STAT_EVENT,t=>{t.stat===V_.PROXY?B(Yt,"STAT_EVENT: detected buffering proxy"):t.stat===V_.NOPROXY&&B(Yt,"STAT_EVENT: detected no buffering proxy")}),Ua.c_=!0}}zo(e,t,r,s,i){const o=ry();return new Promise((a,l)=>{const u=new gx;u.setWithCredentials(!0),u.listenOnce(_x.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Hd.NO_ERROR:const d=u.getResponseJson();B(Yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case Hd.TIMEOUT:B(Yt,`RPC '${e}' ${o} timed out`),l(new U(L.DEADLINE_EXCEEDED,"Request time out"));break;case Hd.HTTP_ERROR:const f=u.getStatus();if(B(Yt,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const w=function(y){const T=y.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(T)>=0?T:L.UNKNOWN}(g.status);l(new U(w,g.message))}else l(new U(L.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new U(L.UNAVAILABLE,"Connection failed."));break;default:X(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{B(Yt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);B(Yt,`RPC '${e}' ${o} sending request:`,s),u.send(t,"POST",h,r,15)})}T_(e,t,r){const s=ry(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;const u=i.join("");B(Yt,`Creating RPC '${e}' stream ${s}: ${u}`,a);const h=o.createWebChannel(u,a);this.I_(h);let d=!1,f=!1;const m=new hU({Ho:g=>{f?B(Yt,`Not sending because RPC '${e}' stream ${s} is closed:`,g):(d||(B(Yt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),B(Yt,`RPC '${e}' stream ${s} sending:`,g),h.send(g))},Jo:()=>h.close()});return xu(h,Vu.EventType.OPEN,()=>{f||(B(Yt,`RPC '${e}' stream ${s} transport opened.`),m.i_())}),xu(h,Vu.EventType.CLOSE,()=>{f||(f=!0,B(Yt,`RPC '${e}' stream ${s} transport closed`),m.o_(),this.E_(h))}),xu(h,Vu.EventType.ERROR,g=>{f||(f=!0,An(Yt,`RPC '${e}' stream ${s} transport errored. Name:`,g.name,"Message:",g.message),m.o_(new U(L.UNAVAILABLE,"The operation could not be completed")))}),xu(h,Vu.EventType.MESSAGE,g=>{var w;if(!f){const E=g.data[0];ne(!!E,16349);const y=E,T=(y==null?void 0:y.error)||((w=y[0])==null?void 0:w.error);if(T){B(Yt,`RPC '${e}' stream ${s} received error:`,T);const S=T.status;let N=function(I){const v=Tt[I];if(v!==void 0)return xk(v)}(S),P=T.message;S==="NOT_FOUND"&&P.includes("database")&&P.includes("does not exist")&&P.includes(this.databaseId.database)&&An(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),N===void 0&&(N=L.INTERNAL,P="Unknown error status: "+S+" with message "+T.message),f=!0,m.o_(new U(N,P)),h.close()}else B(Yt,`RPC '${e}' stream ${s} received:`,E),m.__(E)}}),Ua.u_(),setTimeout(()=>{m.s_()},0),m}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return wx()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dU(n){return new Ua(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(){return typeof window<"u"?window:null}function nf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(n){return new y5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ua.c_=!1;class aw{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&B("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS="PersistentStream";class _R{constructor(e,t,r,s,i,o,a,l){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new aw(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===L.RESOURCE_EXHAUSTED?(_t(t.toString()),_t("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===L.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===t&&this.G_(r,s)},r=>{e(()=>{const s=new U(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.H_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return B(iS,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(B(iS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class fU extends _R{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=T5(this.serializer,e),r=function(i){if(!("targetChange"in i))return ie.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ie.min():o.readTime?vt(o.readTime):ie.min()}(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=X_(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=qf(l)?{documents:Mk(i,l)}:{query:Zp(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=bk(i,o.resumeToken);const u=Q_(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ie.min())>0){a.readTime=cl(i,o.snapshotVersion.toTimestamp());const u=Q_(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=I5(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=X_(this.serializer),t.removeTarget=e,this.K_(t)}}class pU extends _R{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=E5(e.writeResults,e.commitTime),r=vt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=X_(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>jc(this.serializer,r))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{}class gU extends mU{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new U(L.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,Y_(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new U(L.UNKNOWN,i.toString())})}jo(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,Y_(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new U(L.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function _U(n,e,t,r){return new gU(n,e,t,r)}class yU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(_t(t),this.aa=!1):B("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="RemoteStore";class vU{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Oi(this)&&(B(No,"Restarting streams for network reachability change."),await async function(l){const u=K(l);u.Ea.add(4),await Fl(u),u.Va.set("Unknown"),u.Ea.delete(4),await Ih(u)}(this))})}),this.Va=new yU(r,s)}}async function Ih(n){if(Oi(n))for(const e of n.Ra)await e(!0)}async function Fl(n){for(const e of n.Ra)await e(!1)}function sm(n,e){const t=K(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),cw(t)?uw(t):jl(t).O_()&&lw(t,e))}function fl(n,e){const t=K(n),r=jl(t);t.Ia.delete(e),r.O_()&&yR(t,e),t.Ia.size===0&&(r.O_()?r.L_():Oi(t)&&t.Va.set("Unknown"))}function lw(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jl(n).Z_(e)}function yR(n,e){n.da.$e(e),jl(n).X_(e)}function uw(n){n.da=new p5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),jl(n).start(),n.Va.ua()}function cw(n){return Oi(n)&&!jl(n).x_()&&n.Ia.size>0}function Oi(n){return K(n).Ea.size===0}function vR(n){n.da=void 0}async function wU(n){n.Va.set("Online")}async function TU(n){n.Ia.forEach((e,t)=>{lw(n,e)})}async function EU(n,e){vR(n),cw(n)?(n.Va.ha(e),uw(n)):n.Va.set("Unknown")}async function IU(n,e,t){if(n.Va.set("Online"),e instanceof Pk&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.da.removeTarget(a))}(n,e)}catch(r){B(No,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Zf(n,r)}else if(e instanceof ef?n.da.Xe(e):e instanceof Rk?n.da.st(e):n.da.tt(e),!t.isEqual(ie.min()))try{const r=await aR(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.da.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(u);h&&i.Ia.set(u,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(at.EMPTY_BYTE_STRING,h.snapshotVersion)),yR(i,l);const d=new Hr(h.target,l,u,h.sequenceNumber);lw(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){B(No,"Failed to raise snapshot:",r),await Zf(n,r)}}async function Zf(n,e,t){if(!Di(e))throw e;n.Ea.add(1),await Fl(n),n.Va.set("Offline"),t||(t=()=>aR(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{B(No,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Ih(n)})}function wR(n,e){return e().catch(t=>Zf(n,t,e))}async function Ul(n){const e=K(n),t=yi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ui;for(;SU(e);)try{const s=await iU(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,AU(e,s)}catch(s){await Zf(e,s)}TR(e)&&ER(e)}function SU(n){return Oi(n)&&n.Ta.length<10}function AU(n,e){n.Ta.push(e);const t=yi(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function TR(n){return Oi(n)&&!yi(n).x_()&&n.Ta.length>0}function ER(n){yi(n).start()}async function CU(n){yi(n).ra()}async function xU(n){const e=yi(n);for(const t of n.Ta)e.ea(t.mutations)}async function kU(n,e,t){const r=n.Ta.shift(),s=Kv.from(r,e,t);await wR(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Ul(n)}async function RU(n,e){e&&yi(n).Y_&&await async function(r,s){if(function(o){return Ck(o)&&o!==L.ABORTED}(s.code)){const i=r.Ta.shift();yi(r).B_(),await wR(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Ul(r)}}(n,e),TR(n)&&ER(n)}async function oS(n,e){const t=K(n);t.asyncQueue.verifyOperationInProgress(),B(No,"RemoteStore received new credentials");const r=Oi(t);t.Ea.add(3),await Fl(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ih(t)}async function sy(n,e){const t=K(n);e?(t.Ea.delete(2),await Ih(t)):e||(t.Ea.add(2),await Fl(t),t.Va.set("Unknown"))}function jl(n){return n.ma||(n.ma=function(t,r,s){const i=K(t);return i.sa(),new fU(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Zo:wU.bind(null,n),Yo:TU.bind(null,n),t_:EU.bind(null,n),J_:IU.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),cw(n)?uw(n):n.Va.set("Unknown")):(await n.ma.stop(),vR(n))})),n.ma}function yi(n){return n.fa||(n.fa=function(t,r,s){const i=K(t);return i.sa(),new pU(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:CU.bind(null,n),t_:RU.bind(null,n),ta:xU.bind(null,n),na:kU.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Ul(n)):(await n.fa.stop(),n.Ta.length>0&&(B(No,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ut,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new hw(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bl(n,e){if(_t("AsyncQueue",`${e}: ${n}`),Di(n))return new U(L.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{static emptySet(e){return new mo(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||H.comparator(t.key,r.key):(t,r)=>H.comparator(t.key,r.key),this.keyedMap=Ou(),this.sortedSet=new je(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof mo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new mo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(){this.ga=new je(H.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):X(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class Do{constructor(e,t,r,s,i,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Do(e,t,mo.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class bU{constructor(){this.queries=lS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=K(t),i=s.queries;s.queries=lS(),i.forEach((o,a)=>{for(const l of a.ba)l.onError(r)})})(this,new U(L.ABORTED,"Firestore shutting down"))}}function lS(){return new ps(n=>hk(n),yh)}async function dw(n,e){const t=K(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new PU,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=Bl(o,`Initialization of query '${ca(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.ba.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&pw(t)}async function fw(n,e){const t=K(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function NU(n,e){const t=K(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.ba)a.Fa(s)&&(r=!0);o.wa=s}}r&&pw(t)}function DU(n,e,t){const r=K(n),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(t);r.queries.delete(e)}function pw(n){n.Ca.forEach(e=>{e.next()})}var iy,uS;(uS=iy||(iy={})).Ma="default",uS.Cache="cache";class mw{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Do(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Do.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==iy.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e){this.serializer=e}Ks(e){return br(this.serializer,e)}qs(e){return e.metadata.exists?Jp(this.serializer,e.document,!1):We.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return vt(e)}}class gw{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=SR(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=ve.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new cS(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Ks(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||pe()).add(i);t.set(o,a)}}return t}async ja(e){const t=await oU(e,new cS(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const s of this.Wa)await aU(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function SR(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.key=e}}class CR{constructor(e){this.key=e}}class xR{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=pe(),this.mutatedKeys=pe(),this.eu=fk(e),this.tu=new mo(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new aS,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,d)=>{const f=s.get(h),m=vh(this.query,d)?d:null,g=!!f&&this.mutatedKeys.has(f.key),w=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;f&&m?f.data.isEqual(m.data)?g!==w&&(r.track({type:3,doc:m}),E=!0):this.su(f,m)||(r.track({type:2,doc:m}),E=!0,(l&&this.eu(m,l)>0||u&&this.eu(m,u)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),E=!0):f&&!m&&(r.track({type:1,doc:f}),E=!0,(l||u)&&(a=!0)),E&&(m?(o=o.add(m),i=w?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,d)=>function(m,g){const w=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X(20277,{Vt:E})}};return w(m)-w(g)}(h.type,d.type)||this.eu(h.doc,d.doc)),this.ou(r),s=s??!1;const a=t&&!s?this._u():[],l=this.Ya.size===0&&this.current&&!s?1:0,u=l!==this.Xa;return this.Xa=l,o.length!==0||u?{snapshot:new Do(this.query,e.tu,i,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new aS,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=pe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new CR(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new AR(r))}),t}cu(e){this.Za=e.ks,this.Ya=pe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Do.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Mi="SyncEngine";class VU{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class OU{constructor(e){this.key=e,this.hu=!1}}class MU{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ps(a=>hk(a),yh),this.Iu=new Map,this.Eu=new Set,this.Ru=new je(H.comparator),this.Au=new Map,this.Vu=new ew,this.du={},this.mu=new Map,this.fu=bo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function LU(n,e,t=!0){const r=im(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await kR(r,e,t,!0),s}async function FU(n,e){const t=im(n);await kR(t,e,!0,!1)}async function kR(n,e,t,r){const s=await hl(n.localStore,en(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await _w(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&sm(n.remoteStore,s),a}async function _w(n,e,t,r,s){n.pu=(d,f,m)=>async function(w,E,y,T){let S=E.view.ru(y);S.Ss&&(S=await Yf(w.localStore,E.query,!1).then(({documents:I})=>E.view.ru(I,S)));const N=T&&T.targetChanges.get(E.targetId),P=T&&T.targetMismatches.get(E.targetId)!=null,D=E.view.applyChanges(S,w.isPrimaryClient,N,P);return oy(w,E.targetId,D.au),D.snapshot}(n,d,f,m);const i=await Yf(n.localStore,e,!0),o=new xR(e,i.ks),a=o.ru(i.documents),l=Eh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),u=o.applyChanges(a,n.isPrimaryClient,l);oy(n,t,u.au);const h=new VU(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function UU(n,e,t){const r=K(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!yh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await dl(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&fl(r.remoteStore,s.targetId),pl(r,s.targetId)}).catch(Ni)):(pl(r,s.targetId),await dl(r.localStore,s.targetId,!0))}async function jU(n,e){const t=K(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),fl(t.remoteStore,r.targetId))}async function BU(n,e,t){const r=Tw(n);try{const s=await function(o,a){const l=K(o),u=xe.now(),h=a.reduce((m,g)=>m.add(g.key),pe());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=yn(),w=pe();return l.xs.getEntries(m,h).next(E=>{g=E,g.forEach((y,T)=>{T.isValidDocument()||(w=w.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,g)).next(E=>{d=E;const y=[];for(const T of a){const S=c5(T,d.get(T.key).overlayedDocument);S!=null&&y.push(new ms(T.key,S,ek(S.value.mapValue),et.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,y,a)}).next(E=>{f=E;const y=E.applyToLocalDocumentSet(d,w);return l.documentOverlayCache.saveOverlays(m,E.batchId,y)})}).then(()=>({batchId:f.batchId,changes:mk(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let u=o.du[o.currentUser.toKey()];u||(u=new je(ce)),u=u.insert(a,l),o.du[o.currentUser.toKey()]=u}(r,s.batchId,t),await gs(r,s.changes),await Ul(r.remoteStore)}catch(s){const i=Bl(s,"Failed to persist write");t.reject(i)}}async function RR(n,e){const t=K(n);try{const r=await sU(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Au.get(i);o&&(ne(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ne(o.hu,14607):s.removedDocuments.size>0&&(ne(o.hu,42227),o.hu=!1))}),await gs(t,r,e)}catch(r){await Ni(r)}}function hS(n,e,t){const r=K(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=K(o);l.onlineState=a;let u=!1;l.queries.forEach((h,d)=>{for(const f of d.ba)f.va(a)&&(u=!0)}),u&&pw(l)}(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function zU(n,e,t){const r=K(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new je(H.comparator);o=o.insert(i,We.newNoDocument(i,ie.min()));const a=pe().add(i),l=new Th(ie.min(),new Map,new je(ce),o,a);await RR(r,l),r.Ru=r.Ru.remove(i),r.Au.delete(e),ww(r)}else await dl(r.localStore,e,!1).then(()=>pl(r,e,t)).catch(Ni)}async function qU(n,e){const t=K(n),r=e.batch.batchId;try{const s=await rU(t.localStore,e);vw(t,r,null),yw(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await gs(t,s)}catch(s){await Ni(s)}}async function $U(n,e,t){const r=K(n);try{const s=await function(o,a){const l=K(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next(d=>(ne(d!==null,37113),h=d.keys(),l.mutationQueue.removeMutationBatch(u,d))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(r.localStore,e);vw(r,e,t),yw(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await gs(r,s)}catch(s){await Ni(s)}}async function WU(n,e){const t=K(n);Oi(t.remoteStore)||B(Mi,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=K(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===ui)return void e.resolve();const s=t.mu.get(r)||[];s.push(e),t.mu.set(r,s)}catch(r){const s=Bl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function yw(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function vw(n,e,t){const r=K(n);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function pl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(r=>{n.Vu.containsKey(r)||PR(n,r)})}function PR(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(fl(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),ww(n))}function oy(n,e,t){for(const r of t)r instanceof AR?(n.Vu.addReference(r.key,e),GU(n,r)):r instanceof CR?(B(Mi,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||PR(n,r.key)):X(19791,{wu:r})}function GU(n,e){const t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(B(Mi,"New document in limbo: "+t),n.Eu.add(r),ww(n))}function ww(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new H(ve.fromString(e)),r=n.fu.next();n.Au.set(r,new OU(t)),n.Ru=n.Ru.insert(t,r),sm(n.remoteStore,new Hr(en(Ol(t.path)),r,"TargetPurposeLimboResolution",gn.ce))}}async function gs(n,e,t){const r=K(n),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,t).then(u=>{var h;if((u||t)&&r.isPrimaryClient){const d=u?!u.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){s.push(u);const d=sw.Es(l.targetId,u);i.push(d)}}))}),await Promise.all(o),r.Pu.J_(s),await async function(l,u){const h=K(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>O.forEach(u,f=>O.forEach(f.Ts,m=>h.persistence.referenceDelegate.addReference(d,f.targetId,m)).next(()=>O.forEach(f.Is,m=>h.persistence.referenceDelegate.removeReference(d,f.targetId,m)))))}catch(d){if(!Di(d))throw d;B(iw,"Failed to update sequence numbers: "+d)}for(const d of u){const f=d.targetId;if(!d.fromCache){const m=h.vs.get(f),g=m.snapshotVersion,w=m.withLastLimboFreeSnapshotVersion(g);h.vs=h.vs.insert(f,w)}}}(r.localStore,i))}async function HU(n,e){const t=K(n);if(!t.currentUser.isEqual(e)){B(Mi,"User change. New user:",e.toKey());const r=await oR(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new U(L.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await gs(t,r.Ns)}}function KU(n,e){const t=K(n),r=t.Au.get(e);if(r&&r.hu)return pe().add(r.key);{let s=pe();const i=t.Iu.get(e);if(!i)return s;for(const o of i){const a=t.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function QU(n,e){const t=K(n),r=await Yf(t.localStore,e.query,!0),s=e.view.cu(r);return t.isPrimaryClient&&oy(t,e.targetId,s.au),s}async function YU(n,e){const t=K(n);return cR(t.localStore,e).then(r=>gs(t,r))}async function XU(n,e,t,r){const s=K(n),i=await function(a,l){const u=K(a),h=K(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",d=>h.Xn(d,l).next(f=>f?u.localDocuments.getDocuments(d,f):O.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await Ul(s.remoteStore):t==="acknowledged"||t==="rejected"?(vw(s,e,r||null),yw(s,e),function(a,l){K(K(a).mutationQueue).nr(l)}(s.localStore,e)):X(6720,"Unknown batchState",{bu:t}),await gs(s,i)):B(Mi,"Cannot apply mutation batch with id: "+e)}async function JU(n,e){const t=K(n);if(im(t),Tw(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await dS(t,r.toArray());t.gu=!0,await sy(t.remoteStore,!0);for(const i of s)sm(t.remoteStore,i)}else if(e===!1&&t.gu!==!1){const r=[];let s=Promise.resolve();t.Iu.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(pl(t,o),dl(t.localStore,o,!0))),fl(t.remoteStore,o)}),await s,await dS(t,r),function(o){const a=K(o);a.Au.forEach((l,u)=>{fl(a.remoteStore,u)}),a.Vu.zr(),a.Au=new Map,a.Ru=new je(H.comparator)}(t),t.gu=!1,await sy(t.remoteStore,!1)}}async function dS(n,e,t){const r=K(n),s=[],i=[];for(const o of e){let a;const l=r.Iu.get(o);if(l&&l.length!==0){a=await hl(r.localStore,en(l[0]));for(const u of l){const h=r.Tu.get(u),d=await QU(r,h);d.snapshot&&i.push(d.snapshot)}}else{const u=await uR(r.localStore,o);a=await hl(r.localStore,u),await _w(r,bR(u),o,!1,a.resumeToken)}s.push(a)}return r.Pu.J_(i),s}function bR(n){return lk(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function ZU(n){return function(t){return K(K(t).persistence).hs()}(K(n).localStore)}async function e3(n,e,t,r){const s=K(n);if(s.gu)return void B(Mi,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await cR(s.localStore,dk(i[0])),a=Th.createSynthesizedRemoteEventForCurrentChange(e,t==="current",at.EMPTY_BYTE_STRING);await gs(s,o,a);break}case"rejected":await dl(s.localStore,e,!0),pl(s,e,r);break;default:X(64155,t)}}async function t3(n,e,t){const r=im(n);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){B(Mi,"Adding an already active target "+s);continue}const i=await uR(r.localStore,s),o=await hl(r.localStore,i);await _w(r,bR(i),o.targetId,!1,o.resumeToken),sm(r.remoteStore,o)}for(const s of t)r.Iu.has(s)&&await dl(r.localStore,s,!1).then(()=>{fl(r.remoteStore,s),pl(r,s)}).catch(Ni)}}function im(n){const e=K(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=RR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zU.bind(null,e),e.Pu.J_=NU.bind(null,e.eventManager),e.Pu.yu=DU.bind(null,e.eventManager),e}function Tw(n){const e=K(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$U.bind(null,e),e}function n3(n,e,t){const r=K(n);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(m,g){const w=K(m),E=vt(g.createTime);return w.persistence.runTransaction("hasNewerBundle","readonly",y=>w.Pi.getBundleMetadata(y,g.id)).then(y=>!!y&&y.createTime.compareTo(E)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(m){return{taskState:"Success",documentsLoaded:m.totalDocuments,bytesLoaded:m.totalBytes,totalDocuments:m.totalDocuments,totalBytes:m.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(SR(l));const u=new gw(l,o.serializer);let h=await o.Su();for(;h;){const f=await u.Ga(h);f&&a._updateProgress(f),h=await o.Su()}const d=await u.ja(i.localStore);return await gs(i,d.Ja,void 0),await function(m,g){const w=K(m);return w.persistence.runTransaction("Save bundle","readwrite",E=>w.Pi.saveBundleMetadata(E,g))}(i.localStore,l),a._completeWith(d.progress),Promise.resolve(d.Ha)}catch(l){return An(Mi,`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class ml{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return iR(this.persistence,new sR,e.initialUser,this.serializer)}Cu(e){return new tw(rm.Vi,this.serializer)}Du(e){return new mR}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ml.provider={build:()=>new ml};class Ew extends ml{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ne(this.persistence.referenceDelegate instanceof Qf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Jk(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new tw(r=>Qf.Vi(r,t),this.serializer)}}class Iw extends ml{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Tw(this.xu.syncEngine),await Ul(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return iR(this.persistence,new sR,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new Jk(r,e.asyncQueue,t)}Mu(e,t){const r=new u4(t,this.persistence);return new l4(e.asyncQueue,r)}Cu(e){const t=rw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new nw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,gR(),nf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new mR}}class NR extends Iw{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Cg&&(this.sharedClientState.syncEngine={So:XU.bind(null,t),Do:e3.bind(null,t),Co:t3.bind(null,t),hs:ZU.bind(null,t),bo:YU.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi(async r=>{await JU(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const t=gR();if(!Cg.v(t))throw new U(L.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=rw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Cg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class vi{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>hS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=HU.bind(null,this.syncEngine),await sy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new bU}()}createDatastore(e){const t=qo(e.databaseInfo.databaseId),r=dU(e.databaseInfo);return _U(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new vU(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>hS(this.syncEngine,t,0),function(){return sS.v()?new sS:new lU}())}createSyncEngine(e,t){return function(s,i,o,a,l,u,h){const d=new MU(s,i,o,a,l,u);return h&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=K(s);B(No,"RemoteStore shutting down."),i.Ea.add(5),await Fl(i),i.Aa.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}vi.provider={build:()=>new vi};function fS(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):_t("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r3{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Ut,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.qa)}`))},r=>this.metadata.reject(r))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const s=await this.Uu(r);return new IR(JSON.parse(s),e.length+r)}$u(){return this.buffer.findIndex(e=>e===123)}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Ua())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r==null?void 0:r.qa)}`);this.metadata=r;do r=this.Su(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;const e=this.Ku(),t=this.Uu(e);return new IR(JSON.parse(t),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new U(L.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let i3=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new U(L.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=K(s),a={documents:i.map(d=>Uc(o.serializer,d))},l=await o.jo("BatchGetDocuments",o.serializer.databaseId,ve.emptyPath(),a,i.length),u=new Map;l.forEach(d=>{const f=w5(o.serializer,d);u.set(f.key.toString(),f)});const h=[];return i.forEach(d=>{const f=u.get(d.toString());ne(!!f,55234,{key:d}),h.push(f)}),h}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ll(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=H.fromPath(r);this.mutations.push(new Gv(s,this.precondition(s)))}),await async function(r,s){const i=K(r),o={writes:s.map(a=>jc(i.serializer,a))};await i.Wo("Commit",i.serializer.databaseId,ve.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw X(50498,{Gu:e.constructor.name});t=ie.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new U(L.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ie.min())?et.exists(!1):et.updateTime(t):et.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ie.min()))throw new U(L.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return et.updateTime(t)}return et.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this.zu=r.maxAttempts,this.M_=new aw(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_(async()=>{const e=new i3(this.datastore),t=this.Ju(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Zu(s)}))}).catch(r=>{this.Zu(r)})})}Ju(e){try{const t=this.updateFunction(e);return!mh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Hu(),Promise.resolve()))):this.deferred.reject(e)}Xu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Ck(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="FirestoreClient";class a3{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=s,this.user=Mt.UNAUTHENTICATED,this.clientId=Bp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{B(wi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(B(wi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ut;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Bl(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function kg(n,e){n.asyncQueue.verifyOperationInProgress(),B(wi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await oR(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function pS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Sw(n);B(wi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>oS(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>oS(e.remoteStore,s)),n._onlineComponents=e}async function Sw(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B(wi,"Using user provided OfflineComponentProvider");try{await kg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===L.FAILED_PRECONDITION||s.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;An("Error using user provided cache. Falling back to memory cache: "+t),await kg(n,new ml)}}else B(wi,"Using default OfflineComponentProvider"),await kg(n,new Ew(void 0));return n._offlineComponents}async function am(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(B(wi,"Using user provided OnlineComponentProvider"),await pS(n,n._uninitializedComponentsProvider._online)):(B(wi,"Using default OnlineComponentProvider"),await pS(n,new vi))),n._onlineComponents}function DR(n){return Sw(n).then(e=>e.persistence)}function zl(n){return Sw(n).then(e=>e.localStore)}function VR(n){return am(n).then(e=>e.remoteStore)}function Aw(n){return am(n).then(e=>e.syncEngine)}function OR(n){return am(n).then(e=>e.datastore)}async function gl(n){const e=await am(n),t=e.eventManager;return t.onListen=LU.bind(null,e.syncEngine),t.onUnlisten=UU.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=FU.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=jU.bind(null,e.syncEngine),t}function l3(n){return n.asyncQueue.enqueue(async()=>{const e=await DR(n),t=await VR(n);return e.setNetworkEnabled(!0),function(s){const i=K(s);return i.Ea.delete(0),Ih(i)}(t)})}function u3(n){return n.asyncQueue.enqueue(async()=>{const e=await DR(n),t=await VR(n);return e.setNetworkEnabled(!1),async function(s){const i=K(s);i.Ea.add(0),await Fl(i),i.Va.set("Offline")}(t)})}function c3(n,e,t,r){const s=new om(r),i=new mw(e,s,t);return n.asyncQueue.enqueueAndForget(async()=>dw(await gl(n),i)),()=>{s.Nu(),n.asyncQueue.enqueueAndForget(async()=>fw(await gl(n),i))}}function h3(n,e){const t=new Ut;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(u,h){const d=K(u);return d.persistence.runTransaction("read document","readonly",f=>d.localDocuments.getDocument(f,h))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new U(L.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=Bl(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await zl(n),e,t)),t.promise}function MR(n,e,t={}){const r=new Ut;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const h=new om({next:f=>{h.Nu(),o.enqueueAndForget(()=>fw(i,d));const m=f.docs.has(a);!m&&f.fromCache?u.reject(new U(L.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?u.reject(new U(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),d=new mw(Ol(a.path),h,{includeMetadataChanges:!0,Ka:!0});return dw(i,d)}(await gl(n),n.asyncQueue,e,t,r)),r.promise}function d3(n,e){const t=new Ut;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await Yf(s,i,!0),l=new xR(i,a.ks),u=l.ru(a.documents),h=l.applyChanges(u,!1);o.resolve(h.snapshot)}catch(a){const l=Bl(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await zl(n),e,t)),t.promise}function LR(n,e,t={}){const r=new Ut;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const h=new om({next:f=>{h.Nu(),o.enqueueAndForget(()=>fw(i,d)),f.fromCache&&l.source==="server"?u.reject(new U(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),d=new mw(a,h,{includeMetadataChanges:!0,Ka:!0});return dw(i,d)}(await gl(n),n.asyncQueue,e,t,r)),r.promise}function f3(n,e,t){const r=new Ut;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await OR(n);r.resolve(async function(o,a,l){var w;const u=K(o),{request:h,gt:d,parent:f}=Lk(u.serializer,uk(a),l);u.connection.Ko||delete h.parent;const m=(await u.jo("RunAggregationQuery",u.serializer.databaseId,f,h,1)).filter(E=>!!E.result);ne(m.length===1,64727);const g=(w=m[0].result)==null?void 0:w.aggregateFields;return Object.keys(g).reduce((E,y)=>(E[d[y]]=g[y],E),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function p3(n,e){const t=new Ut;return n.asyncQueue.enqueueAndForget(async()=>BU(await Aw(n),e,t)),t.promise}function m3(n,e){const t=new om(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){K(s).Ca.add(i),i.next()}(await gl(n),t)),()=>{t.Nu(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){K(s).Ca.delete(i)}(await gl(n),t))}}function g3(n,e,t){const r=new Ut;return n.asyncQueue.enqueueAndForget(async()=>{const s=await OR(n);new o3(n.asyncQueue,s,t,e,r).ju()}),r.promise}function _3(n,e,t,r){const s=function(o,a){let l;return l=typeof o=="string"?kk().encode(o):o,function(h,d){return new r3(h,d)}(function(h,d){if(h instanceof Uint8Array)return fS(h,d);if(h instanceof ArrayBuffer)return fS(new Uint8Array(h),d);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,qo(e));n.asyncQueue.enqueueAndForget(async()=>{n3(await Aw(n),s,r)})}function y3(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=K(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Pi.getNamedQuery(o,s))}(await zl(n),e))}function FR(n,e){return function(r,s){return new s3(r,s)}(n,e)}function v3(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const i=K(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(u=>function(d,f,m,g,w){d=[...d],f=[...f],d.sort(m),f.sort(m);const E=d.length,y=f.length;let T=0,S=0;for(;T<y&&S<E;){const N=m(d[S],f[T]);N<0?w(d[S++]):N>0?g(f[T++]):(T++,S++)}for(;T<y;)g(f[T++]);for(;S<E;)w(d[S++])}(u,s,s4,h=>{a.push(o.addFieldIndex(l,h))},h=>{a.push(o.deleteFieldIndex(l,h))})).next(()=>O.waitFor(a)))}(await zl(n),e))}function w3(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){K(r).Cs.As=s}(await zl(n),e))}function T3(n){return n.asyncQueue.enqueue(async()=>function(t){const r=K(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await zl(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UR(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3="ComponentProvider",mS=new Map;function I3(n,e,t,r,s){return new F4(n,e,t,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,UR(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR="firestore.googleapis.com",gS=!0;class _S{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new U(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jR,this.ssl=gS}else this.host=e.host,this.ssl=e.ssl??gS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Hk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Xk)throw new U(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ax("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=UR(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new U(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new U(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new U(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sh{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _S({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new U(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _S(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ix;switch(r.type){case"firstParty":return new XF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new U(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=mS.get(t);r&&(B(E3,"Removing Datastore"),mS.delete(t),r.terminate())}(this),Promise.resolve()}}function BR(n,e,t,r={}){var u;n=we(n,Sh);const s=Bo(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;s&&(vv(`https://${a}`),AC("Firestore",!0)),i.host!==jR&&i.host!==a&&An("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!hr(l,o)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Mt.MOCK_USER;else{h=rO(r.mockUserToken,(u=n._app)==null?void 0:u.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new U(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Mt(f)}n._authCredentials=new KF(new Ex(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new kt(this.firestore,e,this._query)}}class Re{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ar(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Re(this.firestore,e,this._key)}toJSON(){return{type:Re._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(zo(t,Re._jsonSchema))return new Re(e,r||null,new H(ve.fromString(t.referencePath)))}}Re._jsonSchemaVersion="firestore/documentReference/1.0",Re._jsonSchema={type:It("string",Re._jsonSchemaVersion),referencePath:It("string")};class ar extends kt{constructor(e,t,r){super(e,t,Ol(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Re(this.firestore,null,new H(e))}withConverter(e){return new ar(this.firestore,e,this._path)}}function zR(n,e,...t){if(n=Me(n),Dv("collection","path",e),n instanceof Sh){const r=ve.fromString(e,...t);return iI(r),new ar(n,null,r)}{if(!(n instanceof Re||n instanceof ar))throw new U(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ve.fromString(e,...t));return iI(r),new ar(n.firestore,null,r)}}function S3(n,e){if(n=we(n,Sh),Dv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new U(L.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new kt(n,null,function(r){return new fs(ve.emptyPath(),r)}(e))}function Ah(n,e,...t){if(n=Me(n),arguments.length===1&&(e=Bp.newId()),Dv("doc","path",e),n instanceof Sh){const r=ve.fromString(e,...t);return sI(r),new Re(n,null,new H(r))}{if(!(n instanceof Re||n instanceof ar))throw new U(L.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ve.fromString(e,...t));return sI(r),new Re(n.firestore,n instanceof ar?n.converter:null,new H(r))}}function A3(n,e){return n=Me(n),e=Me(e),(n instanceof Re||n instanceof ar)&&(e instanceof Re||e instanceof ar)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Cw(n,e){return n=Me(n),e=Me(e),n instanceof kt&&e instanceof kt&&n.firestore===e.firestore&&yh(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="AsyncQueue";class vS{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new aw(this,"async_queue_retry"),this._c=()=>{const r=nf();r&&B(yS,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=nf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=nf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Ut;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Di(e))throw e;B(yS,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,_t("INTERNAL UNHANDLED ERROR: ",wS(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=hw.createAndSchedule(this,e,t,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&X(47125,{Pc:wS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function wS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ut,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3=-1;class De extends Sh{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new vS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vS(e),this._firestoreClient=void 0,await e}}}function x3(n,e,t){t||(t=Oc);const r=ch(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(hr(i,e))return s;throw new U(L.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new U(L.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Xk)throw new U(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Bo(e.host)&&vv(e.host),r.initialize({options:e,instanceIdentifier:t})}function $R(n,e){const t=typeof n=="object"?n:DC(),r=typeof n=="string"?n:e||Oc,s=ch(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=tO("firestore");i&&BR(s,...i)}return s}function nt(n){if(n._terminated)throw new U(L.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||WR(n),n._firestoreClient}function WR(n){var r,s,i,o;const e=n._freezeSettings(),t=I3(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,(s=n._app)==null?void 0:s.options.apiKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new a3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(n._componentsProvider))}function k3(n,e){An("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return GR(n,vi.provider,{build:r=>new Iw(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function R3(n){An("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();GR(n,vi.provider,{build:t=>new NR(t,e.cacheSizeBytes)})}function GR(n,e,t){if((n=we(n,De))._firestoreClient||n._terminated)throw new U(L.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new U(L.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},WR(n)}function P3(n){if(n._initialized&&!n._terminated)throw new U(L.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Ut;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Pr.v())return Promise.resolve();const s=r+rR;await Pr.delete(s)}(rw(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function b3(n){return function(t){const r=new Ut;return t.asyncQueue.enqueueAndForget(async()=>WU(await Aw(t),r)),r.promise}(nt(n=we(n,De)))}function N3(n){return l3(nt(n=we(n,De)))}function D3(n){return u3(nt(n=we(n,De)))}function V3(n){return mM(n.app,"firestore",n._databaseId.database),n._delete()}function ay(n,e){const t=nt(n=we(n,De)),r=new qR;return _3(t,n._databaseId,e,r),r}function HR(n,e){return y3(nt(n=we(n,De)),e).then(t=>t?new kt(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pn(at.fromBase64String(e))}catch(t){throw new U(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new pn(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zo(e,pn._jsonSchema))return pn.fromBase64String(e.bytes)}}pn._jsonSchemaVersion="firestore/bytes/1.0",pn._jsonSchema={type:It("string",pn._jsonSchemaVersion),bytes:It("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new U(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function O3(){return new $o(L_)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new U(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new U(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:lr._jsonSchemaVersion}}static fromJSON(e){if(zo(e,lr._jsonSchema))return new lr(e.latitude,e.longitude)}}lr._jsonSchemaVersion="firestore/geoPoint/1.0",lr._jsonSchema={type:It("string",lr._jsonSchemaVersion),latitude:It("number"),longitude:It("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zo(e,Dn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Dn(e.vectorValues);throw new U(L.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dn._jsonSchemaVersion="firestore/vectorValue/1.0",Dn._jsonSchema={type:It("string",Dn._jsonSchemaVersion),vectorValues:It("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M3=/^__.*__$/;class L3{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ms(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ml(e,this.data,t,this.fieldTransforms)}}class KR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ms(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function QR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X(40011,{dataSource:n})}}class lm{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new lm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return ep(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(QR(this.dataSource)&&M3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class F3{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||qo(e)}createContext(e,t,r,s=!1){return new lm({dataSource:e,methodName:t,targetDoc:r,path:Ge.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wo(n){const e=n._freezeSettings(),t=qo(n._databaseId);return new F3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function um(n,e,t,r,s,i={}){const o=n.createContext(i.merge||i.mergeFields?2:0,e,t,s);Dw("Data must be an object, but it was:",o,r);const a=JR(r,o);let l,u;if(i.merge)l=new _n(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const f=as(e,d,t);if(!o.contains(f))throw new U(L.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);eP(h,f)||h.push(f)}l=new _n(h),u=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,u=o.fieldTransforms;return new L3(new Lt(a),l,u)}class Ch extends Li{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ch}}function YR(n,e,t){return new lm({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class xw extends Li{_toFieldTransform(e){return new wh(e.path,new ll)}isEqual(e){return e instanceof xw}}class kw extends Li{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=YR(this,e,!0),r=this.Ac.map(i=>Go(i,t)),s=new xo(r);return new wh(e.path,s)}isEqual(e){return e instanceof kw&&hr(this.Ac,e.Ac)}}class Rw extends Li{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=YR(this,e,!0),r=this.Ac.map(i=>Go(i,t)),s=new ko(r);return new wh(e.path,s)}isEqual(e){return e instanceof Rw&&hr(this.Ac,e.Ac)}}class Pw extends Li{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new ul(e.serializer,yk(e.serializer,this.Vc));return new wh(e.path,t)}isEqual(e){return e instanceof Pw&&this.Vc===e.Vc}}function bw(n,e,t,r){const s=n.createContext(1,e,t);Dw("Data must be an object, but it was:",s,r);const i=[],o=Lt.empty();Vi(r,(l,u)=>{const h=Vw(e,l,t);u=Me(u);const d=s.childContextForFieldPath(h);if(u instanceof Ch)i.push(h);else{const f=Go(u,d);f!=null&&(i.push(h),o.set(h,f))}});const a=new _n(i);return new KR(o,a,s.fieldTransforms)}function Nw(n,e,t,r,s,i){const o=n.createContext(1,e,t),a=[as(e,r,t)],l=[s];if(i.length%2!=0)throw new U(L.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(as(e,i[f])),l.push(i[f+1]);const u=[],h=Lt.empty();for(let f=a.length-1;f>=0;--f)if(!eP(u,a[f])){const m=a[f];let g=l[f];g=Me(g);const w=o.childContextForFieldPath(m);if(g instanceof Ch)u.push(m);else{const E=Go(g,w);E!=null&&(u.push(m),h.set(m,E))}}const d=new _n(u);return new KR(h,d,o.fieldTransforms)}function XR(n,e,t,r=!1){return Go(t,n.createContext(r?4:3,e))}function Go(n,e){if(ZR(n=Me(n)))return Dw("Unsupported field value:",e,n),JR(n,e);if(n instanceof Li)return function(r,s){if(!QR(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Go(a,s.childContextForArray(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Me(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return yk(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=xe.fromDate(r);return{timestampValue:cl(s.serializer,i)}}if(r instanceof xe){const i=new xe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:cl(s.serializer,i)}}if(r instanceof lr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pn)return{bytesValue:bk(s.serializer,r._byteString)};if(r instanceof Re){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Xv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Dn)return function(o,a){const l=o instanceof Dn?o.toArray():o;return{mapValue:{fields:{[jv]:{stringValue:Bv},[il]:{arrayValue:{values:l.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return Wv(a.serializer,h)})}}}}}}(r,s);if(zk(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${zp(r)}`)}(n,e)}function JR(n,e){const t={};return Wx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vi(n,(r,s)=>{const i=Go(s,e.childContextForField(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function ZR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xe||n instanceof lr||n instanceof pn||n instanceof Re||n instanceof Li||n instanceof Dn||zk(n))}function Dw(n,e,t){if(!ZR(t)||!Cx(t)){const r=zp(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function as(n,e,t){if((e=Me(e))instanceof $o)return e._internalPath;if(typeof e=="string")return Vw(n,e);throw ep("Field path arguments must be of type string or ",n,!1,void 0,t)}const U3=new RegExp("[~\\*/\\[\\]]");function Vw(n,e,t){if(e.search(U3)>=0)throw ep(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new $o(...e.split("."))._internalPath}catch{throw ep(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ep(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new U(L.INVALID_ARGUMENT,a+n+l)}function eP(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{convertValue(e,t="none"){switch(mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(os(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw X(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Vi(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var r,s,i;const t=(i=(s=(r=e.fields)==null?void 0:r[il].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Xe(o.doubleValue));return new Dn(t)}convertGeoPoint(e){return new lr(Xe(e.latitude),Xe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Kp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Vc(e));default:return null}}convertTimestamp(e){const t=is(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ve.fromString(e);ne(Bk(r),9688,{name:e});const s=new pi(r.get(1),r.get(3)),i=new H(r.popFirst(5));return s.isEqual(t)||_t(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends Ow{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j3(){return new Ch("deleteField")}function B3(){return new xw("serverTimestamp")}function z3(...n){return new kw("arrayUnion",n)}function q3(...n){return new Rw("arrayRemove",n)}function $3(n){return new Pw("increment",n)}function W3(n){return new Dn(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(n){var r;const e=nt(we(n.firestore,De)),t=(r=e._onlineComponents)==null?void 0:r.datastore.serializer;return t===void 0?null:Zp(t,en(n._query)).ft}function H3(n,e){var i;const t=$x(e,(o,a)=>new Ak(a,o.aggregateType,o._internalFieldPath)),r=nt(we(n.firestore,De)),s=(i=r._onlineComponents)==null?void 0:i.datastore.serializer;return s===void 0?null:Lk(s,uk(n._query),t,!0).request}const TS="@firebase/firestore",ES="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ja(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class tP{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new Lt({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Re(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new K3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(as("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class K3 extends Bc{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new U(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Mw{}class ql extends Mw{}function rP(n,e,...t){let r=[];e instanceof Mw&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof Ho).length,a=i.filter(l=>l instanceof $l).length;if(o>1||o>0&&a>0)throw new U(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class $l extends ql{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new $l(e,t,r)}_apply(e){const t=this._parse(e);return oP(e._query,t),new kt(e.firestore,e.converter,K_(e._query,t))}_parse(e){const t=Wo(e.firestore);return function(i,o,a,l,u,h,d){let f;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new U(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){SS(d,h);const g=[];for(const w of d)g.push(IS(l,i,w));f={arrayValue:{values:g}}}else f=IS(l,i,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||SS(d,h),f=XR(a,o,d,h==="in"||h==="not-in");return Se.create(u,h,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Q3(n,e,t){const r=e,s=as("where",n);return $l._create(s,r,t)}class Ho extends Mw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ho(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ke.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)oP(o,l),o=K_(o,l)}(e._query,t),new kt(e.firestore,e.converter,K_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Y3(...n){return n.forEach(e=>aP("or",e)),Ho._create("or",n)}function X3(...n){return n.forEach(e=>aP("and",e)),Ho._create("and",n)}class cm extends ql{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new cm(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new U(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new U(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fc(i,o)}(e._query,this._field,this._direction);return new kt(e.firestore,e.converter,X4(e._query,t))}}function J3(n,e="asc"){const t=e,r=as("orderBy",n);return cm._create(r,t)}class xh extends ql{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new xh(e,t,r)}_apply(e){return new kt(e.firestore,e.converter,Wf(e._query,this._limit,this._limitType))}}function sP(n){return xx("limit",n),xh._create("limit",n,"F")}function Z3(n){return xx("limitToLast",n),xh._create("limitToLast",n,"L")}class kh extends ql{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new kh(e,t,r)}_apply(e){const t=iP(e,this.type,this._docOrFields,this._inclusive);return new kt(e.firestore,e.converter,J4(e._query,t))}}function ej(...n){return kh._create("startAt",n,!0)}function tj(...n){return kh._create("startAfter",n,!1)}class Rh extends ql{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Rh(e,t,r)}_apply(e){const t=iP(e,this.type,this._docOrFields,this._inclusive);return new kt(e.firestore,e.converter,Z4(e._query,t))}}function nj(...n){return Rh._create("endBefore",n,!1)}function rj(...n){return Rh._create("endAt",n,!0)}function iP(n,e,t,r){if(t[0]=Me(t[0]),t[0]instanceof Bc)return function(i,o,a,l,u){if(!l)throw new U(L.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const d of Fa(i))if(d.field.isKeyField())h.push(Ao(o,l.key));else{const f=l.data.field(d.field);if(Hp(f))throw new U(L.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){const m=d.field.canonicalString();throw new U(L.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}h.push(f)}return new _i(h,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Wo(n.firestore);return function(o,a,l,u,h,d){const f=o.explicitOrderBy;if(h.length>f.length)throw new U(L.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let g=0;g<h.length;g++){const w=h[g];if(f[g].field.isKeyField()){if(typeof w!="string")throw new U(L.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof w}`);if(!qv(o)&&w.indexOf("/")!==-1)throw new U(L.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${w}' contains a slash.`);const E=o.path.child(ve.fromString(w));if(!H.isDocumentKey(E))throw new U(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${E}' is not because it contains an odd number of segments.`);const y=new H(E);m.push(Ao(a,y))}else{const E=XR(l,u,w);m.push(E)}}return new _i(m,d)}(n._query,n.firestore._databaseId,s,e,t,r)}}function IS(n,e,t){if(typeof(t=Me(t))=="string"){if(t==="")throw new U(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qv(e)&&t.indexOf("/")!==-1)throw new U(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ve.fromString(t));if(!H.isDocumentKey(r))throw new U(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ao(n,new H(r))}if(t instanceof Re)return Ao(n,t._key);throw new U(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zp(t)}.`)}function SS(n,e){if(!Array.isArray(n)||n.length===0)throw new U(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oP(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new U(L.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new U(L.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function aP(n,e){if(!(e instanceof $l||e instanceof Ho))throw new U(L.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function hm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Lw extends Ow{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(n){return new _l("sum",as("sum",n))}function ij(n){return new _l("avg",as("average",n))}function lP(){return new _l("count")}function oj(n,e){var t,r;return n instanceof _l&&e instanceof _l&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)==null?void 0:t.canonicalString())===((r=e._internalFieldPath)==null?void 0:r.canonicalString())}function aj(n,e){return Cw(n.query,e.query)&&hr(n.data(),e.data())}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(n){return uP(n,{count:lP()})}function uP(n,e){const t=we(n.firestore,De),r=nt(t),s=$x(e,(i,o)=>new Ak(o,i.aggregateType,i._internalFieldPath));return f3(r,n._query,s).then(i=>function(a,l,u){const h=new Fi(a);return new tP(l,h,u)}(t,n,i))}class uj{constructor(e){this.kind="memory",this._onlineComponentProvider=vi.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new Ew(void 0)}}toJSON(){return{kind:this.kind}}}class cj{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=cP(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class hj{constructor(){this.kind="memoryEager",this._offlineComponentProvider=ml.provider}toJSON(){return{kind:this.kind}}}class dj{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Ew(e)}}toJSON(){return{kind:this.kind}}}function fj(){return new hj}function pj(n){return new dj(n==null?void 0:n.cacheSizeBytes)}function mj(n){return new uj(n)}function gj(n){return new cj(n)}class _j{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=vi.provider,this._offlineComponentProvider={build:t=>new Iw(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class yj{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=vi.provider,this._offlineComponentProvider={build:t=>new NR(t,e==null?void 0:e.cacheSizeBytes)}}}function cP(n){return new _j(n==null?void 0:n.forceOwnership)}function vj(){return new yj}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP="NOT SUPPORTED";class Kr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class En extends Bc{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new sc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(as("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new U(L.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=En._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}function wj(n,e,t){if(zo(e,En._jsonSchema)){if(e.bundle===hP)throw new U(L.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=qo(n._databaseId),s=FR(e.bundle,r),i=s.t(),o=new gw(s.getMetadata(),r);for(const h of i)o.o(h);const a=o.documents;if(a.length!==1)throw new U(L.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);const l=Jp(r,a[0].document),u=new H(ve.fromString(e.bundleName));return new En(n,new Lw(n),u,l,new Kr(!1,!1),t||null)}}En._jsonSchemaVersion="firestore/documentSnapshot/1.0",En._jsonSchema={type:It("string",En._jsonSchemaVersion),bundleSource:It("string","DocumentSnapshot"),bundleName:It("string"),bundle:It("string")};class sc extends En{data(e={}){return super.data(e)}}class In{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Kr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new sc(this._firestore,this._userDataWriter,r.key,r,new Kr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new U(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new sc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Kr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new sc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Kr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Ej(a.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new U(L.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=In._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Bp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Tj(n,e,t){if(zo(e,In._jsonSchema)){if(e.bundle===hP)throw new U(L.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=qo(n._databaseId),s=FR(e.bundle,r),i=s.t(),o=new gw(s.getMetadata(),r);for(const f of i)o.o(f);if(o.queries.length!==1)throw new U(L.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);const a=em(o.queries[0].bundledQuery),l=o.documents;let u=new mo;l.map(f=>{const m=Jp(r,f.document);u=u.add(m)});const h=Do.fromInitialDocuments(a,u,pe(),!1,!1),d=new kt(n,t||null,a);return new In(n,new Lw(n),d,h)}}function Ej(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X(61501,{type:n})}}function Ij(n,e){return n instanceof En&&e instanceof En?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof In&&e instanceof In&&n._firestore===e._firestore&&Cw(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In._jsonSchemaVersion="firestore/querySnapshot/1.0",In._jsonSchema={type:It("string",In._jsonSchemaVersion),bundleSource:It("string","QuerySnapshot"),bundleName:It("string"),bundle:It("string")};const Sj={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wo(e)}set(e,t,r){this._verifyNotCommitted();const s=Qs(e,this._firestore),i=hm(s.converter,t,r),o=um(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,et.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=Qs(e,this._firestore);let o;return o=typeof(t=Me(t))=="string"||t instanceof $o?Nw(this._dataReader,"WriteBatch.update",i._key,t,r,s):bw(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,et.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Qs(e,this._firestore);return this._mutations=this._mutations.concat(new Ll(t._key,et.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new U(L.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Qs(n,e){if((n=Me(n)).firestore!==e)throw new U(L.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Wo(e)}get(e){const t=Qs(e,this._firestore),r=new Lw(this._firestore);return this._transaction.lookup([t._key]).then(s=>{if(!s||s.length!==1)return X(24041);const i=s[0];if(i.isFoundDocument())return new Bc(this._firestore,r,i.key,i,t.converter);if(i.isNoDocument())return new Bc(this._firestore,r,t._key,null,t.converter);throw X(18433,{doc:i})})}set(e,t,r){const s=Qs(e,this._firestore),i=hm(s.converter,t,r),o=um(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,t,r,...s){const i=Qs(e,this._firestore);let o;return o=typeof(t=Me(t))=="string"||t instanceof $o?Nw(this._dataReader,"Transaction.update",i._key,t,r,s):bw(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,o),this}delete(e){const t=Qs(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP extends Aj{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Qs(e,this._firestore),r=new Fi(this._firestore);return super.get(e).then(s=>new En(this._firestore,r,t._key,s._document,new Kr(!1,!1),t.converter))}}function Cj(n,e,t){n=we(n,De);const r={...Sj,...t};(function(o){if(o.maxAttempts<1)throw new U(L.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const s=nt(n);return g3(s,i=>e(new fP(n,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(n){n=we(n,Re);const e=we(n.firestore,De),t=nt(e);return MR(t,n._key).then(r=>Uw(e,n,r))}function xj(n){n=we(n,Re);const e=we(n.firestore,De),t=nt(e),r=new Fi(e);return h3(t,n._key).then(s=>new En(e,r,n._key,s,new Kr(s!==null&&s.hasLocalMutations,!0),n.converter))}function kj(n){n=we(n,Re);const e=we(n.firestore,De),t=nt(e);return MR(t,n._key,{source:"server"}).then(r=>Uw(e,n,r))}function mP(n){n=we(n,kt);const e=we(n.firestore,De),t=nt(e),r=new Fi(e);return nP(n._query),LR(t,n._query).then(s=>new In(e,r,n,s))}function Rj(n){n=we(n,kt);const e=we(n.firestore,De),t=nt(e),r=new Fi(e);return d3(t,n._query).then(s=>new In(e,r,n,s))}function Pj(n){n=we(n,kt);const e=we(n.firestore,De),t=nt(e),r=new Fi(e);return LR(t,n._query,{source:"server"}).then(s=>new In(e,r,n,s))}function Fw(n,e,t){n=we(n,Re);const r=we(n.firestore,De),s=hm(n.converter,e,t),i=Wo(r);return Wl(r,[um(i,"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,et.none())])}function bj(n,e,t,...r){n=we(n,Re);const s=we(n.firestore,De),i=Wo(s);let o;return o=typeof(e=Me(e))=="string"||e instanceof $o?Nw(i,"updateDoc",n._key,e,t,r):bw(i,"updateDoc",n._key,e),Wl(s,[o.toMutation(n._key,et.exists(!0))])}function Nj(n){return Wl(we(n.firestore,De),[new Ll(n._key,et.none())])}function Dj(n,e){const t=we(n.firestore,De),r=Ah(n),s=hm(n.converter,e),i=Wo(n.firestore);return Wl(t,[um(i,"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,et.exists(!1))]).then(()=>r)}function ly(n,...e){var u,h,d;n=Me(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||ja(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(ja(e[r])){const f=e[r];e[r]=(u=f.next)==null?void 0:u.bind(f),e[r+1]=(h=f.error)==null?void 0:h.bind(f),e[r+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,a;if(n instanceof Re)o=we(n.firestore,De),a=Ol(n._key.path),i={next:f=>{e[r]&&e[r](Uw(o,n,f))},error:e[r+1],complete:e[r+2]};else{const f=we(n,kt);o=we(f.firestore,De),a=f._query;const m=new Fi(o);i={next:g=>{e[r]&&e[r](new In(o,m,f,g))},error:e[r+1],complete:e[r+2]},nP(n._query)}const l=nt(o);return c3(l,a,s,i)}function Vj(n,e,...t){const r=Me(n),s=function(l){const u={bundle:"",bundleName:"",bundleSource:""},h=["bundle","bundleName","bundleSource"];for(const d of h){if(!(d in l)){u.error=`snapshotJson missing required field: ${d}`;break}const f=l[d];if(typeof f!="string"){u.error=`snapshotJson field '${d}' must be a string.`;break}if(f.length===0){u.error=`snapshotJson field '${d}' cannot be an empty string.`;break}d==="bundle"?u.bundle=f:d==="bundleName"?u.bundleName=f:d==="bundleSource"&&(u.bundleSource=f)}return u}(e);if(s.error)throw new U(L.INVALID_ARGUMENT,s.error);let i,o=0;if(typeof t[o]!="object"||ja(t[o])||(i=t[o++]),s.bundleSource==="QuerySnapshot"){let a=null;if(typeof t[o]=="object"&&ja(t[o])){const l=t[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:t[o++],error:t[o++],complete:t[o++]};return function(u,h,d,f,m){let g,w=!1;return ay(u,h.bundle).then(()=>HR(u,h.bundleName)).then(y=>{y&&!w&&(m&&y.withConverter(m),g=ly(y,d||{},f))}).catch(y=>(f.error&&f.error(y),()=>{})),()=>{w||(w=!0,g&&g())}}(r,s,i,a,t[o])}if(s.bundleSource==="DocumentSnapshot"){let a=null;if(typeof t[o]=="object"&&ja(t[o])){const l=t[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:t[o++],error:t[o++],complete:t[o++]};return function(u,h,d,f,m){let g,w=!1;return ay(u,h.bundle).then(()=>{if(!w){const y=new Re(u,m||null,H.fromPath(h.bundleName));g=ly(y,d||{},f)}}).catch(y=>(f.error&&f.error(y),()=>{})),()=>{w||(w=!0,g&&g())}}(r,s,i,a,t[o])}throw new U(L.INVALID_ARGUMENT,`unsupported bundle source: ${s.bundleSource}`)}function Oj(n,e){n=we(n,De);const t=nt(n),r=ja(e)?e:{next:e};return m3(t,r)}function Wl(n,e){const t=nt(n);return p3(t,e)}function Uw(n,e,t){const r=t.docs.get(e._key),s=new Fi(n);return new En(n,s,e._key,r,new Kr(t.hasPendingWrites,t.fromCache),e.converter)}function Mj(n){return n=we(n,De),nt(n),new dP(n,e=>Wl(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(n,e){n=we(n,De);const t=nt(n);if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return An("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(u){try{return JSON.parse(u)}catch(h){throw new U(L.INVALID_ARGUMENT,"Failed to parse JSON: "+(h==null?void 0:h.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const u=AS(l,"collectionGroup"),h=[];if(Array.isArray(l.fields))for(const d of l.fields){const f=AS(d,"fieldPath"),m=Vw("setIndexConfiguration",f);d.arrayConfig==="CONTAINS"?h.push(new fo(m,2)):d.order==="ASCENDING"?h.push(new fo(m,0)):d.order==="DESCENDING"&&h.push(new fo(m,1))}a.push(new Za(Za.UNKNOWN_ID,u,h,el.empty()))}return a}(e);return v3(t,r)}function AS(n,e){if(typeof n[e]!="string")throw new U(L.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function Fj(n){var s;n=we(n,De);const e=CS.get(n);if(e)return e;if(((s=nt(n)._uninitializedComponentsProvider)==null?void 0:s._offline.kind)!=="persistent")return null;const r=new gP(n);return CS.set(n,r),r}function Uj(n){_P(n,!0)}function jj(n){_P(n,!1)}function Bj(n){const e=nt(n._firestore);T3(e).then(t=>B("deleting all persistent cache indexes succeeded")).catch(t=>An("deleting all persistent cache indexes failed",t))}function _P(n,e){const t=nt(n._firestore);w3(t,e).then(r=>B(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(r=>An(`setting persistent cache index auto creation isEnabled=${e} failed`,r))}const CS=new WeakMap;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return jw.instance.onExistenceFilterMismatch(e)}}class jw{constructor(){this.i=new Map}static get instance(){return Cd||(Cd=new jw,d5(Cd)),Cd}u(e){this.i.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.i;return r.set(t,e),()=>r.delete(t)}}let Cd=null;(function(e,t=!0){WF(Nl),Ya(new Eo("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new De(new QF(r.getProvider("auth-internal")),new JF(o,r.getProvider("app-check-internal")),U4(o,s),o);return i={useFetchStreams:t,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),ai(TS,ES,e),ai(TS,ES,"esm2020")})();const qj=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Ow,AggregateField:_l,AggregateQuerySnapshot:tP,Bytes:pn,CACHE_SIZE_UNLIMITED:C3,CollectionReference:ar,DocumentReference:Re,DocumentSnapshot:En,FieldPath:$o,FieldValue:Li,Firestore:De,FirestoreError:U,GeoPoint:lr,LoadBundleTask:qR,PersistentCacheIndexManager:gP,Query:kt,QueryCompositeFilterConstraint:Ho,QueryConstraint:ql,QueryDocumentSnapshot:sc,QueryEndAtConstraint:Rh,QueryFieldFilterConstraint:$l,QueryLimitConstraint:xh,QueryOrderByConstraint:cm,QuerySnapshot:In,QueryStartAtConstraint:kh,SnapshotMetadata:Kr,Timestamp:xe,Transaction:fP,VectorValue:Dn,WriteBatch:dP,_AutoId:Bp,_ByteString:at,_DatabaseId:pi,_DocumentKey:H,_EmptyAppCheckTokenProvider:ZF,_EmptyAuthCredentialsProvider:Ix,_FieldPath:Ge,_TestingHooks:zj,_cast:we,_debugAssert:HF,_internalAggregationQueryToProtoRunAggregationQueryRequest:H3,_internalQueryToProtoQueryTarget:G3,_isBase64Available:M4,_logWarn:An,_validateIsNotUsedTogether:Ax,addDoc:Dj,aggregateFieldEqual:oj,aggregateQuerySnapshotEqual:aj,and:X3,arrayRemove:q3,arrayUnion:z3,average:ij,clearIndexedDbPersistence:P3,collection:zR,collectionGroup:S3,connectFirestoreEmulator:BR,count:lP,deleteAllPersistentCacheIndexes:Bj,deleteDoc:Nj,deleteField:j3,disableNetwork:D3,disablePersistentCacheIndexAutoCreation:jj,doc:Ah,documentId:O3,documentSnapshotFromJSON:wj,enableIndexedDbPersistence:k3,enableMultiTabIndexedDbPersistence:R3,enableNetwork:N3,enablePersistentCacheIndexAutoCreation:Uj,endAt:rj,endBefore:nj,ensureFirestoreConfigured:nt,executeWrite:Wl,getAggregateFromServer:uP,getCountFromServer:lj,getDoc:pP,getDocFromCache:xj,getDocFromServer:kj,getDocs:mP,getDocsFromCache:Rj,getDocsFromServer:Pj,getFirestore:$R,getPersistentCacheIndexManager:Fj,increment:$3,initializeFirestore:x3,limit:sP,limitToLast:Z3,loadBundle:ay,memoryEagerGarbageCollector:fj,memoryLocalCache:mj,memoryLruGarbageCollector:pj,namedQuery:HR,onSnapshot:ly,onSnapshotResume:Vj,onSnapshotsInSync:Oj,or:Y3,orderBy:J3,persistentLocalCache:gj,persistentMultipleTabManager:vj,persistentSingleTabManager:cP,query:rP,queryEqual:Cw,querySnapshotFromJSON:Tj,refEqual:A3,runTransaction:Cj,serverTimestamp:B3,setDoc:Fw,setIndexConfiguration:Lj,setLogLevel:GF,snapshotEqual:Ij,startAfter:tj,startAt:ej,sum:sj,terminate:V3,updateDoc:bj,vector:W3,waitForPendingWrites:b3,where:Q3,writeBatch:Mj},Symbol.toStringTag,{value:"Module"})),$j={apiKey:"AIzaSyDYGVS3agiO0z_2nyNGmgdzbNUP9fqt2wk",authDomain:"traumatch-f9171.firebaseapp.com",projectId:"traumatch-f9171",storageBucket:"traumatch-f9171.firebasestorage.app",messagingSenderId:"591979432657",appId:"1:591979432657:web:80693a12a52ee2408c0282",measurementId:"G-GMDD94XG97"},Bw=NC($j),ic=qF(Bw),Ph=$R(Bw),yP=new zr,Wj=Object.freeze(Object.defineProperty({__proto__:null,auth:ic,db:Ph,default:Bw,googleProvider:yP},Symbol.toStringTag,{value:"Module"})),Gj=()=>{const{matches:n,setMatches:e,user:t}=pt.useContext(Jo),[r,s]=pt.useState([]),[i,o]=pt.useState(0),[a,l]=pt.useState(!0),u=ah();pt.useEffect(()=>{(async()=>{if(t){l(!0);try{const g=rP(zR(Ph,"users"),sP(20)),w=await mP(g),E=[];w.forEach(y=>{y.id!==t.uid&&E.push({id:y.id,uid:y.id,...y.data()})}),s(E)}catch(g){console.error("Error fetching matches:",g)}finally{l(!1)}}})()},[t]);const h=i<r.length?r[i]:null,d=(m,g)=>{if(!m||!g)return{score:0,reasons:[]};let w=20,E=[];const y=m.traumas||[],T=g.traumas||[],S=y.filter(P=>T.includes(P));if(m.intent==="match")w+=S.length*20,S.length>0&&E.push(`Shared: ${S[0]}`);else if(m.intent==="complement"){const P=(m.positive||[]).filter(D=>(g.positive||[]).includes(D));w+=P.length*15,S.length===0&&(w+=10),P.length>0&&E.push(`Synchronized: ${P[0]}`)}const N=(m.interests||[]).filter(P=>(g.interests||[]).includes(P));return w+=N.length*10,N.length>0&&E.push(`In Tune: ${N[0]}`),{score:Math.min(Math.round(w),99),reasons:E}},f=m=>{if(t){if(m==="right"){const{score:g,reasons:w}=d(t,h);if(g>30){const y=w.length>0?w[0]:"Mysterious Spark";n.find(T=>T.id===h.id)||(e([...n,{...h,matchReason:y,matchScore:g}]),alert(`Soul Bond Found! Strength: ${g}% - ${y}`))}else alert(`Faded connection (${g}%). Moving on...`)}o(g=>g+1)}};return t?a?V.jsx("div",{className:"page-container",style:{textAlign:"center",justifyContent:"center"},children:V.jsx("div",{className:"animate-pulse",style:{color:"var(--color-secondary)"},children:"Searching the void for matches..."})}):h?V.jsxs("div",{className:"page-container",style:{height:"100%",display:"flex",flexDirection:"column"},children:[V.jsx("h2",{style:{textAlign:"center",color:"var(--color-text)",marginBottom:"1rem",letterSpacing:"2px",textTransform:"uppercase",fontSize:"0.9rem"},children:"Discover Souls"}),V.jsxs("div",{style:{flex:1,width:"100%",backgroundColor:"var(--color-primary)",borderRadius:"20px",overflow:"hidden",position:"relative",boxShadow:"0 15px 35px rgba(0,0,0,0.5)",border:"1px solid rgba(255,255,255,0.05)",display:"flex",flexDirection:"column"},children:[V.jsx("img",{src:h.avatar,alt:h.name,style:{width:"100%",height:"100%",objectFit:"cover",opacity:.9}}),V.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,top:0,background:"linear-gradient(to top, rgba(2,12,27,1) 0%, rgba(2,12,27,0.6) 30%, transparent 100%)"}}),V.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"2rem 1.5rem",color:"white"},children:[V.jsxs("h3",{style:{fontSize:"2rem",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"10px",textShadow:"0 2px 4px rgba(0,0,0,0.5)"},children:[h.name,", ",h.age]}),V.jsxs("p",{style:{fontSize:"1.1rem",opacity:.9,lineHeight:1.4,marginBottom:"1rem"},children:['"',h.bio,'"']}),V.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:V.jsx("span",{style:{fontSize:"0.75rem",padding:"6px 12px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"20px",color:"white",backdropFilter:"blur(5px)"},children:h.positive[0]})})]})]}),V.jsxs("div",{style:{height:"100px",display:"flex",justifyContent:"space-evenly",alignItems:"center",padding:"1rem 0"},children:[V.jsx("button",{onClick:()=>f("left"),className:"icon-btn",style:{width:"70px",height:"70px",backgroundColor:"rgba(255, 68, 68, 0.1)",border:"2px solid #ff4444",color:"#ff4444",boxShadow:"0 5px 20px rgba(255, 68, 68, 0.2)"},children:V.jsx(G2,{size:32})}),V.jsx("button",{onClick:()=>f("right"),className:"icon-btn",style:{width:"70px",height:"70px",backgroundColor:"rgba(100, 255, 218, 0.1)",border:"2px solid var(--color-accent)",color:"var(--color-accent)",boxShadow:"0 5px 20px rgba(100, 255, 218, 0.2)"},children:V.jsx(_C,{size:32})})]})]}):V.jsxs("div",{className:"page-container",style:{textAlign:"center",justifyContent:"center"},children:[V.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:V.jsx(b2,{size:40,color:"var(--color-text-muted)"})}),V.jsx("h2",{children:"The void is quiet."}),V.jsx("p",{style:{color:"var(--color-text-muted)",marginBottom:"2rem"},children:"Check back as more souls enter the sanctuary."}),V.jsx("button",{className:"btn btn-secondary",onClick:()=>o(0),children:"Search Again"})]}):V.jsxs("div",{className:"page-container",style:{textAlign:"center",justifyContent:"center"},children:[V.jsx("p",{children:"Log in to discover waiting souls."}),V.jsx("button",{className:"btn",onClick:()=>u("/auth"),children:"Go to Sanctuary"})]})},vP="14.9.17",xS=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),kS=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),uy=(n,e)=>({startTime:e,type:"setValue",value:n}),wP=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),TP=(n,e,{startTime:t,target:r,timeConstant:s})=>r+(e-r)*Math.exp((t-n)/s),Ca=n=>n.type==="exponentialRampToValue",tp=n=>n.type==="linearRampToValue",Ls=n=>Ca(n)||tp(n),zw=n=>n.type==="setValue",jr=n=>n.type==="setValueCurve",np=(n,e,t,r)=>{const s=n[e];return s===void 0?r:Ls(s)||zw(s)?s.value:jr(s)?s.values[s.values.length-1]:TP(t,np(n,e-1,s.startTime,r),s)},RS=(n,e,t,r,s)=>t===void 0?[r.insertTime,s]:Ls(t)?[t.endTime,t.value]:zw(t)?[t.startTime,t.value]:jr(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,np(n,e-1,t.startTime,s)],cy=n=>n.type==="cancelAndHold",hy=n=>n.type==="cancelScheduledValues",Ds=n=>cy(n)||hy(n)?n.cancelTime:Ca(n)||tp(n)?n.endTime:n.startTime,PS=(n,e,t,{endTime:r,value:s})=>t===s?s:0<t&&0<s||t<0&&s<0?t*(s/t)**((n-e)/(r-e)):0,bS=(n,e,t,{endTime:r,value:s})=>t+(n-e)/(r-e)*(s-t),Hj=(n,e)=>{const t=Math.floor(e),r=Math.ceil(e);return t===r?n[t]:(1-(e-t))*n[t]+(1-(r-e))*n[r]},Kj=(n,{duration:e,startTime:t,values:r})=>{const s=(n-t)/e*(r.length-1);return Hj(r,s)},xd=n=>n.type==="setTarget";class Qj{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Ds(e);if(cy(e)||hy(e)){const r=this._automationEvents.findIndex(i=>hy(e)&&jr(i)?i.startTime+i.duration>=t:Ds(i)>=t),s=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),cy(e)){const i=this._automationEvents[this._automationEvents.length-1];if(s!==void 0&&Ls(s)){if(i!==void 0&&xd(i))throw new Error("The internal list is malformed.");const o=i===void 0?s.insertTime:jr(i)?i.startTime+i.duration:Ds(i),a=i===void 0?this._defaultValue:jr(i)?i.values[i.values.length-1]:i.value,l=Ca(s)?PS(t,o,a,s):bS(t,o,a,s),u=Ca(s)?xS(l,t,this._currenTime):kS(l,t,this._currenTime);this._automationEvents.push(u)}if(i!==void 0&&xd(i)&&this._automationEvents.push(uy(this.getValue(t),t)),i!==void 0&&jr(i)&&i.startTime+i.duration>t){const o=t-i.startTime,a=(i.values.length-1)/i.duration,l=Math.max(2,1+Math.ceil(o*a)),u=o/(l-1)*a,h=i.values.slice(0,l);if(u<1)for(let d=1;d<l;d+=1){const f=u*d%1;h[d]=i.values[d-1]*(1-f)+i.values[d]*f}this._automationEvents[this._automationEvents.length-1]=wP(h,i.startTime,o)}}}else{const r=this._automationEvents.findIndex(o=>Ds(o)>t),s=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(s!==void 0&&jr(s)&&Ds(s)+s.duration>t)return!1;const i=Ca(e)?xS(e.value,e.endTime,this._currenTime):tp(e)?kS(e.value,t,this._currenTime):e;if(r===-1)this._automationEvents.push(i);else{if(jr(e)&&t+e.duration>Ds(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,i)}}return!0}flush(e){const t=this._automationEvents.findIndex(r=>Ds(r)>e);if(t>1){const r=this._automationEvents.slice(t-1),s=r[0];xd(s)&&r.unshift(uy(np(this._automationEvents,t-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(o=>Ds(o)>e),r=this._automationEvents[t],s=(t===-1?this._automationEvents.length:t)-1,i=this._automationEvents[s];if(i!==void 0&&xd(i)&&(r===void 0||!Ls(r)||r.insertTime>e))return TP(e,np(this._automationEvents,s-1,i.startTime,this._defaultValue),i);if(i!==void 0&&zw(i)&&(r===void 0||!Ls(r)))return i.value;if(i!==void 0&&jr(i)&&(r===void 0||!Ls(r)||i.startTime+i.duration>e))return e<i.startTime+i.duration?Kj(e,i):i.values[i.values.length-1];if(i!==void 0&&Ls(i)&&(r===void 0||!Ls(r)))return i.value;if(r!==void 0&&Ca(r)){const[o,a]=RS(this._automationEvents,s,i,r,this._defaultValue);return PS(e,o,a,r)}if(r!==void 0&&tp(r)){const[o,a]=RS(this._automationEvents,s,i,r,this._defaultValue);return bS(e,o,a,r)}return this._defaultValue}}const Yj=n=>({cancelTime:n,type:"cancelAndHold"}),Xj=n=>({cancelTime:n,type:"cancelScheduledValues"}),Jj=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),Zj=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),e6=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),t6=()=>new DOMException("","AbortError"),n6=n=>(e,t,[r,s,i],o)=>{n(e[s],[t,r,i],a=>a[0]===t&&a[1]===r,o)},r6=n=>(e,t,r)=>{const s=[];for(let i=0;i<r.numberOfInputs;i+=1)s.push(new Set);n.set(e,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},s6=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},yl=new WeakSet,EP=new WeakMap,qw=new WeakMap,IP=new WeakMap,$w=new WeakMap,dm=new WeakMap,SP=new WeakMap,dy=new WeakMap,fy=new WeakMap,py=new WeakMap,AP={construct(){return AP}},i6=n=>{try{const e=new Proxy(n,AP);new e}catch{return!1}return!0},NS=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,DS=(n,e)=>{const t=[];let r=n.replace(/^[\s]+/,""),s=r.match(NS);for(;s!==null;){const i=s[1].slice(1,-1),o=s[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,e).toString());t.push(o),r=r.slice(s[0].length).replace(/^[\s]+/,""),s=r.match(NS)}return[t.join(";"),r]},VS=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},OS=n=>{if(!i6(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},o6=(n,e,t,r,s,i,o,a,l,u,h,d,f)=>{let m=0;return(g,w,E={credentials:"omit"})=>{const y=h.get(g);if(y!==void 0&&y.has(w))return Promise.resolve();const T=u.get(g);if(T!==void 0){const P=T.get(w);if(P!==void 0)return P}const S=i(g),N=S.audioWorklet===void 0?s(w).then(([P,D])=>{const[I,v]=DS(P,D),A=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${v}
})})(window,'_AWGS')`;return t(A)}).then(()=>{const P=f._AWGS.pop();if(P===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>P(class{},void 0,(D,I)=>{if(D.trim()==="")throw e();const v=fy.get(S);if(v!==void 0){if(v.has(D))throw e();OS(I),VS(I.parameterDescriptors),v.set(D,I)}else OS(I),VS(I.parameterDescriptors),fy.set(S,new Map([[D,I]]))},S.sampleRate,void 0,void 0))}):Promise.all([s(w),Promise.resolve(n(d,d))]).then(([[P,D],I])=>{const v=m+1;m=v;const[A,x]=DS(P,D),W=`${A};((AudioWorkletProcessor,registerProcessor)=>{${x}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${v}',class extends AudioWorkletProcessor{process(){return !1}})`,se=new Blob([W],{type:"application/javascript; charset=utf-8"}),ee=URL.createObjectURL(se);return S.audioWorklet.addModule(ee,E).then(()=>{if(a(S))return S;const re=o(S);return re.audioWorklet.addModule(ee,E).then(()=>re)}).then(re=>{if(l===null)throw new SyntaxError;try{new l(re,`__sac${v}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(ee))});return T===void 0?u.set(g,new Map([[w,N]])):T.set(w,N),N.then(()=>{const P=h.get(g);P===void 0?h.set(g,new Set([w])):P.add(w)}).finally(()=>{const P=u.get(g);P!==void 0&&P.delete(w)}),N}},dr=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},fm=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return n.delete(r),r},CP=(n,e,t,r)=>{const s=dr(n,e),i=fm(s,o=>o[0]===t&&o[1]===r);return s.size===0&&n.delete(e),i},bh=n=>dr(SP,n),vl=n=>{if(yl.has(n))throw new Error("The AudioNode is already stored.");yl.add(n),bh(n).forEach(e=>e(!0))},xP=n=>"port"in n,Nh=n=>{if(!yl.has(n))throw new Error("The AudioNode is not stored.");yl.delete(n),bh(n).forEach(e=>e(!1))},my=(n,e)=>{!xP(n)&&e.every(t=>t.size===0)&&Nh(n)},a6=(n,e,t,r,s,i,o,a,l,u,h,d,f)=>{const m=new WeakMap;return(g,w,E,y,T)=>{const{activeInputs:S,passiveInputs:N}=i(w),{outputs:P}=i(g),D=a(g),I=v=>{const A=l(w),x=l(g);if(v){const C=CP(N,g,E,y);n(S,g,C,!1),!T&&!d(g)&&t(x,A,E,y),f(w)&&vl(w)}else{const C=r(S,g,E,y);e(N,y,C,!1),!T&&!d(g)&&s(x,A,E,y);const b=o(w);if(b===0)h(w)&&my(w,S);else{const R=m.get(w);R!==void 0&&clearTimeout(R),m.set(w,setTimeout(()=>{h(w)&&my(w,S)},b*1e3))}}};return u(P,[w,E,y],v=>v[0]===w&&v[1]===E&&v[2]===y,!0)?(D.add(I),h(g)?n(S,g,[E,y,I],!0):e(N,y,[g,E,I],!0),!0):!1}},l6=n=>(e,t,[r,s,i],o)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[s,t,i]])):n(a,[s,t,i],l=>l[0]===s&&l[1]===t,o)},u6=n=>(e,t)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);const s=()=>{t.removeEventListener("ended",s),t.disconnect(r),r.disconnect()};t.addEventListener("ended",s)},c6=n=>(e,t)=>{n(e).add(t)},h6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},d6=(n,e,t,r,s,i)=>class extends n{constructor(a,l){const u=s(a),h={...h6,...l},d=r(u,h),f=i(u)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},nn=(n,e)=>n.context===e,f6=(n,e,t)=>()=>{const r=new WeakMap,s=async(i,o)=>{let a=e(i);if(!nn(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=n(o,u)}return r.set(o,a),await t(i,o,a),a};return{render(i,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},rp=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Vr=()=>new DOMException("","IndexSizeError"),Ww=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(r){throw r.code===12?Vr():r}})(n.getChannelData)},p6={numberOfChannels:1},m6=(n,e,t,r,s,i,o,a)=>{let l=null;return class kP{constructor(h){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:m}={...p6,...h};l===null&&(l=new s(1,1,44100));const g=r!==null&&e(i,i)?new r({length:d,numberOfChannels:f,sampleRate:m}):l.createBuffer(f,d,m);if(g.numberOfChannels===0)throw t();return typeof g.copyFromChannel!="function"?(o(g),Ww(g)):e(rp,()=>rp(g))||a(g),n.add(g),g}static[Symbol.hasInstance](h){return h!==null&&typeof h=="object"&&Object.getPrototypeOf(h)===kP.prototype||n.has(h)}}},fn=-34028234663852886e22,on=-fn,Xr=n=>yl.has(n),g6={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},_6=(n,e,t,r,s,i,o,a)=>class extends n{constructor(u,h){const d=i(u),f={...g6,...h},m=s(d,f),g=o(d),w=g?e():null;super(u,!1,m,w),this._audioBufferSourceNodeRenderer=w,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=m,this._onended=null,this._playbackRate=t(this,g,m.playbackRate,on,fn)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(u){if(this._nativeAudioBufferSourceNode.buffer=u,u!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(u){this._nativeAudioBufferSourceNode.loop=u}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(u){this._nativeAudioBufferSourceNode.loopEnd=u}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(u){this._nativeAudioBufferSourceNode.loopStart=u}get onended(){return this._onended}set onended(u){const h=typeof u=="function"?a(this,u):null;this._nativeAudioBufferSourceNode.onended=h;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===h?u:d}get playbackRate(){return this._playbackRate}start(u=0,h=0,d){if(this._nativeAudioBufferSourceNode.start(u,h,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[u,h]:[u,h,d]),this.context.state!=="closed"){vl(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Xr(this)&&Nh(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(u=0){this._nativeAudioBufferSourceNode.stop(u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=u)}},y6=(n,e,t,r,s)=>()=>{const i=new WeakMap;let o=null,a=null;const l=async(u,h)=>{let d=t(u);const f=nn(d,h);if(!f){const m={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(h,m),o!==null&&d.start(...o),a!==null&&d.stop(a)}return i.set(h,d),f?await n(h,u.playbackRate,d.playbackRate):await r(h,u.playbackRate,d.playbackRate),await s(u,h,d),d};return{set start(u){o=u},set stop(u){a=u},render(u,h){const d=i.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},v6=n=>"playbackRate"in n,w6=n=>"frequency"in n&&"gain"in n,T6=n=>"offset"in n,E6=n=>!("frequency"in n)&&"gain"in n,I6=n=>"detune"in n&&"frequency"in n&&!("gain"in n),S6=n=>"pan"in n,an=n=>dr(EP,n),Dh=n=>dr(IP,n),gy=(n,e)=>{const{activeInputs:t}=an(n);t.forEach(s=>s.forEach(([i])=>{e.includes(n)||gy(i,[...e,n])}));const r=v6(n)?[n.playbackRate]:xP(n)?Array.from(n.parameters.values()):w6(n)?[n.Q,n.detune,n.frequency,n.gain]:T6(n)?[n.offset]:E6(n)?[n.gain]:I6(n)?[n.detune,n.frequency]:S6(n)?[n.pan]:[];for(const s of r){const i=Dh(s);i!==void 0&&i.activeInputs.forEach(([o])=>gy(o,e))}Xr(n)&&Nh(n)},RP=n=>{gy(n.destination,[])},A6=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),C6=(n,e,t,r,s,i,o,a,l)=>class extends n{constructor(h={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new l(h)}catch(g){throw g.code===12&&g.message==="sampleRate is not in range"?t():g}if(d===null)throw r();if(!A6(h.latencyHint))throw new TypeError(`The provided value '${h.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(h.sampleRate!==void 0&&d.sampleRate!==h.sampleRate)throw t();super(d,2);const{latencyHint:f}=h,{sampleRate:m}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/m:f==="interactive"||f===void 0?256/m:f==="playback"?1024/m:Math.max(2,Math.min(128,Math.round(f*m/128)))*128/m,this._nativeAudioContext=d,l.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const g=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",g)};d.addEventListener("statechange",g)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),RP(this)}))}createMediaElementSource(h){return new s(this,{mediaElement:h})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(h){return new o(this,{mediaStream:h})}createMediaStreamTrackSource(h){return new a(this,{mediaStreamTrack:h})}resume(){return this._state==="suspended"?new Promise((h,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?h():this.resume().then(h,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(h=>{throw h===void 0||h.code===15?e():h})}suspend(){return this._nativeAudioContext.suspend().catch(h=>{throw h===void 0?e():h})}},x6=(n,e,t,r,s,i,o,a)=>class extends n{constructor(u,h){const d=i(u),f=o(d),m=s(d,h,f),g=f?e(a):null;super(u,!1,m,g),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=m}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(u>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=u}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=u}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},k6=n=>{const e=new WeakMap,t=async(r,s)=>{const i=s.destination;return e.set(s,i),await n(r,s,i),i};return{render(r,s){const i=e.get(s);return i!==void 0?Promise.resolve(i):t(r,s)}}},R6=(n,e,t,r,s,i,o,a)=>(l,u)=>{const h=u.listener,d=()=>{const P=new Float32Array(1),D=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=o(u);let v=!1,A=[0,0,-1,0,1,0],x=[0,0,0];const C=()=>{if(v)return;v=!0;const se=r(u,256,9,0);se.onaudioprocess=({inputBuffer:ee})=>{const re=[i(ee,P,0),i(ee,P,1),i(ee,P,2),i(ee,P,3),i(ee,P,4),i(ee,P,5)];re.some((z,G)=>z!==A[G])&&(h.setOrientation(...re),A=re);const j=[i(ee,P,6),i(ee,P,7),i(ee,P,8)];j.some((z,G)=>z!==x[G])&&(h.setPosition(...j),x=j)},D.connect(se)},b=se=>ee=>{ee!==A[se]&&(A[se]=ee,h.setOrientation(...A))},R=se=>ee=>{ee!==x[se]&&(x[se]=ee,h.setPosition(...x))},W=(se,ee,re)=>{const j=t(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ee});j.connect(D,0,se),j.start(),Object.defineProperty(j.offset,"defaultValue",{get(){return ee}});const z=n({context:l},I,j.offset,on,fn);return a(z,"value",G=>()=>G.call(z),G=>Z=>{try{G.call(z,Z)}catch(le){if(le.code!==9)throw le}C(),I&&re(Z)}),z.cancelAndHoldAtTime=(G=>I?()=>{throw s()}:(...Z)=>{const le=G.apply(z,Z);return C(),le})(z.cancelAndHoldAtTime),z.cancelScheduledValues=(G=>I?()=>{throw s()}:(...Z)=>{const le=G.apply(z,Z);return C(),le})(z.cancelScheduledValues),z.exponentialRampToValueAtTime=(G=>I?()=>{throw s()}:(...Z)=>{const le=G.apply(z,Z);return C(),le})(z.exponentialRampToValueAtTime),z.linearRampToValueAtTime=(G=>I?()=>{throw s()}:(...Z)=>{const le=G.apply(z,Z);return C(),le})(z.linearRampToValueAtTime),z.setTargetAtTime=(G=>I?()=>{throw s()}:(...Z)=>{const le=G.apply(z,Z);return C(),le})(z.setTargetAtTime),z.setValueAtTime=(G=>I?()=>{throw s()}:(...Z)=>{const le=G.apply(z,Z);return C(),le})(z.setValueAtTime),z.setValueCurveAtTime=(G=>I?()=>{throw s()}:(...Z)=>{const le=G.apply(z,Z);return C(),le})(z.setValueCurveAtTime),z};return{forwardX:W(0,0,b(0)),forwardY:W(1,0,b(1)),forwardZ:W(2,-1,b(2)),positionX:W(6,0,R(0)),positionY:W(7,0,R(1)),positionZ:W(8,0,R(2)),upX:W(3,0,b(3)),upY:W(4,1,b(4)),upZ:W(5,0,b(5))}},{forwardX:f,forwardY:m,forwardZ:g,positionX:w,positionY:E,positionZ:y,upX:T,upY:S,upZ:N}=h.forwardX===void 0?d():h;return{get forwardX(){return f},get forwardY(){return m},get forwardZ(){return g},get positionX(){return w},get positionY(){return E},get positionZ(){return y},get upX(){return T},get upY(){return S},get upZ(){return N}}},sp=n=>"context"in n,Vh=n=>sp(n[0]),Ko=(n,e,t,r)=>{for(const s of n)if(t(s)){if(r)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},MS=(n,e,[t,r],s)=>{Ko(n,[e,t,r],i=>i[0]===e&&i[1]===t,s)},LS=(n,[e,t,r],s)=>{const i=n.get(e);i===void 0?n.set(e,new Set([[t,r]])):Ko(i,[t,r],o=>o[0]===t,s)},Gl=n=>"inputs"in n,ip=(n,e,t,r)=>{if(Gl(e)){const s=e.inputs[r];return n.connect(s,t,0),[s,t,0]}return n.connect(e,t,r),[e,t,r]},PP=(n,e,t)=>{for(const r of n)if(r[0]===e&&r[1]===t)return n.delete(r),r;return null},P6=(n,e,t)=>fm(n,r=>r[0]===e&&r[1]===t),bP=(n,e)=>{if(!bh(n).delete(e))throw new Error("Missing the expected event listener.")},NP=(n,e,t)=>{const r=dr(n,e),s=fm(r,i=>i[0]===t);return r.size===0&&n.delete(e),s},op=(n,e,t,r)=>{Gl(e)?n.disconnect(e.inputs[r],t,0):n.disconnect(e,t,r)},Ke=n=>dr(qw,n),zc=n=>dr($w,n),Vo=n=>dy.has(n),rf=n=>!yl.has(n),FS=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const r=n.createScriptProcessor(256,1,1),s=n.createGain(),i=n.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const a=n.createBufferSource();a.buffer=i,a.loop=!0,a.connect(r).connect(n.destination),a.connect(s),a.disconnect(s),r.onaudioprocess=l=>{const u=l.inputBuffer.getChannelData(0);Array.prototype.some.call(u,h=>h===1)?t(!0):t(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(n.destination)},a.start()}}),Rg=(n,e)=>{const t=new Map;for(const r of n)for(const s of r){const i=t.get(s);t.set(s,i===void 0?1:i+1)}t.forEach((r,s)=>e(s,r))},ap=n=>"context"in n,b6=n=>{const e=new Map;n.connect=(t=>(r,s=0,i=0)=>{const o=ap(r)?t(r,s,i):t(r,s),a=e.get(r);return a===void 0?e.set(r,[{input:i,output:s}]):a.every(l=>l.input!==i||l.output!==s)&&a.push({input:i,output:s}),o})(n.connect.bind(n)),n.disconnect=(t=>(r,s,i)=>{if(t.apply(n),r===void 0)e.clear();else if(typeof r=="number")for(const[o,a]of e){const l=a.filter(u=>u.output!==r);l.length===0?e.delete(o):e.set(o,l)}else if(e.has(r))if(s===void 0)e.delete(r);else{const o=e.get(r);if(o!==void 0){const a=o.filter(l=>l.output!==s&&(l.input!==i||i===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[o,a]of e)a.forEach(l=>{ap(o)?n.connect(o,l.output,l.input):n.connect(o,l.output)})})(n.disconnect)},N6=(n,e,t,r)=>{const{activeInputs:s,passiveInputs:i}=Dh(e),{outputs:o}=an(n),a=bh(n),l=u=>{const h=Ke(n),d=zc(e);if(u){const f=NP(i,n,t);MS(s,n,f,!1),!r&&!Vo(n)&&h.connect(d,t)}else{const f=P6(s,n,t);LS(i,f,!1),!r&&!Vo(n)&&h.disconnect(d,t)}};return Ko(o,[e,t],u=>u[0]===e&&u[1]===t,!0)?(a.add(l),Xr(n)?MS(s,n,[t,l],!0):LS(i,[n,t,l],!0),!0):!1},D6=(n,e,t,r)=>{const{activeInputs:s,passiveInputs:i}=an(e),o=PP(s[r],n,t);return o===null?[CP(i,n,t,r)[2],!1]:[o[2],!0]},V6=(n,e,t)=>{const{activeInputs:r,passiveInputs:s}=Dh(e),i=PP(r,n,t);return i===null?[NP(s,n,t)[1],!1]:[i[2],!0]},Gw=(n,e,t,r,s)=>{const[i,o]=D6(n,t,r,s);if(i!==null&&(bP(n,i),o&&!e&&!Vo(n)&&op(Ke(n),Ke(t),r,s)),Xr(t)){const{activeInputs:a}=an(t);my(t,a)}},Hw=(n,e,t,r)=>{const[s,i]=V6(n,t,r);s!==null&&(bP(n,s),i&&!e&&!Vo(n)&&Ke(n).disconnect(zc(t),r))},O6=(n,e)=>{const t=an(n),r=[];for(const s of t.outputs)Vh(s)?Gw(n,e,...s):Hw(n,e,...s),r.push(s[0]);return t.outputs.clear(),r},M6=(n,e,t)=>{const r=an(n),s=[];for(const i of r.outputs)i[1]===t&&(Vh(i)?Gw(n,e,...i):Hw(n,e,...i),s.push(i[0]),r.outputs.delete(i));return s},L6=(n,e,t,r,s)=>{const i=an(n);return Array.from(i.outputs).filter(o=>o[0]===t&&(r===void 0||o[1]===r)&&(s===void 0||o[2]===s)).map(o=>(Vh(o)?Gw(n,e,...o):Hw(n,e,...o),i.outputs.delete(o),o[0]))},F6=(n,e,t,r,s,i,o,a,l,u,h,d,f,m,g,w)=>class extends u{constructor(y,T,S,N){super(S),this._context=y,this._nativeAudioNode=S;const P=h(y);d(P)&&t(FS,()=>FS(P,w))!==!0&&b6(S),qw.set(this,S),SP.set(this,new Set),y.state!=="closed"&&T&&vl(this),n(this,N,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(y){this._nativeAudioNode.channelCount=y}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(y){this._nativeAudioNode.channelCountMode=y}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(y){this._nativeAudioNode.channelInterpretation=y}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(y,T=0,S=0){if(T<0||T>=this._nativeAudioNode.numberOfOutputs)throw s();const N=h(this._context),P=g(N);if(f(y)||m(y))throw i();if(sp(y)){const v=Ke(y);try{const x=ip(this._nativeAudioNode,v,T,S),C=rf(this);(P||C)&&this._nativeAudioNode.disconnect(...x),this.context.state!=="closed"&&!C&&rf(y)&&vl(y)}catch(x){throw x.code===12?i():x}if(e(this,y,T,S,P)){const x=l([this],y);Rg(x,r(P))}return y}const D=zc(y);if(D.name==="playbackRate"&&D.maxValue===1024)throw o();try{this._nativeAudioNode.connect(D,T),(P||rf(this))&&this._nativeAudioNode.disconnect(D,T)}catch(v){throw v.code===12?i():v}if(N6(this,y,T,P)){const v=l([this],y);Rg(v,r(P))}}disconnect(y,T,S){let N;const P=h(this._context),D=g(P);if(y===void 0)N=O6(this,D);else if(typeof y=="number"){if(y<0||y>=this.numberOfOutputs)throw s();N=M6(this,D,y)}else{if(T!==void 0&&(T<0||T>=this.numberOfOutputs)||sp(y)&&S!==void 0&&(S<0||S>=y.numberOfInputs))throw s();if(N=L6(this,D,y,T,S),N.length===0)throw i()}for(const I of N){const v=l([this],I);Rg(v,a)}}},U6=(n,e,t,r,s,i,o,a,l,u,h,d,f)=>(m,g,w,E=null,y=null)=>{const T=w.value,S=new Qj(T),N=g?r(S):null,P={get defaultValue(){return T},get maxValue(){return E===null?w.maxValue:E},get minValue(){return y===null?w.minValue:y},get value(){return w.value},set value(D){w.value=D,P.setValueAtTime(D,m.context.currentTime)},cancelAndHoldAtTime(D){if(typeof w.cancelAndHoldAtTime=="function")N===null&&S.flush(m.context.currentTime),S.add(s(D)),w.cancelAndHoldAtTime(D);else{const I=Array.from(S).pop();N===null&&S.flush(m.context.currentTime),S.add(s(D));const v=Array.from(S).pop();w.cancelScheduledValues(D),I!==v&&v!==void 0&&(v.type==="exponentialRampToValue"?w.exponentialRampToValueAtTime(v.value,v.endTime):v.type==="linearRampToValue"?w.linearRampToValueAtTime(v.value,v.endTime):v.type==="setValue"?w.setValueAtTime(v.value,v.startTime):v.type==="setValueCurve"&&w.setValueCurveAtTime(v.values,v.startTime,v.duration))}return P},cancelScheduledValues(D){return N===null&&S.flush(m.context.currentTime),S.add(i(D)),w.cancelScheduledValues(D),P},exponentialRampToValueAtTime(D,I){if(D===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const v=m.context.currentTime;return N===null&&S.flush(v),Array.from(S).length===0&&(S.add(u(T,v)),w.setValueAtTime(T,v)),S.add(o(D,I)),w.exponentialRampToValueAtTime(D,I),P},linearRampToValueAtTime(D,I){const v=m.context.currentTime;return N===null&&S.flush(v),Array.from(S).length===0&&(S.add(u(T,v)),w.setValueAtTime(T,v)),S.add(a(D,I)),w.linearRampToValueAtTime(D,I),P},setTargetAtTime(D,I,v){return N===null&&S.flush(m.context.currentTime),S.add(l(D,I,v)),w.setTargetAtTime(D,I,v),P},setValueAtTime(D,I){return N===null&&S.flush(m.context.currentTime),S.add(u(D,I)),w.setValueAtTime(D,I),P},setValueCurveAtTime(D,I,v){const A=D instanceof Float32Array?D:new Float32Array(D);if(d!==null&&d.name==="webkitAudioContext"){const x=I+v,C=m.context.sampleRate,b=Math.ceil(I*C),R=Math.floor(x*C),W=R-b,se=new Float32Array(W);for(let re=0;re<W;re+=1){const j=(A.length-1)/v*((b+re)/C-I),z=Math.floor(j),G=Math.ceil(j);se[re]=z===G?A[z]:(1-(j-z))*A[z]+(1-(G-j))*A[G]}N===null&&S.flush(m.context.currentTime),S.add(h(se,I,v)),w.setValueCurveAtTime(se,I,v);const ee=R/C;ee<x&&f(P,se[se.length-1],ee),f(P,A[A.length-1],x)}else N===null&&S.flush(m.context.currentTime),S.add(h(A,I,v)),w.setValueCurveAtTime(A,I,v);return P}};return t.set(P,w),e.set(P,m),n(P,N),P},j6=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:r,value:s}=t;e.exponentialRampToValueAtTime(s,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:s}=t;e.linearRampToValueAtTime(s,r)}else if(t.type==="setTarget"){const{startTime:r,target:s,timeConstant:i}=t;e.setTargetAtTime(s,r,i)}else if(t.type==="setValue"){const{startTime:r,value:s}=t;e.setValueAtTime(s,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:s,values:i}=t;e.setValueCurveAtTime(i,s,r)}else throw new Error("Can't apply an unknown automation.")}});class DP{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,s)=>e.call(t,r,s,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const B6={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},z6=(n,e,t,r,s,i,o,a,l,u,h,d,f,m)=>class extends e{constructor(w,E,y){var T;const S=a(w),N=l(S),P=h({...B6,...y});f(P);const D=fy.get(S),I=D==null?void 0:D.get(E),v=N||S.state!=="closed"?S:(T=o(S))!==null&&T!==void 0?T:S,A=s(v,N?null:w.baseLatency,u,E,I,P),x=N?r(E,P,I):null;super(w,!0,A,x);const C=[];A.parameters.forEach((R,W)=>{const se=t(this,N,R);C.push([W,se])}),this._nativeAudioWorkletNode=A,this._onprocessorerror=null,this._parameters=new DP(C),N&&n(S,this);const{activeInputs:b}=i(this);d(A,b)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(w){const E=typeof w=="function"?m(this,w):null;this._nativeAudioWorkletNode.onprocessorerror=E;const y=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=y!==null&&y===E?w:y}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function lp(n,e,t,r,s){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],r,s);else{const i=n.getChannelData(r);if(e[t].byteLength===0)e[t]=i.slice(s,s+128);else{const o=new Float32Array(i.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(o)}}}const VP=(n,e,t,r,s)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],r,s):e[t].byteLength!==0&&n.getChannelData(r).set(e[t],s)},up=(n,e)=>{const t=[];for(let r=0;r<n;r+=1){const s=[],i=typeof e=="number"?e:e[r];for(let o=0;o<i;o+=1)s.push(new Float32Array(128));t.push(s)}return t},q6=(n,e)=>{const t=dr(py,n),r=Ke(e);return dr(t,r)},$6=async(n,e,t,r,s,i,o)=>{const a=e===null?Math.ceil(n.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,u=s.reduce((E,y)=>E+y,0),h=u===0?null:t.createBuffer(u,a,t.sampleRate);if(i===void 0)throw new Error("Missing the processor constructor.");const d=an(n),f=await q6(t,n),m=up(r.numberOfInputs,r.channelCount),g=up(r.numberOfOutputs,s),w=Array.from(n.parameters.keys()).reduce((E,y)=>({...E,[y]:new Float32Array(128)}),{});for(let E=0;E<a;E+=128){if(r.numberOfInputs>0&&e!==null)for(let y=0;y<r.numberOfInputs;y+=1)for(let T=0;T<r.channelCount;T+=1)lp(e,m[y],T,T,E);i.parameterDescriptors!==void 0&&e!==null&&i.parameterDescriptors.forEach(({name:y},T)=>{lp(e,w,y,l+T,E)});for(let y=0;y<r.numberOfInputs;y+=1)for(let T=0;T<s[y];T+=1)g[y][T].byteLength===0&&(g[y][T]=new Float32Array(128));try{const y=m.map((S,N)=>d.activeInputs[N].size===0?[]:S),T=o(E/t.sampleRate,t.sampleRate,()=>f.process(y,g,w));if(h!==null)for(let S=0,N=0;S<r.numberOfOutputs;S+=1){for(let P=0;P<s[S];P+=1)VP(h,g[S],P,N+P,E);N+=s[S]}if(!T)break}catch(y){n.dispatchEvent(new ErrorEvent("processorerror",{colno:y.colno,filename:y.filename,lineno:y.lineno,message:y.message}));break}}return h},W6=(n,e,t,r,s,i,o,a,l,u,h,d,f,m,g,w)=>(E,y,T)=>{const S=new WeakMap;let N=null;const P=async(D,I)=>{let v=h(D),A=null;const x=nn(v,I),C=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(d===null){const b=C.reduce((ee,re)=>ee+re,0),R=s(I,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),W=[];for(let ee=0;ee<D.numberOfOutputs;ee+=1)W.push(r(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[ee]}));const se=o(I,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1});se.connect=e.bind(null,W),se.disconnect=l.bind(null,W),A=[R,W,se]}else x||(v=new d(I,E));if(S.set(I,A===null?v:A[2]),A!==null){if(N===null){if(T===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const re=D.channelCount*D.numberOfInputs,j=T.parameterDescriptors===void 0?0:T.parameterDescriptors.length,z=re+j;N=$6(D,z===0?null:await(async()=>{const Z=new f(z,Math.ceil(D.context.length/128)*128,I.sampleRate),le=[],dt=[];for(let Ee=0;Ee<y.numberOfInputs;Ee+=1)le.push(o(Z,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),dt.push(s(Z,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const Le=await Promise.all(Array.from(D.parameters.values()).map(async Ee=>{const Qe=i(Z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Ee.value});return await m(Z,Ee,Qe.offset),Qe})),fe=r(Z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,re+j)});for(let Ee=0;Ee<y.numberOfInputs;Ee+=1){le[Ee].connect(dt[Ee]);for(let Qe=0;Qe<y.channelCount;Qe+=1)dt[Ee].connect(fe,Qe,Ee*y.channelCount+Qe)}for(const[Ee,Qe]of Le.entries())Qe.connect(fe,0,re+Ee),Qe.start(0);return fe.connect(Z.destination),await Promise.all(le.map(Ee=>g(D,Z,Ee))),w(Z)})(),I,y,C,T,u)}const b=await N,R=t(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[W,se,ee]=A;b!==null&&(R.buffer=b,R.start(0)),R.connect(W);for(let re=0,j=0;re<D.numberOfOutputs;re+=1){const z=se[re];for(let G=0;G<C[re];G+=1)W.connect(z,j+G,G);j+=C[re]}return ee}if(x)for(const[b,R]of D.parameters.entries())await n(I,R,v.parameters.get(b));else for(const[b,R]of D.parameters.entries())await m(I,R,v.parameters.get(b));return await g(D,I,v),v};return{render(D,I){a(I,D);const v=S.get(I);return v!==void 0?Promise.resolve(v):P(D,I)}}},G6=(n,e,t,r,s,i,o,a,l,u,h,d,f,m,g,w,E,y,T,S)=>class extends g{constructor(P,D){super(P,D),this._nativeContext=P,this._audioWorklet=n===void 0?void 0:{addModule:(I,v)=>n(this,I,v)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(P,D,I){return new t({length:D,numberOfChannels:P,sampleRate:I})}createBufferSource(){return new r(this)}createChannelMerger(P=6){return new i(this,{numberOfInputs:P})}createChannelSplitter(P=6){return new o(this,{numberOfOutputs:P})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(P=1){return new h(this,{maxDelayTime:P})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(P,D){return new m(this,{feedback:D,feedforward:P})}createOscillator(){return new w(this)}createPanner(){return new E(this)}createPeriodicWave(P,D,I={disableNormalization:!1}){return new y(this,{...I,imag:D,real:P})}createStereoPanner(){return new T(this)}createWaveShaper(){return new S(this)}decodeAudioData(P,D,I){return u(this._nativeContext,P).then(v=>(typeof D=="function"&&D(v),v),v=>{throw typeof I=="function"&&I(v),v})}},H6={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},K6=(n,e,t,r,s,i,o,a)=>class extends n{constructor(u,h){const d=i(u),f={...H6,...h},m=s(d,f),g=o(d),w=g?t():null;super(u,!1,m,w),this._Q=e(this,g,m.Q,on,fn),this._detune=e(this,g,m.detune,1200*Math.log2(on),-1200*Math.log2(on)),this._frequency=e(this,g,m.frequency,u.sampleRate/2,0),this._gain=e(this,g,m.gain,40*Math.log10(on),fn),this._nativeBiquadFilterNode=m,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(u){this._nativeBiquadFilterNode.type=u}getFrequencyResponse(u,h,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(u,h,d)}catch(f){throw f.code===11?r():f}if(u.length!==h.length||h.length!==d.length)throw r()}},Q6=(n,e,t,r,s)=>()=>{const i=new WeakMap,o=async(a,l)=>{let u=t(a);const h=nn(u,l);if(!h){const d={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=e(l,d)}return i.set(l,u),h?(await n(l,a.Q,u.Q),await n(l,a.detune,u.detune),await n(l,a.frequency,u.frequency),await n(l,a.gain,u.gain)):(await r(l,a.Q,u.Q),await r(l,a.detune,u.detune),await r(l,a.frequency,u.frequency),await r(l,a.gain,u.gain)),await s(a,l,u),u};return{render(a,l){const u=i.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Y6=(n,e)=>(t,r)=>{const s=e.get(t);if(s!==void 0)return s;const i=n.get(t);if(i!==void 0)return i;try{const o=r();return o instanceof Promise?(n.set(t,o),o.catch(()=>!1).then(a=>(n.delete(t),e.set(t,a),a))):(e.set(t,o),o)}catch{return e.set(t,!1),!1}},X6={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},J6=(n,e,t,r,s)=>class extends n{constructor(o,a){const l=r(o),u={...X6,...a},h=t(l,u),d=s(l)?e():null;super(o,!1,h,d)}},Z6=(n,e,t)=>()=>{const r=new WeakMap,s=async(i,o)=>{let a=e(i);if(!nn(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=n(o,u)}return r.set(o,a),await t(i,o,a),a};return{render(i,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},eB={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},tB=(n,e,t,r,s,i)=>class extends n{constructor(a,l){const u=r(a),h=i({...eB,...l}),d=t(u,h),f=s(u)?e():null;super(a,!1,d,f)}},nB=(n,e,t)=>()=>{const r=new WeakMap,s=async(i,o)=>{let a=e(i);if(!nn(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=n(o,u)}return r.set(o,a),await t(i,o,a),a};return{render(i,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},rB=n=>(e,t,r)=>n(t,e,r),sB=n=>(e,t,r=0,s=0)=>{const i=e[r];if(i===void 0)throw n();return ap(t)?i.connect(t,0,s):i.connect(t,0)},iB=n=>(e,t)=>{const r=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return r.buffer=s,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},oB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},aB=(n,e,t,r,s,i,o)=>class extends n{constructor(l,u){const h=s(l),d={...oB,...u},f=r(h,d),m=i(h),g=m?t():null;super(l,!1,f,g),this._constantSourceNodeRenderer=g,this._nativeConstantSourceNode=f,this._offset=e(this,m,f.offset,on,fn),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeConstantSourceNode.onended=u;const h=this._nativeConstantSourceNode.onended;this._onended=h!==null&&h===u?l:h}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){vl(this);const u=()=>{this._nativeConstantSourceNode.removeEventListener("ended",u),Xr(this)&&Nh(this)};this._nativeConstantSourceNode.addEventListener("ended",u)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},lB=(n,e,t,r,s)=>()=>{const i=new WeakMap;let o=null,a=null;const l=async(u,h)=>{let d=t(u);const f=nn(d,h);if(!f){const m={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(h,m),o!==null&&d.start(o),a!==null&&d.stop(a)}return i.set(h,d),f?await n(h,u.offset,d.offset):await r(h,u.offset,d.offset),await s(u,h,d),d};return{set start(u){o=u},set stop(u){a=u},render(u,h){const d=i.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},uB=n=>e=>(n[0]=e,n[0]),cB={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},hB=(n,e,t,r,s,i)=>class extends n{constructor(a,l){const u=r(a),h={...cB,...l},d=t(u,h),m=s(u)?e():null;super(a,!1,d,m),this._isBufferNullified=!1,this._nativeConvolverNode=d,h.buffer!==null&&i(this,h.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},dB=(n,e,t)=>()=>{const r=new WeakMap,s=async(i,o)=>{let a=e(i);if(!nn(a,o)){const u={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=n(o,u)}return r.set(o,a),Gl(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},fB=(n,e)=>(t,r,s)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,r,s)}catch(i){throw i.name==="SyntaxError"?n():i}},pB=()=>new DOMException("","DataCloneError"),US=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{const s=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>s();try{e.postMessage(n,[n])}catch{}finally{s()}})},mB=(n,e,t,r,s,i,o,a,l,u,h)=>(d,f)=>{const m=o(d)?d:i(d);if(s.has(f)){const g=t();return Promise.reject(g)}try{s.add(f)}catch{}return e(l,()=>l(m))?m.decodeAudioData(f).then(g=>(US(f).catch(()=>{}),e(a,()=>a(g))||h(g),n.add(g),g)):new Promise((g,w)=>{const E=async()=>{try{await US(f)}catch{}},y=T=>{w(T),E()};try{m.decodeAudioData(f,T=>{typeof T.copyFromChannel!="function"&&(u(T),Ww(T)),n.add(T),E().then(()=>g(T))},T=>{y(T===null?r():T)})}catch(T){y(T)}})},gB=(n,e,t,r,s,i,o,a)=>(l,u)=>{const h=e.get(l);if(h===void 0)throw new Error("Missing the expected cycle count.");const d=i(l.context),f=a(d);if(h===u){if(e.delete(l),!f&&o(l)){const m=r(l),{outputs:g}=t(l);for(const w of g)if(Vh(w)){const E=r(w[0]);n(m,E,w[1],w[2])}else{const E=s(w[0]);m.connect(E,w[1])}}}else e.set(l,h-u)},_B={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},yB=(n,e,t,r,s,i,o)=>class extends n{constructor(l,u){const h=s(l),d={..._B,...u},f=r(h,d),m=i(h),g=m?t(d.maxDelayTime):null;super(l,!1,f,g),this._delayTime=e(this,m,f.delayTime),o(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},vB=(n,e,t,r,s)=>i=>{const o=new WeakMap,a=async(l,u)=>{let h=t(l);const d=nn(h,u);if(!d){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:i};h=e(u,f)}return o.set(u,h),d?await n(u,l.delayTime,h.delayTime):await r(u,l.delayTime,h.delayTime),await s(l,u,h),h};return{render(l,u){const h=o.get(u);return h!==void 0?Promise.resolve(h):a(l,u)}}},wB=n=>(e,t,r,s)=>n(e[s],i=>i[0]===t&&i[1]===r),TB=n=>(e,t)=>{n(e).delete(t)},EB=n=>"delayTime"in n,IB=(n,e,t)=>function r(s,i){const o=sp(i)?i:t(n,i);if(EB(o))return[];if(s[0]===o)return[s];if(s.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(l=>r([...s,o],l[0])).reduce((l,u)=>l.concat(u),[])},kd=(n,e,t)=>{const r=e[t];if(r===void 0)throw n();return r},SB=n=>(e,t=void 0,r=void 0,s=0)=>t===void 0?e.forEach(i=>i.disconnect()):typeof t=="number"?kd(n,e,t).disconnect():ap(t)?r===void 0?e.forEach(i=>i.disconnect(t)):s===void 0?kd(n,e,r).disconnect(t,0):kd(n,e,r).disconnect(t,0,s):r===void 0?e.forEach(i=>i.disconnect(t)):kd(n,e,r).disconnect(t,0),AB={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},CB=(n,e,t,r,s,i,o,a)=>class extends n{constructor(u,h){const d=i(u),f={...AB,...h},m=r(d,f),g=o(d),w=g?t():null;super(u,!1,m,w),this._attack=e(this,g,m.attack),this._knee=e(this,g,m.knee),this._nativeDynamicsCompressorNode=m,this._ratio=e(this,g,m.ratio),this._release=e(this,g,m.release),this._threshold=e(this,g,m.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(u){const h=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=u,u>2)throw this._nativeDynamicsCompressorNode.channelCount=h,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(u){const h=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=u,u==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=h,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},xB=(n,e,t,r,s)=>()=>{const i=new WeakMap,o=async(a,l)=>{let u=t(a);const h=nn(u,l);if(!h){const d={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=e(l,d)}return i.set(l,u),h?(await n(l,a.attack,u.attack),await n(l,a.knee,u.knee),await n(l,a.ratio,u.ratio),await n(l,a.release,u.release),await n(l,a.threshold,u.threshold)):(await r(l,a.attack,u.attack),await r(l,a.knee,u.knee),await r(l,a.ratio,u.ratio),await r(l,a.release,u.release),await r(l,a.threshold,u.threshold)),await s(a,l,u),u};return{render(a,l){const u=i.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},kB=()=>new DOMException("","EncodingError"),RB=n=>e=>new Promise((t,r)=>{if(n===null){r(new SyntaxError);return}const s=n.document.head;if(s===null)r(new SyntaxError);else{const i=n.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),l=n.onerror,u=()=>{n.onerror=l,URL.revokeObjectURL(a)};n.onerror=(h,d,f,m,g)=>{if(d===a||d===n.location.href&&f===1&&m===1)return u(),r(g),!1;if(l!==null)return l(h,d,f,m,g)},i.onerror=()=>{u(),r(new SyntaxError)},i.onload=()=>{u(),t()},i.src=a,i.type="module",s.appendChild(i)}}),PB=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,s){if(r!==null){let i=this._listeners.get(r);i===void 0&&(i=n(this,r),typeof r=="function"&&this._listeners.set(r,i)),this._nativeEventTarget.addEventListener(t,i,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,s){const i=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,i===void 0?null:i,s)}},bB=n=>(e,t,r)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},NB=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},DB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},VB=(n,e,t,r,s,i)=>class extends n{constructor(a,l){const u=s(a),h={...DB,...l},d=r(u,h),f=i(u),m=f?t():null;super(a,!1,d,m),this._gain=e(this,f,d.gain,on,fn)}get gain(){return this._gain}},OB=(n,e,t,r,s)=>()=>{const i=new WeakMap,o=async(a,l)=>{let u=t(a);const h=nn(u,l);if(!h){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=e(l,d)}return i.set(l,u),h?await n(l,a.gain,u.gain):await r(l,a.gain,u.gain),await s(a,l,u),u};return{render(a,l){const u=i.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},MB=(n,e)=>t=>e(n,t),LB=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},FB=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},UB=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},jB=n=>e=>n.get(e),jt=()=>new DOMException("","InvalidStateError"),BB=n=>e=>{const t=n.get(e);if(t===void 0)throw jt();return t},zB=(n,e)=>t=>{let r=n.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),n.set(t,r),r},qB=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},pm=()=>new DOMException("","InvalidAccessError"),$B=n=>{n.getFrequencyResponse=(e=>(t,r,s)=>{if(t.length!==r.length||r.length!==s.length)throw pm();return e.call(n,t,r,s)})(n.getFrequencyResponse)},WB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},GB=(n,e,t,r,s,i)=>class extends n{constructor(a,l){const u=r(a),h=s(u),d={...WB,...l},f=e(u,h?null:a.baseLatency,d),m=h?t(d.feedback,d.feedforward):null;super(a,!1,f,m),$B(f),this._nativeIIRFilterNode=f,i(this,1)}getFrequencyResponse(a,l,u){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,u)}},OP=(n,e,t,r,s,i,o,a,l,u,h)=>{const d=u.length;let f=a;for(let m=0;m<d;m+=1){let g=t[0]*u[m];for(let w=1;w<s;w+=1){const E=f-w&l-1;g+=t[w]*i[E],g-=n[w]*o[E]}for(let w=s;w<r;w+=1)g+=t[w]*i[f-w&l-1];for(let w=s;w<e;w+=1)g-=n[w]*o[f-w&l-1];i[f]=u[m],o[f]=g,f=f+1&l-1,h[m]=g}return f},HB=(n,e,t,r)=>{const s=t instanceof Float64Array?t:new Float64Array(t),i=r instanceof Float64Array?r:new Float64Array(r),o=s.length,a=i.length,l=Math.min(o,a);if(s[0]!==1){for(let g=0;g<o;g+=1)i[g]/=s[0];for(let g=1;g<a;g+=1)s[g]/=s[0]}const u=32,h=new Float32Array(u),d=new Float32Array(u),f=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),m=n.numberOfChannels;for(let g=0;g<m;g+=1){const w=n.getChannelData(g),E=f.getChannelData(g);h.fill(0),d.fill(0),OP(s,o,i,a,l,h,d,0,u,w,E)}return f},KB=(n,e,t,r,s)=>(i,o)=>{const a=new WeakMap;let l=null;const u=async(h,d)=>{let f=null,m=e(h);const g=nn(m,d);if(d.createIIRFilter===void 0?f=n(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):g||(m=d.createIIRFilter(o,i)),a.set(d,f===null?m:f),f!==null){if(l===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const E=new t(h.context.destination.channelCount,h.context.length,d.sampleRate);l=(async()=>{await r(h,E,E.destination);const y=await s(E);return HB(y,d,i,o)})()}const w=await l;return f.buffer=w,f.start(0),f}return await r(h,d,m),m};return{render(h,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):u(h,d)}}},QB=(n,e,t,r,s,i)=>o=>(a,l)=>{const u=n.get(a);if(u===void 0){if(!o&&i(a)){const h=r(a),{outputs:d}=t(a);for(const f of d)if(Vh(f)){const m=r(f[0]);e(h,m,f[1],f[2])}else{const m=s(f[0]);h.disconnect(m,f[1])}}n.set(a,l)}else n.set(a,u+l)},YB=(n,e)=>t=>{const r=n.get(t);return e(r)||e(t)},XB=(n,e)=>t=>n.has(t)||e(t),JB=(n,e)=>t=>n.has(t)||e(t),ZB=(n,e)=>t=>{const r=n.get(t);return e(r)||e(t)},e9=n=>e=>n!==null&&e instanceof n,t9=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,n9=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,r9=(n,e)=>t=>n(t)||e(t),s9=n=>e=>n!==null&&e instanceof n,i9=n=>n!==null&&n.isSecureContext,o9=(n,e,t,r)=>class extends n{constructor(i,o){const a=t(i),l=e(a,o);if(r(a))throw TypeError();super(i,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},a9={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},l9=(n,e,t,r)=>class extends n{constructor(i,o){const a=t(i);if(r(a))throw new TypeError;const l={...a9,...o},u=e(a,l);super(i,!1,u,null),this._nativeMediaStreamAudioDestinationNode=u}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},u9=(n,e,t,r)=>class extends n{constructor(i,o){const a=t(i),l=e(a,o);if(r(a))throw new TypeError;super(i,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},c9=(n,e,t)=>class extends n{constructor(s,i){const o=t(s),a=e(o,i);super(s,!0,a,null)}},h9=(n,e,t,r,s,i)=>class extends t{constructor(a,l){super(a),this._nativeContext=a,dm.set(this,a),r(a)&&s.set(a,new Set),this._destination=new n(this,l),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?i(this,a):null;this._nativeContext.onstatechange=l;const u=this._nativeContext.onstatechange;this._onstatechange=u!==null&&u===l?a:u}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},qc=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},d9=(n,e)=>(t,r,s)=>{const i=new Set;return t.connect=(o=>(a,l=0,u=0)=>{const h=i.size===0;if(e(a))return o.call(t,a,l,u),n(i,[a,l,u],d=>d[0]===a&&d[1]===l&&d[2]===u,!0),h&&r(),a;o.call(t,a,l),n(i,[a,l],d=>d[0]===a&&d[1]===l,!0),h&&r()})(t.connect),t.disconnect=(o=>(a,l,u)=>{const h=i.size>0;if(a===void 0)o.apply(t),i.clear();else if(typeof a=="number"){o.call(t,a);for(const f of i)f[1]===a&&i.delete(f)}else{e(a)?o.call(t,a,l,u):o.call(t,a,l);for(const f of i)f[0]===a&&(l===void 0||f[1]===l)&&(u===void 0||f[2]===u)&&i.delete(f)}const d=i.size===0;h&&d&&s()})(t.disconnect),t},Je=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t]&&(n[t]=r)},Rt=(n,e)=>{Je(n,e,"channelCount"),Je(n,e,"channelCountMode"),Je(n,e,"channelInterpretation")},jS=n=>typeof n.getFloatTimeDomainData=="function",f9=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const r=Math.max(t.length,n.fftSize);for(let s=0;s<r;s+=1)e[s]=(t[s]-128)*.0078125;return e}},p9=(n,e)=>(t,r)=>{const s=t.createAnalyser();if(Rt(s,r),!(r.maxDecibels>r.minDecibels))throw e();return Je(s,r,"fftSize"),Je(s,r,"maxDecibels"),Je(s,r,"minDecibels"),Je(s,r,"smoothingTimeConstant"),n(jS,()=>jS(s))||f9(s),s},m9=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,ht=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t].value&&(n[t].value=r)},g9=n=>{n.start=(e=>{let t=!1;return(r=0,s=0,i)=>{if(t)throw jt();e.call(n,r,s,i),t=!0}})(n.start)},Kw=n=>{n.start=(e=>(t=0,r=0,s)=>{if(typeof s=="number"&&s<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,r,s)})(n.start)},Qw=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},_9=(n,e,t,r,s,i,o,a,l,u,h)=>(d,f)=>{const m=d.createBufferSource();return Rt(m,f),ht(m,f,"playbackRate"),Je(m,f,"buffer"),Je(m,f,"loop"),Je(m,f,"loopEnd"),Je(m,f,"loopStart"),e(t,()=>t(d))||g9(m),e(r,()=>r(d))||l(m),e(s,()=>s(d))||u(m,d),e(i,()=>i(d))||Kw(m),e(o,()=>o(d))||h(m,d),e(a,()=>a(d))||Qw(m),n(d,m),m},y9=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,v9=(n,e)=>(t,r,s)=>{const i=t.destination;if(i.channelCount!==r)try{i.channelCount=r}catch{}s&&i.channelCountMode!=="explicit"&&(i.channelCountMode="explicit"),i.maxChannelCount===0&&Object.defineProperty(i,"maxChannelCount",{value:r});const o=n(t,{channelCount:r,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>l=>{a.call(o,l);try{i.channelCount=l}catch(u){if(l>i.maxChannelCount)throw u}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>l=>{a.call(o,l),i.channelCountMode=l}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>l=>{a.call(o,l),i.channelInterpretation=l}),Object.defineProperty(o,"maxChannelCount",{get:()=>i.maxChannelCount}),o.connect(i),o},w9=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,T9=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},E9=(n,e,t,r,s)=>(i,o,a,l,u,h)=>{if(a!==null)try{const d=new a(i,l,h),f=new Map;let m=null;if(Object.defineProperties(d,{channelCount:{get:()=>h.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>m,set:g=>{typeof m=="function"&&d.removeEventListener("processorerror",m),m=typeof g=="function"?g:null,typeof m=="function"&&d.addEventListener("processorerror",m)}}}),d.addEventListener=(g=>(...w)=>{if(w[0]==="processorerror"){const E=typeof w[1]=="function"?w[1]:typeof w[1]=="object"&&w[1]!==null&&typeof w[1].handleEvent=="function"?w[1].handleEvent:null;if(E!==null){const y=f.get(w[1]);y!==void 0?w[1]=y:(w[1]=T=>{T.type==="error"?(Object.defineProperties(T,{type:{value:"processorerror"}}),E(T)):E(new ErrorEvent(w[0],{...T}))},f.set(E,w[1]))}}return g.call(d,"error",w[1],w[2]),g.call(d,...w)})(d.addEventListener),d.removeEventListener=(g=>(...w)=>{if(w[0]==="processorerror"){const E=f.get(w[1]);E!==void 0&&(f.delete(w[1]),w[1]=E)}return g.call(d,"error",w[1],w[2]),g.call(d,w[0],w[1],w[2])})(d.removeEventListener),h.numberOfOutputs!==0){const g=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(g).connect(i.destination),s(d,()=>g.disconnect(),()=>g.connect(i.destination))}return d}catch(d){throw d.code===11?r():d}if(u===void 0)throw r();return T9(h),e(i,o,u,h)},MP=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),I9=n=>new Promise((e,t)=>{const{port1:r,port2:s}=new MessageChannel;r.onmessage=({data:i})=>{r.close(),s.close(),e(i)},r.onmessageerror=({data:i})=>{r.close(),s.close(),t(i)},s.postMessage(n)}),S9=async(n,e)=>{const t=await I9(e);return new n(t)},A9=(n,e,t,r)=>{let s=py.get(n);s===void 0&&(s=new WeakMap,py.set(n,s));const i=S9(t,r);return s.set(e,i),i},C9=(n,e,t,r,s,i,o,a,l,u,h,d,f)=>(m,g,w,E)=>{if(E.numberOfInputs===0&&E.numberOfOutputs===0)throw l();const y=Array.isArray(E.outputChannelCount)?E.outputChannelCount:Array.from(E.outputChannelCount);if(y.some(J=>J<1))throw l();if(y.length!==E.numberOfOutputs)throw e();if(E.channelCountMode!=="explicit")throw l();const T=E.channelCount*E.numberOfInputs,S=y.reduce((J,ae)=>J+ae,0),N=w.parameterDescriptors===void 0?0:w.parameterDescriptors.length;if(T+N>6||S>6)throw l();const P=new MessageChannel,D=[],I=[];for(let J=0;J<E.numberOfInputs;J+=1)D.push(o(m,{channelCount:E.channelCount,channelCountMode:E.channelCountMode,channelInterpretation:E.channelInterpretation,gain:1})),I.push(s(m,{channelCount:E.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:E.channelCount}));const v=[];if(w.parameterDescriptors!==void 0)for(const{defaultValue:J,maxValue:ae,minValue:rt,name:Fe}of w.parameterDescriptors){const he=i(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:E.parameterData[Fe]!==void 0?E.parameterData[Fe]:J===void 0?0:J});Object.defineProperties(he.offset,{defaultValue:{get:()=>J===void 0?0:J},maxValue:{get:()=>ae===void 0?on:ae},minValue:{get:()=>rt===void 0?fn:rt}}),v.push(he)}const A=r(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,T+N)}),x=MP(g,m.sampleRate),C=a(m,x,T+N,Math.max(1,S)),b=s(m,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),R=[];for(let J=0;J<E.numberOfOutputs;J+=1)R.push(r(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[J]}));for(let J=0;J<E.numberOfInputs;J+=1){D[J].connect(I[J]);for(let ae=0;ae<E.channelCount;ae+=1)I[J].connect(A,ae,J*E.channelCount+ae)}const W=new DP(w.parameterDescriptors===void 0?[]:w.parameterDescriptors.map(({name:J},ae)=>{const rt=v[ae];return rt.connect(A,0,T+ae),rt.start(0),[J,rt.offset]}));A.connect(C);let se=E.channelInterpretation,ee=null;const re=E.numberOfOutputs===0?[C]:R,j={get bufferSize(){return x},get channelCount(){return E.channelCount},set channelCount(J){throw t()},get channelCountMode(){return E.channelCountMode},set channelCountMode(J){throw t()},get channelInterpretation(){return se},set channelInterpretation(J){for(const ae of D)ae.channelInterpretation=J;se=J},get context(){return C.context},get inputs(){return D},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get onprocessorerror(){return ee},set onprocessorerror(J){typeof ee=="function"&&j.removeEventListener("processorerror",ee),ee=typeof J=="function"?J:null,typeof ee=="function"&&j.addEventListener("processorerror",ee)},get parameters(){return W},get port(){return P.port2},addEventListener(...J){return C.addEventListener(J[0],J[1],J[2])},connect:n.bind(null,re),disconnect:u.bind(null,re),dispatchEvent(...J){return C.dispatchEvent(J[0])},removeEventListener(...J){return C.removeEventListener(J[0],J[1],J[2])}},z=new Map;P.port1.addEventListener=(J=>(...ae)=>{if(ae[0]==="message"){const rt=typeof ae[1]=="function"?ae[1]:typeof ae[1]=="object"&&ae[1]!==null&&typeof ae[1].handleEvent=="function"?ae[1].handleEvent:null;if(rt!==null){const Fe=z.get(ae[1]);Fe!==void 0?ae[1]=Fe:(ae[1]=he=>{h(m.currentTime,m.sampleRate,()=>rt(he))},z.set(rt,ae[1]))}}return J.call(P.port1,ae[0],ae[1],ae[2])})(P.port1.addEventListener),P.port1.removeEventListener=(J=>(...ae)=>{if(ae[0]==="message"){const rt=z.get(ae[1]);rt!==void 0&&(z.delete(ae[1]),ae[1]=rt)}return J.call(P.port1,ae[0],ae[1],ae[2])})(P.port1.removeEventListener);let G=null;Object.defineProperty(P.port1,"onmessage",{get:()=>G,set:J=>{typeof G=="function"&&P.port1.removeEventListener("message",G),G=typeof J=="function"?J:null,typeof G=="function"&&(P.port1.addEventListener("message",G),P.port1.start())}}),w.prototype.port=P.port1;let Z=null;A9(m,j,w,E).then(J=>Z=J);const dt=up(E.numberOfInputs,E.channelCount),Le=up(E.numberOfOutputs,y),fe=w.parameterDescriptors===void 0?[]:w.parameterDescriptors.reduce((J,{name:ae})=>({...J,[ae]:new Float32Array(128)}),{});let Ee=!0;const Qe=()=>{E.numberOfOutputs>0&&C.disconnect(b);for(let J=0,ae=0;J<E.numberOfOutputs;J+=1){const rt=R[J];for(let Fe=0;Fe<y[J];Fe+=1)b.disconnect(rt,ae+Fe,Fe);ae+=y[J]}},oe=new Map;C.onaudioprocess=({inputBuffer:J,outputBuffer:ae})=>{if(Z!==null){const rt=d(j);for(let Fe=0;Fe<x;Fe+=128){for(let he=0;he<E.numberOfInputs;he+=1)for(let ye=0;ye<E.channelCount;ye+=1)lp(J,dt[he],ye,ye,Fe);w.parameterDescriptors!==void 0&&w.parameterDescriptors.forEach(({name:he},ye)=>{lp(J,fe,he,T+ye,Fe)});for(let he=0;he<E.numberOfInputs;he+=1)for(let ye=0;ye<y[he];ye+=1)Le[he][ye].byteLength===0&&(Le[he][ye]=new Float32Array(128));try{const he=dt.map((zt,_r)=>{if(rt[_r].size>0)return oe.set(_r,x/128),zt;const Jl=oe.get(_r);return Jl===void 0?[]:(zt.every(Bi=>Bi.every(zh=>zh===0))&&(Jl===1?oe.delete(_r):oe.set(_r,Jl-1)),zt)});Ee=h(m.currentTime+Fe/m.sampleRate,m.sampleRate,()=>Z.process(he,Le,fe));for(let zt=0,_r=0;zt<E.numberOfOutputs;zt+=1){for(let Ts=0;Ts<y[zt];Ts+=1)VP(ae,Le[zt],Ts,_r+Ts,Fe);_r+=y[zt]}}catch(he){Ee=!1,j.dispatchEvent(new ErrorEvent("processorerror",{colno:he.colno,filename:he.filename,lineno:he.lineno,message:he.message}))}if(!Ee){for(let he=0;he<E.numberOfInputs;he+=1){D[he].disconnect(I[he]);for(let ye=0;ye<E.channelCount;ye+=1)I[Fe].disconnect(A,ye,he*E.channelCount+ye)}if(w.parameterDescriptors!==void 0){const he=w.parameterDescriptors.length;for(let ye=0;ye<he;ye+=1){const zt=v[ye];zt.disconnect(A,0,T+ye),zt.stop()}}A.disconnect(C),C.onaudioprocess=null,gr?Qe():Fr();break}}}};let gr=!1;const Lr=o(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ws=()=>C.connect(Lr).connect(m.destination),Fr=()=>{C.disconnect(Lr),Lr.disconnect()},Xl=()=>{if(Ee){Fr(),E.numberOfOutputs>0&&C.connect(b);for(let J=0,ae=0;J<E.numberOfOutputs;J+=1){const rt=R[J];for(let Fe=0;Fe<y[J];Fe+=1)b.connect(rt,ae+Fe,Fe);ae+=y[J]}}gr=!0},Bh=()=>{Ee&&(ws(),Qe()),gr=!1};return ws(),f(j,Xl,Bh)},LP=(n,e)=>{const t=n.createBiquadFilter();return Rt(t,e),ht(t,e,"Q"),ht(t,e,"detune"),ht(t,e,"frequency"),ht(t,e,"gain"),Je(t,e,"type"),t},x9=(n,e)=>(t,r)=>{const s=t.createChannelMerger(r.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,s),Rt(s,r),s},k9=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw jt()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw jt()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw jt()}})},Oh=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return Rt(t,e),k9(t),t},R9=(n,e,t,r,s)=>(i,o)=>{if(i.createConstantSource===void 0)return t(i,o);const a=i.createConstantSource();return Rt(a,o),ht(a,o,"offset"),e(r,()=>r(i))||Kw(a),e(s,()=>s(i))||Qw(a),n(i,a),a},Hl=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),P9=(n,e,t,r)=>(s,{offset:i,...o})=>{const a=s.createBuffer(1,2,44100),l=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=t(s,{...o,gain:i}),h=a.getChannelData(0);h[0]=1,h[1]=1,l.buffer=a,l.loop=!0;const d={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(g){u.channelCount=g},get channelCountMode(){return u.channelCountMode},set channelCountMode(g){u.channelCountMode=g},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(g){u.channelInterpretation=g},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return l.onended},set onended(g){l.onended=g},addEventListener(...g){return l.addEventListener(g[0],g[1],g[2])},dispatchEvent(...g){return l.dispatchEvent(g[0])},removeEventListener(...g){return l.removeEventListener(g[0],g[1],g[2])},start(g=0){l.start.call(l,g)},stop(g=0){l.stop.call(l,g)}},f=()=>l.connect(u),m=()=>l.disconnect(u);return n(s,l),r(Hl(d,u),f,m)},b9=(n,e)=>(t,r)=>{const s=t.createConvolver();if(Rt(s,r),r.disableNormalization===s.normalize&&(s.normalize=!r.disableNormalization),Je(s,r,"buffer"),r.channelCount>2||(e(s,"channelCount",i=>()=>i.call(s),i=>o=>{if(o>2)throw n();return i.call(s,o)}),r.channelCountMode==="max"))throw n();return e(s,"channelCountMode",i=>()=>i.call(s),i=>o=>{if(o==="max")throw n();return i.call(s,o)}),s},FP=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return Rt(t,e),ht(t,e,"delayTime"),t},N9=n=>(e,t)=>{const r=e.createDynamicsCompressor();if(Rt(r,t),t.channelCount>2||t.channelCountMode==="max")throw n();return ht(r,t,"attack"),ht(r,t,"knee"),ht(r,t,"ratio"),ht(r,t,"release"),ht(r,t,"threshold"),r},Cn=(n,e)=>{const t=n.createGain();return Rt(t,e),ht(t,e,"gain"),t},D9=n=>(e,t,r)=>{if(e.createIIRFilter===void 0)return n(e,t,r);const s=e.createIIRFilter(r.feedforward,r.feedback);return Rt(s,r),s};function V9(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function O9(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function BS(n,e){let t=[0,0];for(let r=n.length-1;r>=0;r-=1)t=O9(t,e),t[0]+=n[r];return t}const M9=(n,e,t,r)=>(s,i,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:u,feedforward:h})=>{const d=MP(i,s.sampleRate),f=u instanceof Float64Array?u:new Float64Array(u),m=h instanceof Float64Array?h:new Float64Array(h),g=f.length,w=m.length,E=Math.min(g,w);if(g===0||g>20)throw r();if(f[0]===0)throw e();if(w===0||w>20)throw r();if(m[0]===0)throw e();if(f[0]!==1){for(let v=0;v<w;v+=1)m[v]/=f[0];for(let v=1;v<g;v+=1)f[v]/=f[0]}const y=t(s,d,o,o);y.channelCount=o,y.channelCountMode=a,y.channelInterpretation=l;const T=32,S=[],N=[],P=[];for(let v=0;v<o;v+=1){S.push(0);const A=new Float32Array(T),x=new Float32Array(T);A.fill(0),x.fill(0),N.push(A),P.push(x)}y.onaudioprocess=v=>{const A=v.inputBuffer,x=v.outputBuffer,C=A.numberOfChannels;for(let b=0;b<C;b+=1){const R=A.getChannelData(b),W=x.getChannelData(b);S[b]=OP(f,g,m,w,E,N[b],P[b],S[b],T,R,W)}};const D=s.sampleRate/2;return Hl({get bufferSize(){return d},get channelCount(){return y.channelCount},set channelCount(v){y.channelCount=v},get channelCountMode(){return y.channelCountMode},set channelCountMode(v){y.channelCountMode=v},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(v){y.channelInterpretation=v},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(...v){return y.addEventListener(v[0],v[1],v[2])},dispatchEvent(...v){return y.dispatchEvent(v[0])},getFrequencyResponse(v,A,x){if(v.length!==A.length||A.length!==x.length)throw n();const C=v.length;for(let b=0;b<C;b+=1){const R=-Math.PI*(v[b]/D),W=[Math.cos(R),Math.sin(R)],se=BS(m,W),ee=BS(f,W),re=V9(se,ee);A[b]=Math.sqrt(re[0]*re[0]+re[1]*re[1]),x[b]=Math.atan2(re[1],re[0])}},removeEventListener(...v){return y.removeEventListener(v[0],v[1],v[2])}},y)},L9=(n,e)=>n.createMediaElementSource(e.mediaElement),F9=(n,e)=>{const t=n.createMediaStreamDestination();return Rt(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},U9=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((i,o)=>i.id<o.id?-1:i.id>o.id?1:0);const r=t.slice(0,1),s=n.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(s,"mediaStream",{value:e}),s},j9=(n,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const s=new MediaStream([r]),i=t.createMediaStreamSource(s);if(r.kind!=="audio")throw n();if(e(t))throw new TypeError;return i},B9=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,z9=(n,e,t,r,s,i)=>(o,a)=>{const l=o.createOscillator();return Rt(l,a),ht(l,a,"detune"),ht(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):Je(l,a,"type"),e(t,()=>t(o))||Kw(l),e(r,()=>r(o))||i(l,o),e(s,()=>s(o))||Qw(l),n(o,l),l},q9=n=>(e,t)=>{const r=e.createPanner();return r.orientationX===void 0?n(e,t):(Rt(r,t),ht(r,t,"orientationX"),ht(r,t,"orientationY"),ht(r,t,"orientationZ"),ht(r,t,"positionX"),ht(r,t,"positionY"),ht(r,t,"positionZ"),Je(r,t,"coneInnerAngle"),Je(r,t,"coneOuterAngle"),Je(r,t,"coneOuterGain"),Je(r,t,"distanceModel"),Je(r,t,"maxDistance"),Je(r,t,"panningModel"),Je(r,t,"refDistance"),Je(r,t,"rolloffFactor"),r)},$9=(n,e,t,r,s,i,o,a,l,u)=>(h,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:m,distanceModel:g,maxDistance:w,orientationX:E,orientationY:y,orientationZ:T,panningModel:S,positionX:N,positionY:P,positionZ:D,refDistance:I,rolloffFactor:v,...A})=>{const x=h.createPanner();if(A.channelCount>2||A.channelCountMode==="max")throw o();Rt(x,A);const C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},b=t(h,{...C,channelInterpretation:"speakers",numberOfInputs:6}),R=r(h,{...A,gain:1}),W=r(h,{...C,gain:1}),se=r(h,{...C,gain:0}),ee=r(h,{...C,gain:0}),re=r(h,{...C,gain:0}),j=r(h,{...C,gain:0}),z=r(h,{...C,gain:0}),G=s(h,256,6,1),Z=i(h,{...C,curve:new Float32Array([1,1]),oversample:"none"});let le=[E,y,T],dt=[N,P,D];const Le=new Float32Array(1);G.onaudioprocess=({inputBuffer:oe})=>{const gr=[l(oe,Le,0),l(oe,Le,1),l(oe,Le,2)];gr.some((ws,Fr)=>ws!==le[Fr])&&(x.setOrientation(...gr),le=gr);const Lr=[l(oe,Le,3),l(oe,Le,4),l(oe,Le,5)];Lr.some((ws,Fr)=>ws!==dt[Fr])&&(x.setPosition(...Lr),dt=Lr)},Object.defineProperty(se.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0}),Object.defineProperty(re.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0});const fe={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount(oe){if(oe>2)throw o();R.channelCount=oe,x.channelCount=oe},get channelCountMode(){return x.channelCountMode},set channelCountMode(oe){if(oe==="max")throw o();R.channelCountMode=oe,x.channelCountMode=oe},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation(oe){R.channelInterpretation=oe,x.channelInterpretation=oe},get coneInnerAngle(){return x.coneInnerAngle},set coneInnerAngle(oe){x.coneInnerAngle=oe},get coneOuterAngle(){return x.coneOuterAngle},set coneOuterAngle(oe){x.coneOuterAngle=oe},get coneOuterGain(){return x.coneOuterGain},set coneOuterGain(oe){if(oe<0||oe>1)throw e();x.coneOuterGain=oe},get context(){return x.context},get distanceModel(){return x.distanceModel},set distanceModel(oe){x.distanceModel=oe},get inputs(){return[R]},get maxDistance(){return x.maxDistance},set maxDistance(oe){if(oe<0)throw new RangeError;x.maxDistance=oe},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get orientationX(){return W.gain},get orientationY(){return se.gain},get orientationZ(){return ee.gain},get panningModel(){return x.panningModel},set panningModel(oe){x.panningModel=oe},get positionX(){return re.gain},get positionY(){return j.gain},get positionZ(){return z.gain},get refDistance(){return x.refDistance},set refDistance(oe){if(oe<0)throw new RangeError;x.refDistance=oe},get rolloffFactor(){return x.rolloffFactor},set rolloffFactor(oe){if(oe<0)throw new RangeError;x.rolloffFactor=oe},addEventListener(...oe){return R.addEventListener(oe[0],oe[1],oe[2])},dispatchEvent(...oe){return R.dispatchEvent(oe[0])},removeEventListener(...oe){return R.removeEventListener(oe[0],oe[1],oe[2])}};d!==fe.coneInnerAngle&&(fe.coneInnerAngle=d),f!==fe.coneOuterAngle&&(fe.coneOuterAngle=f),m!==fe.coneOuterGain&&(fe.coneOuterGain=m),g!==fe.distanceModel&&(fe.distanceModel=g),w!==fe.maxDistance&&(fe.maxDistance=w),E!==fe.orientationX.value&&(fe.orientationX.value=E),y!==fe.orientationY.value&&(fe.orientationY.value=y),T!==fe.orientationZ.value&&(fe.orientationZ.value=T),S!==fe.panningModel&&(fe.panningModel=S),N!==fe.positionX.value&&(fe.positionX.value=N),P!==fe.positionY.value&&(fe.positionY.value=P),D!==fe.positionZ.value&&(fe.positionZ.value=D),I!==fe.refDistance&&(fe.refDistance=I),v!==fe.rolloffFactor&&(fe.rolloffFactor=v),(le[0]!==1||le[1]!==0||le[2]!==0)&&x.setOrientation(...le),(dt[0]!==0||dt[1]!==0||dt[2]!==0)&&x.setPosition(...dt);const Ee=()=>{R.connect(x),n(R,Z,0,0),Z.connect(W).connect(b,0,0),Z.connect(se).connect(b,0,1),Z.connect(ee).connect(b,0,2),Z.connect(re).connect(b,0,3),Z.connect(j).connect(b,0,4),Z.connect(z).connect(b,0,5),b.connect(G).connect(h.destination)},Qe=()=>{R.disconnect(x),a(R,Z,0,0),Z.disconnect(W),W.disconnect(b),Z.disconnect(se),se.disconnect(b),Z.disconnect(ee),ee.disconnect(b),Z.disconnect(re),re.disconnect(b),Z.disconnect(j),j.disconnect(b),Z.disconnect(z),z.disconnect(b),b.disconnect(G),G.disconnect(h.destination)};return u(Hl(fe,x),Ee,Qe)},W9=n=>(e,{disableNormalization:t,imag:r,real:s})=>{const i=r instanceof Float32Array?r:new Float32Array(r),o=s instanceof Float32Array?s:new Float32Array(s),a=e.createPeriodicWave(o,i,{disableNormalization:t});if(Array.from(r).length<2)throw n();return a},Mh=(n,e,t,r)=>n.createScriptProcessor(e,t,r),G9=(n,e)=>(t,r)=>{const s=r.channelCountMode;if(s==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,r);const i=t.createStereoPanner();return Rt(i,r),ht(i,r,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>s,set:o=>{if(o!==s)throw e()}}),i},H9=(n,e,t,r,s,i)=>{const a=new Float32Array([1,1]),l=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...u,oversample:"none"},d=(g,w,E,y)=>{const T=new Float32Array(16385),S=new Float32Array(16385);for(let A=0;A<16385;A+=1){const x=A/16384*l;T[A]=Math.cos(x),S[A]=Math.sin(x)}const N=t(g,{...u,gain:0}),P=r(g,{...h,curve:T}),D=r(g,{...h,curve:a}),I=t(g,{...u,gain:0}),v=r(g,{...h,curve:S});return{connectGraph(){w.connect(N),w.connect(D.inputs===void 0?D:D.inputs[0]),w.connect(I),D.connect(E),E.connect(P.inputs===void 0?P:P.inputs[0]),E.connect(v.inputs===void 0?v:v.inputs[0]),P.connect(N.gain),v.connect(I.gain),N.connect(y,0,0),I.connect(y,0,1)},disconnectGraph(){w.disconnect(N),w.disconnect(D.inputs===void 0?D:D.inputs[0]),w.disconnect(I),D.disconnect(E),E.disconnect(P.inputs===void 0?P:P.inputs[0]),E.disconnect(v.inputs===void 0?v:v.inputs[0]),P.disconnect(N.gain),v.disconnect(I.gain),N.disconnect(y,0,0),I.disconnect(y,0,1)}}},f=(g,w,E,y)=>{const T=new Float32Array(16385),S=new Float32Array(16385),N=new Float32Array(16385),P=new Float32Array(16385),D=Math.floor(16385/2);for(let re=0;re<16385;re+=1)if(re>D){const j=(re-D)/(16384-D)*l;T[re]=Math.cos(j),S[re]=Math.sin(j),N[re]=0,P[re]=1}else{const j=re/(16384-D)*l;T[re]=1,S[re]=0,N[re]=Math.cos(j),P[re]=Math.sin(j)}const I=e(g,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=t(g,{...u,gain:0}),A=r(g,{...h,curve:T}),x=t(g,{...u,gain:0}),C=r(g,{...h,curve:S}),b=r(g,{...h,curve:a}),R=t(g,{...u,gain:0}),W=r(g,{...h,curve:N}),se=t(g,{...u,gain:0}),ee=r(g,{...h,curve:P});return{connectGraph(){w.connect(I),w.connect(b.inputs===void 0?b:b.inputs[0]),I.connect(v,0),I.connect(x,0),I.connect(R,1),I.connect(se,1),b.connect(E),E.connect(A.inputs===void 0?A:A.inputs[0]),E.connect(C.inputs===void 0?C:C.inputs[0]),E.connect(W.inputs===void 0?W:W.inputs[0]),E.connect(ee.inputs===void 0?ee:ee.inputs[0]),A.connect(v.gain),C.connect(x.gain),W.connect(R.gain),ee.connect(se.gain),v.connect(y,0,0),R.connect(y,0,0),x.connect(y,0,1),se.connect(y,0,1)},disconnectGraph(){w.disconnect(I),w.disconnect(b.inputs===void 0?b:b.inputs[0]),I.disconnect(v,0),I.disconnect(x,0),I.disconnect(R,1),I.disconnect(se,1),b.disconnect(E),E.disconnect(A.inputs===void 0?A:A.inputs[0]),E.disconnect(C.inputs===void 0?C:C.inputs[0]),E.disconnect(W.inputs===void 0?W:W.inputs[0]),E.disconnect(ee.inputs===void 0?ee:ee.inputs[0]),A.disconnect(v.gain),C.disconnect(x.gain),W.disconnect(R.gain),ee.disconnect(se.gain),v.disconnect(y,0,0),R.disconnect(y,0,0),x.disconnect(y,0,1),se.disconnect(y,0,1)}}},m=(g,w,E,y,T)=>{if(w===1)return d(g,E,y,T);if(w===2)return f(g,E,y,T);throw s()};return(g,{channelCount:w,channelCountMode:E,pan:y,...T})=>{if(E==="max")throw s();const S=n(g,{...T,channelCount:1,channelCountMode:E,numberOfInputs:2}),N=t(g,{...T,channelCount:w,channelCountMode:E,gain:1}),P=t(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:y});let{connectGraph:D,disconnectGraph:I}=m(g,w,N,P,S);Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"maxValue",{get:()=>1}),Object.defineProperty(P.gain,"minValue",{get:()=>-1});const v={get bufferSize(){},get channelCount(){return N.channelCount},set channelCount(b){N.channelCount!==b&&(A&&I(),{connectGraph:D,disconnectGraph:I}=m(g,b,N,P,S),A&&D()),N.channelCount=b},get channelCountMode(){return N.channelCountMode},set channelCountMode(b){if(b==="clamped-max"||b==="max")throw s();N.channelCountMode=b},get channelInterpretation(){return N.channelInterpretation},set channelInterpretation(b){N.channelInterpretation=b},get context(){return N.context},get inputs(){return[N]},get numberOfInputs(){return N.numberOfInputs},get numberOfOutputs(){return N.numberOfOutputs},get pan(){return P.gain},addEventListener(...b){return N.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return N.dispatchEvent(b[0])},removeEventListener(...b){return N.removeEventListener(b[0],b[1],b[2])}};let A=!1;const x=()=>{D(),A=!0},C=()=>{I(),A=!1};return i(Hl(v,S),x,C)}},K9=(n,e,t,r,s,i,o)=>(a,l)=>{const u=a.createWaveShaper();if(i!==null&&i.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,l);Rt(u,l);const h=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(h!==null&&h.length<2)throw e();Je(u,{curve:h},"curve"),Je(u,l,"oversample");let d=null,f=!1;return o(u,"curve",w=>()=>w.call(u),w=>E=>(w.call(u,E),f&&(r(E)&&d===null?d=n(a,u):!r(E)&&d!==null&&(d(),d=null)),E)),s(u,()=>{f=!0,r(u.curve)&&(d=n(a,u))},()=>{f=!1,d!==null&&(d(),d=null)})},Q9=(n,e,t,r,s)=>(i,{curve:o,oversample:a,...l})=>{const u=i.createWaveShaper(),h=i.createWaveShaper();Rt(u,l),Rt(h,l);const d=t(i,{...l,gain:1}),f=t(i,{...l,gain:-1}),m=t(i,{...l,gain:1}),g=t(i,{...l,gain:-1});let w=null,E=!1,y=null;const T={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(P){d.channelCount=P,f.channelCount=P,u.channelCount=P,m.channelCount=P,h.channelCount=P,g.channelCount=P},get channelCountMode(){return u.channelCountMode},set channelCountMode(P){d.channelCountMode=P,f.channelCountMode=P,u.channelCountMode=P,m.channelCountMode=P,h.channelCountMode=P,g.channelCountMode=P},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(P){d.channelInterpretation=P,f.channelInterpretation=P,u.channelInterpretation=P,m.channelInterpretation=P,h.channelInterpretation=P,g.channelInterpretation=P},get context(){return u.context},get curve(){return y},set curve(P){if(P!==null&&P.length<2)throw e();if(P===null)u.curve=P,h.curve=P;else{const D=P.length,I=new Float32Array(D+2-D%2),v=new Float32Array(D+2-D%2);I[0]=P[0],v[0]=-P[D-1];const A=Math.ceil((D+1)/2),x=(D+1)/2-1;for(let C=1;C<A;C+=1){const b=C/A*x,R=Math.floor(b),W=Math.ceil(b);I[C]=R===W?P[R]:(1-(b-R))*P[R]+(1-(W-b))*P[W],v[C]=R===W?-P[D-1-R]:-((1-(b-R))*P[D-1-R])-(1-(W-b))*P[D-1-W]}I[A]=D%2===1?P[A-1]:(P[A-2]+P[A-1])/2,u.curve=I,h.curve=v}y=P,E&&(r(y)&&w===null?w=n(i,d):w!==null&&(w(),w=null))},get inputs(){return[d]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(P){u.oversample=P,h.oversample=P},addEventListener(...P){return d.addEventListener(P[0],P[1],P[2])},dispatchEvent(...P){return d.dispatchEvent(P[0])},removeEventListener(...P){return d.removeEventListener(P[0],P[1],P[2])}};o!==null&&(T.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==T.oversample&&(T.oversample=a);const S=()=>{d.connect(u).connect(m),d.connect(f).connect(h).connect(g).connect(m),E=!0,r(y)&&(w=n(i,d))},N=()=>{d.disconnect(u),u.disconnect(m),d.disconnect(f),f.disconnect(h),h.disconnect(g),g.disconnect(m),E=!1,w!==null&&(w(),w=null)};return s(Hl(T,m),S,N)},hn=()=>new DOMException("","NotSupportedError"),Y9={numberOfChannels:1},X9=(n,e,t,r,s)=>class extends n{constructor(o,a,l){let u;if(typeof o=="number"&&a!==void 0&&l!==void 0)u={length:a,numberOfChannels:o,sampleRate:l};else if(typeof o=="object")u=o;else throw new Error("The given parameters are not valid.");const{length:h,numberOfChannels:d,sampleRate:f}={...Y9,...u},m=r(d,h,f);e(qc,()=>qc(m))||m.addEventListener("statechange",(()=>{let g=0;const w=E=>{this._state==="running"&&(g>0?(m.removeEventListener("statechange",w),E.stopImmediatePropagation(),this._waitForThePromiseToSettle(E)):g+=1)};return w})()),super(m,d),this._length=h,this._nativeOfflineAudioContext=m,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,RP(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},J9={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Z9=(n,e,t,r,s,i,o)=>class extends n{constructor(l,u){const h=s(l),d={...J9,...u},f=t(h,d),m=i(h),g=m?r():null,w=l.sampleRate/2;super(l,!1,f,g),this._detune=e(this,m,f.detune,153600,-153600),this._frequency=e(this,m,f.frequency,w,-w),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=g,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeOscillatorNode.onended=u;const h=this._nativeOscillatorNode.onended;this._onended=h!==null&&h===u?l:h}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){vl(this);const u=()=>{this._nativeOscillatorNode.removeEventListener("ended",u),Xr(this)&&Nh(this)};this._nativeOscillatorNode.addEventListener("ended",u)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},ez=(n,e,t,r,s)=>()=>{const i=new WeakMap;let o=null,a=null,l=null;const u=async(h,d)=>{let f=t(h);const m=nn(f,d);if(!m){const g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=e(d,g),a!==null&&f.start(a),l!==null&&f.stop(l)}return i.set(d,f),m?(await n(d,h.detune,f.detune),await n(d,h.frequency,f.frequency)):(await r(d,h.detune,f.detune),await r(d,h.frequency,f.frequency)),await s(h,d,f),f};return{set periodicWave(h){o=h},set start(h){a=h},set stop(h){l=h},render(h,d){const f=i.get(d);return f!==void 0?Promise.resolve(f):u(h,d)}}},tz={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},nz=(n,e,t,r,s,i,o)=>class extends n{constructor(l,u){const h=s(l),d={...tz,...u},f=t(h,d),m=i(h),g=m?r():null;super(l,!1,f,g),this._nativePannerNode=f,this._orientationX=e(this,m,f.orientationX,on,fn),this._orientationY=e(this,m,f.orientationY,on,fn),this._orientationZ=e(this,m,f.orientationZ,on,fn),this._positionX=e(this,m,f.positionX,on,fn),this._positionY=e(this,m,f.positionY,on,fn),this._positionZ=e(this,m,f.positionZ,on,fn),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},rz=(n,e,t,r,s,i,o,a,l,u)=>()=>{const h=new WeakMap;let d=null;const f=async(m,g)=>{let w=null,E=i(m);const y={channelCount:E.channelCount,channelCountMode:E.channelCountMode,channelInterpretation:E.channelInterpretation},T={...y,coneInnerAngle:E.coneInnerAngle,coneOuterAngle:E.coneOuterAngle,coneOuterGain:E.coneOuterGain,distanceModel:E.distanceModel,maxDistance:E.maxDistance,panningModel:E.panningModel,refDistance:E.refDistance,rolloffFactor:E.rolloffFactor},S=nn(E,g);if("bufferSize"in E)w=r(g,{...y,gain:1});else if(!S){const N={...T,orientationX:E.orientationX.value,orientationY:E.orientationY.value,orientationZ:E.orientationZ.value,positionX:E.positionX.value,positionY:E.positionY.value,positionZ:E.positionZ.value};E=s(g,N)}if(h.set(g,w===null?E:w),w!==null){if(d===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new o(6,m.context.length,g.sampleRate),b=e(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});b.connect(C.destination),d=(async()=>{const R=await Promise.all([m.orientationX,m.orientationY,m.orientationZ,m.positionX,m.positionY,m.positionZ].map(async(W,se)=>{const ee=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:se===0?1:0});return await a(C,W,ee.offset),ee}));for(let W=0;W<6;W+=1)R[W].connect(b,0,W),R[W].start(0);return u(C)})()}const N=await d,P=r(g,{...y,gain:1});await l(m,g,P);const D=[];for(let C=0;C<N.numberOfChannels;C+=1)D.push(N.getChannelData(C));let I=[D[0][0],D[1][0],D[2][0]],v=[D[3][0],D[4][0],D[5][0]],A=r(g,{...y,gain:1}),x=s(g,{...T,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:v[0],positionY:v[1],positionZ:v[2]});P.connect(A).connect(x.inputs[0]),x.connect(w);for(let C=128;C<N.length;C+=128){const b=[D[0][C],D[1][C],D[2][C]],R=[D[3][C],D[4][C],D[5][C]];if(b.some((W,se)=>W!==I[se])||R.some((W,se)=>W!==v[se])){I=b,v=R;const W=C/g.sampleRate;A.gain.setValueAtTime(0,W),A=r(g,{...y,gain:0}),x=s(g,{...T,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:v[0],positionY:v[1],positionZ:v[2]}),A.gain.setValueAtTime(1,W),P.connect(A).connect(x.inputs[0]),x.connect(w)}}return w}return S?(await n(g,m.orientationX,E.orientationX),await n(g,m.orientationY,E.orientationY),await n(g,m.orientationZ,E.orientationZ),await n(g,m.positionX,E.positionX),await n(g,m.positionY,E.positionY),await n(g,m.positionZ,E.positionZ)):(await a(g,m.orientationX,E.orientationX),await a(g,m.orientationY,E.orientationY),await a(g,m.orientationZ,E.orientationZ),await a(g,m.positionX,E.positionX),await a(g,m.positionY,E.positionY),await a(g,m.positionZ,E.positionZ)),Gl(E)?await l(m,g,E.inputs[0]):await l(m,g,E),E};return{render(m,g){const w=h.get(g);return w!==void 0?Promise.resolve(w):f(m,g)}}},sz={disableNormalization:!1},iz=(n,e,t,r)=>class UP{constructor(i,o){const a=e(i),l=r({...sz,...o}),u=n(a,l);return t.add(u),u}static[Symbol.hasInstance](i){return i!==null&&typeof i=="object"&&Object.getPrototypeOf(i)===UP.prototype||t.has(i)}},oz=(n,e)=>(t,r,s)=>(n(r).replay(s),e(r,t,s)),az=(n,e,t)=>async(r,s,i)=>{const o=n(r);await Promise.all(o.activeInputs.map((a,l)=>Array.from(a).map(async([u,h])=>{const f=await e(u).render(u,s),m=r.context.destination;!t(u)&&(r!==m||!t(r))&&f.connect(i,h,l)})).reduce((a,l)=>[...a,...l],[]))},lz=(n,e,t)=>async(r,s,i)=>{const o=e(r);await Promise.all(Array.from(o.activeInputs).map(async([a,l])=>{const h=await n(a).render(a,s);t(a)||h.connect(i,l)}))},uz=(n,e,t,r)=>s=>n(qc,()=>qc(s))?Promise.resolve(n(r,r)).then(i=>{if(!i){const o=t(s,512,0,1);s.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>s.currentTime,o.connect(s.destination)}return s.startRendering()}):new Promise(i=>{const o=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=a=>{o.disconnect(),i(a.renderedBuffer)},o.connect(s.destination),s.startRendering()}),cz=n=>(e,t)=>{n.set(e,t)},hz=n=>(e,t)=>n.set(e,t),dz=(n,e,t,r,s,i,o,a)=>(l,u)=>t(l).render(l,u).then(()=>Promise.all(Array.from(r(u)).map(h=>t(h).render(h,u)))).then(()=>s(u)).then(h=>(typeof h.copyFromChannel!="function"?(o(h),Ww(h)):e(i,()=>i(h))||a(h),n.add(h),h)),fz={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},pz=(n,e,t,r,s,i)=>class extends n{constructor(a,l){const u=s(a),h={...fz,...l},d=t(u,h),f=i(u),m=f?r():null;super(a,!1,d,m),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},mz=(n,e,t,r,s)=>()=>{const i=new WeakMap,o=async(a,l)=>{let u=t(a);const h=nn(u,l);if(!h){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=e(l,d)}return i.set(l,u),h?await n(l,a.pan,u.pan):await r(l,a.pan,u.pan),Gl(u)?await s(a,l,u.inputs[0]):await s(a,l,u),u};return{render(a,l){const u=i.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},gz=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},_z=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),s=URL.createObjectURL(t);let i=!1,o=!1;try{await r.audioWorklet.addModule(s);const a=new n(r,"a",{numberOfOutputs:0}),l=r.createOscillator();a.port.onmessage=()=>i=!0,a.onprocessorerror=()=>o=!0,l.connect(a),l.start(0),await r.startRendering(),await new Promise(u=>setTimeout(u))}catch{}finally{URL.revokeObjectURL(s)}return i&&!o},yz=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{t.oncomplete=()=>{r.disconnect(),s(t.currentTime!==0)},t.startRendering()})},vz=()=>new DOMException("","UnknownError"),wz={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Tz=(n,e,t,r,s,i,o)=>class extends n{constructor(l,u){const h=s(l),d={...wz,...u},f=t(h,d),g=i(h)?r():null;super(l,!0,f,g),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},Ez=(n,e,t)=>()=>{const r=new WeakMap,s=async(i,o)=>{let a=e(i);if(!nn(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=n(o,u)}return r.set(o,a),Gl(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},Iz=()=>typeof window>"u"?null:window,Sz=(n,e)=>t=>{t.copyFromChannel=(r,s,i=0)=>{const o=n(i),a=n(s);if(a>=t.numberOfChannels)throw e();const l=t.length,u=t.getChannelData(a),h=r.length;for(let d=o<0?-o:0;d+o<l&&d<h;d+=1)r[d]=u[d+o]},t.copyToChannel=(r,s,i=0)=>{const o=n(i),a=n(s);if(a>=t.numberOfChannels)throw e();const l=t.length,u=t.getChannelData(a),h=r.length;for(let d=o<0?-o:0;d+o<l&&d<h;d+=1)u[d+o]=r[d]}},Az=n=>e=>{e.copyFromChannel=(t=>(r,s,i=0)=>{const o=n(i),a=n(s);if(o<e.length)return t.call(e,r,a,o)})(e.copyFromChannel),e.copyToChannel=(t=>(r,s,i=0)=>{const o=n(i),a=n(s);if(o<e.length)return t.call(e,r,a,o)})(e.copyToChannel)},Cz=n=>(e,t)=>{const r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),n(e,"buffer",s=>()=>{const i=s.call(e);return i===r?null:i},s=>i=>s.call(e,i===null?r:i))},xz=(n,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const s=t.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let l=0;l<a;l+=1)s.connect(r,0,l)},()=>s.disconnect(r))},jP=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),BP=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},Lh=(n,e,t,r)=>{let s=n;for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:i,set:o}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(n,e,{get:t(i),set:r(o)})},kz=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),Rz=n=>({...n,channelCount:n.numberOfOutputs}),Pz=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},zP=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;zP(n,e,t+1e-7)}},bz=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},Nz=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},Dz=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},Yw=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},qP=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Xw=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Vz=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},Oz=n=>{n.start=(e=>(t=0,r=0,s)=>{const i=n.buffer,o=i===null?r:Math.min(i.duration,r);i!==null&&o>i.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,o,s)})(n.start)},$P=(n,e)=>{const t=e.createGain();n.connect(t);const r=(s=>()=>{s.call(n,t),n.removeEventListener("ended",r)})(n.disconnect);n.addEventListener("ended",r),Hl(n,t),n.stop=(s=>{let i=!1;return(o=0)=>{if(i)try{s.call(n,o)}catch{t.gain.setValueAtTime(0,o)}else s.call(n,o),i=!0}})(n.stop)},Kl=(n,e)=>t=>{const r={value:n};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},Mz=n6(Ko),Lz=l6(Ko),Fz=wB(fm),WP=new WeakMap,Uz=FB(WP),fr=Y6(new Map,new WeakMap),Dr=Iz(),GP=p9(fr,Vr),Jw=LB(an),Ht=az(an,Jw,Vo),jz=f6(GP,Ke,Ht),Be=BB(dm),_s=B9(Dr),Ve=s9(_s),HP=new WeakMap,KP=PB(Kl),Fh=y9(Dr),Zw=e9(Fh),eT=t9(Dr),QP=n9(Dr),$c=w9(Dr),wt=F6(r6(EP),a6(Mz,Lz,ip,Fz,op,an,Uz,bh,Ke,Ko,Xr,Vo,rf),fr,QB(dy,op,an,Ke,zc,Xr),Vr,pm,hn,gB(ip,dy,an,Ke,zc,Be,Xr,Ve),IB(HP,an,dr),KP,Be,Zw,eT,QP,Ve,$c),Bz=d6(wt,jz,Vr,GP,Be,Ve),tT=new WeakSet,zS=m9(Dr),YP=uB(new Uint32Array(1)),nT=Sz(YP,Vr),rT=Az(YP),XP=m6(tT,fr,hn,zS,_s,gz(zS),nT,rT),mm=u6(Cn),JP=lz(Jw,Dh,Vo),Or=rB(JP),Ql=_9(mm,fr,bz,Nz,Dz,Yw,qP,Xw,Oz,Cz(Lh),$P),Mr=oz(UB(Dh),JP),zz=y6(Or,Ql,Ke,Mr,Ht),pr=U6(s6(IP),HP,$w,j6,Yj,Xj,Jj,Zj,e6,uy,wP,Fh,zP),qz=_6(wt,zz,pr,jt,Ql,Be,Ve,Kl),$z=x6(wt,k6,Vr,jt,v9(Cn,Lh),Be,Ve,Ht),Wz=Q6(Or,LP,Ke,Mr,Ht),Qo=hz(WP),Gz=K6(wt,pr,Wz,pm,LP,Be,Ve,Qo),Ui=d9(Ko,eT),Hz=xz(jt,Ui),ji=x9(Fh,Hz),Kz=Z6(ji,Ke,Ht),Qz=J6(wt,Kz,ji,Be,Ve),Yz=nB(Oh,Ke,Ht),Xz=tB(wt,Yz,Oh,Be,Ve,Rz),Jz=P9(mm,Ql,Cn,Ui),Yl=R9(mm,fr,Jz,Yw,Xw),Zz=lB(Or,Yl,Ke,Mr,Ht),eq=aB(wt,pr,Zz,Yl,Be,Ve,Kl),ZP=b9(hn,Lh),tq=dB(ZP,Ke,Ht),nq=hB(wt,tq,ZP,Be,Ve,Qo),rq=vB(Or,FP,Ke,Mr,Ht),sq=yB(wt,pr,rq,FP,Be,Ve,Qo),eb=N9(hn),iq=xB(Or,eb,Ke,Mr,Ht),oq=CB(wt,pr,iq,eb,hn,Be,Ve,Qo),aq=OB(Or,Cn,Ke,Mr,Ht),lq=VB(wt,pr,aq,Cn,Be,Ve),uq=M9(pm,jt,Mh,hn),gm=uz(fr,Cn,Mh,yz(Cn,_s)),cq=KB(Ql,Ke,_s,Ht,gm),hq=D9(uq),dq=GB(wt,hq,cq,Be,Ve,Qo),fq=R6(pr,ji,Yl,Mh,hn,jP,Ve,Lh),tb=new WeakMap,pq=h9($z,fq,KP,Ve,tb,Kl),nb=z9(mm,fr,Yw,qP,Xw,$P),mq=ez(Or,nb,Ke,Mr,Ht),gq=Z9(wt,pr,nb,mq,Be,Ve,Kl),rb=iB(Ql),_q=Q9(rb,jt,Cn,BP,Ui),_m=K9(rb,jt,_q,BP,Ui,Fh,Lh),yq=$9(ip,jt,ji,Cn,Mh,_m,hn,op,jP,Ui),sb=q9(yq),vq=rz(Or,ji,Yl,Cn,sb,Ke,_s,Mr,Ht,gm),wq=nz(wt,pr,sb,vq,Be,Ve,Qo),Tq=W9(Vr),Eq=iz(Tq,Be,new WeakSet,Pz),Iq=H9(ji,Oh,Cn,_m,hn,Ui),ib=G9(Iq,hn),Sq=mz(Or,ib,Ke,Mr,Ht),Aq=pz(wt,pr,ib,Sq,Be,Ve),Cq=Ez(_m,Ke,Ht),xq=Tz(wt,jt,_m,Cq,Be,Ve,Qo),ob=i9(Dr),sT=bB(Dr),ab=new WeakMap,kq=zB(ab,_s),Rq=ob?o6(fr,hn,RB(Dr),sT,NB(t6),Be,kq,Ve,$c,new WeakMap,new WeakMap,_z($c,_s),Dr):void 0,Pq=r9(Zw,Ve),bq=mB(tT,fr,pB,kB,new WeakSet,Be,Pq,rp,qc,nT,rT),lb=G6(Rq,Bz,XP,qz,Gz,Qz,Xz,eq,nq,bq,sq,oq,lq,dq,pq,gq,wq,Eq,Aq,xq),Nq=o9(wt,L9,Be,Ve),Dq=l9(wt,F9,Be,Ve),Vq=u9(wt,U9,Be,Ve),Oq=j9(jt,Ve),Mq=c9(wt,Oq,Be),Lq=C6(lb,jt,hn,vz,Nq,Dq,Vq,Mq,Fh),iT=qB(tb),Fq=c6(iT),ub=sB(Vr),Uq=TB(iT),cb=SB(Vr),hb=new WeakMap,jq=MB(hb,dr),Bq=C9(ub,Vr,jt,ji,Oh,Yl,Cn,Mh,hn,cb,sT,jq,Ui),zq=E9(jt,Bq,Cn,hn,Ui),qq=W6(Or,ub,Ql,ji,Oh,Yl,Cn,Uq,cb,sT,Ke,$c,_s,Mr,Ht,gm),$q=jB(ab),Wq=cz(hb),qS=ob?z6(Fq,wt,pr,qq,zq,an,$q,Be,Ve,$c,kz,Wq,Vz,Kl):void 0,Gq=fB(hn,_s),Hq=dz(tT,fr,Jw,iT,gm,rp,nT,rT),Kq=X9(lb,fr,jt,Gq,Hq),Qq=YB(dm,Zw),Yq=XB(qw,eT),Xq=JB($w,QP),Jq=ZB(dm,Ve);function $n(n){return n===void 0}function _e(n){return n!==void 0}function Zq(n){return typeof n=="function"}function Ti(n){return typeof n=="number"}function go(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object}function e$(n){return typeof n=="boolean"}function ur(n){return Array.isArray(n)}function ls(n){return typeof n=="string"}function Rd(n){return ls(n)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(n)}function de(n,e){if(!n)throw new Error(e)}function Ei(n,e,t=1/0){if(!(e<=n&&n<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${n}`)}function db(n){!n.isOffline&&n.state!=="running"&&oT('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let fb=!1,$S=!1;function WS(n){fb=n}function t$(n){$n(n)&&fb&&!$S&&($S=!0,oT("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let pb=console;function n$(...n){pb.log(...n)}function oT(...n){pb.warn(...n)}function r$(n){return new Lq(n)}function s$(n,e,t){return new Kq(n,e,t)}const Jr=typeof self=="object"?self:null,i$=Jr&&(Jr.hasOwnProperty("AudioContext")||Jr.hasOwnProperty("webkitAudioContext"));function o$(n,e,t){return de(_e(qS),"This node only works in a secure context (https or localhost)"),new qS(n,e,t)}function mr(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function tt(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(d){o(d)}}function l(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})}class a${constructor(e,t,r,s){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(s||44100),.001),this.updateInterval=r,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),r=new Worker(t);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function Oo(n){return Xq(n)}function ci(n){return Yq(n)}function sf(n){return Jq(n)}function fa(n){return Qq(n)}function l$(n){return n instanceof XP}function u$(n,e){return n==="value"||Oo(e)||ci(e)||l$(e)}function Ba(n,...e){if(!e.length)return n;const t=e.shift();if(go(n)&&go(t))for(const r in t)u$(r,t[r])?n[r]=t[r]:go(t[r])?(n[r]||Object.assign(n,{[r]:{}}),Ba(n[r],t[r])):Object.assign(n,{[r]:t[r]});return Ba(n,...e)}function c$(n,e){return n.length===e.length&&n.every((t,r)=>e[r]===t)}function Y(n,e,t=[],r){const s={},i=Array.from(e);if(go(i[0])&&r&&!Reflect.has(i[0],r)&&(Object.keys(i[0]).some(a=>Reflect.has(n,a))||(Ba(s,{[r]:i[0]}),t.splice(t.indexOf(r),1),i.shift())),i.length===1&&go(i[0]))Ba(s,i[0]);else for(let o=0;o<t.length;o++)_e(i[o])&&(s[t[o]]=i[o]);return Ba(n,s)}function h$(n){return n.constructor.getDefaults()}function za(n,e){return $n(n)?e:n}function GS(n,e){return e.forEach(t=>{Reflect.has(n,t)&&delete n[t]}),n}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class ys{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Jr&&this.toString()===Jr.TONE_DEBUG_CLASS)&&n$(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}ys.version=vP;const aT=1e-6;function wl(n,e){return n>e+aT}function _y(n,e){return wl(n,e)||er(n,e)}function cp(n,e){return n+aT<e}function er(n,e){return Math.abs(n-e)<aT}function d$(n,e,t){return Math.max(Math.min(n,t),e)}class Wn extends ys{constructor(){super(),this.name="Timeline",this._timeline=[];const e=Y(Wn.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(de(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];de(_y(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const r=this._search(e,t);return r!==-1?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const r=this._search(e,t);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const r=this._search(e);return r-1>=0?this._timeline[r-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(er(this._timeline[t].time,e)){for(let r=t;r>=0&&er(this._timeline[r].time,e);r--)t=r;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&_y(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let r=0;const s=this._timeline.length;let i=s;if(s>0&&this._timeline[s-1][t]<=e)return s-1;for(;r<i;){let o=Math.floor(r+(i-r)/2);const a=this._timeline[o],l=this._timeline[o+1];if(er(a[t],e)){for(let u=o;u<this._timeline.length;u++){const h=this._timeline[u];if(er(h[t],e))o=u;else break}return o}else{if(cp(a[t],e)&&wl(l[t],e))return o;wl(a[t],e)?i=o:r=o+1}}return-1}_iterate(e,t=0,r=this._timeline.length-1){this._timeline.slice(t,r+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const r=this._search(e);return r!==-1&&this._iterate(t,0,r),this}forEachAfter(e,t){const r=this._search(e);return this._iterate(t,r+1),this}forEachBetween(e,t,r){let s=this._search(e),i=this._search(t);return s!==-1&&i!==-1?(this._timeline[s].time!==e&&(s+=1),this._timeline[i].time===t&&(i-=1),this._iterate(r,s,i)):s===-1&&this._iterate(r,0,i),this}forEachFrom(e,t){let r=this._search(e);for(;r>=0&&this._timeline[r].time>=e;)r--;return this._iterate(t,r+1),this}forEachAtTime(e,t){const r=this._search(e);if(r!==-1&&er(this._timeline[r].time,e)){let s=r;for(let i=r;i>=0&&er(this._timeline[i].time,e);i--)s=i;this._iterate(i=>{t(i)},s,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const mb=[];function ym(n){mb.push(n)}function f$(n){mb.forEach(e=>e(n))}const gb=[];function vm(n){gb.push(n)}function p$(n){gb.forEach(e=>e(n))}class Uh extends ys{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(s=>{$n(this._events)&&(this._events={}),this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(t)}),this}once(e,t){const r=(...s)=>{t(...s),this.off(e,r)};return this.on(e,r),this}off(e,t){return e.split(/\W+/).forEach(s=>{if($n(this._events)&&(this._events={}),this._events.hasOwnProperty(s))if($n(t))this._events[s]=[];else{const i=this._events[s];for(let o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const r=this._events[e].slice(0);for(let s=0,i=r.length;s<i;s++)r[s].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const r=Object.getOwnPropertyDescriptor(Uh.prototype,t);Object.defineProperty(e.prototype,t,r)})}dispose(){return super.dispose(),this._events=void 0,this}}class _b extends Uh{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class jh extends _b{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new Wn,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const r=Y(jh.getDefaults(),arguments,["context"]);r.context?(this._context=r.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=r$({latencyHint:r.latencyHint}),this._latencyHint=r.latencyHint),this._ticker=new a$(this.emit.bind(this,"tick"),r.clockSource,r.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=r.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(f$(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,r){return this._context.createBuffer(e,t,r)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,r){return this._context.createPeriodicWave(e,t,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return de(fa(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return de(fa(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return de(fa(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){de(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){de(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){de(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){de(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return o$(this.rawContext,e,t)}addAudioWorkletModule(e){return tt(this,void 0,void 0,function*(){de(_e(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return tt(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return fa(this._context)?this._context.resume():Promise.resolve()}close(){return tt(this,void 0,void 0,function*(){fa(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&p$(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),r=t.getChannelData(0);for(let i=0;i<r.length;i++)r[i]=e;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=t,s.loop=!0,s.start(0),this._constants.set(e,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const r=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:r+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const r=++this._timeoutIds,s=()=>{const i=this.now();this._timeouts.add({callback:()=>{e(),s()},id:r,time:i+t})};return s(),r}}class m$ extends _b{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,r){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return tt(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function lt(n,e){ur(e)?e.forEach(t=>lt(n,t)):Object.defineProperty(n,e,{enumerable:!0,writable:!1})}function yb(n,e){ur(e)?e.forEach(t=>yb(n,t)):Object.defineProperty(n,e,{writable:!0})}const Ne=()=>{};class $e extends ys{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ne;const e=Y($e.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,ls(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Ne,onload:Ne,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:nr().sampleRate}set(e){return e instanceof $e?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return tt(this,void 0,void 0,function*(){const t=$e.load(e).then(r=>{this.set(r),this.onload(this)});$e.downloads.push(t);try{yield t}finally{const r=$e.downloads.indexOf(t);$e.downloads.splice(r,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=ur(e)&&e[0].length>0,r=t?e.length:1,s=t?e[0].length:e.length,i=nr(),o=i.createBuffer(r,s,i.sampleRate),a=!t&&r===1?[e]:e;for(let l=0;l<r;l++)o.copyToChannel(a[l],l);return this._buffer=o,this}toMono(e){if(Ti(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const r=this.numberOfChannels;for(let s=0;s<r;s++){const i=this.toArray(s);for(let o=0;o<i.length;o++)t[o]+=i[o]}t=t.map(s=>s/r),this.fromArray(t)}return this}toArray(e){if(Ti(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let r=0;r<this.numberOfChannels;r++)t[r]=this.getChannelData(r);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){de(this.loaded,"Buffer is not loaded");const r=Math.floor(e*this.sampleRate),s=Math.floor(t*this.sampleRate);de(r<s,"The start time must be less than the end time");const i=s-r,o=nr().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(r,s),a);return new $e(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new $e().fromArray(e)}static fromUrl(e){return tt(this,void 0,void 0,function*(){return yield new $e().load(e)})}static load(e){return tt(this,void 0,void 0,function*(){const t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){const l=t[1].split("|");let u=l[0];for(const h of l)if($e.supportsType(h)){u=h;break}e=e.replace(t[0],u)}const r=$e.baseUrl===""||$e.baseUrl.endsWith("/")?$e.baseUrl:$e.baseUrl+"/",s=document.createElement("a");s.href=r+e,s.pathname=(s.pathname+s.hash).split("/").map(encodeURIComponent).join("/");const i=yield fetch(s.href);if(!i.ok)throw new Error(`could not load url: ${e}`);const o=yield i.arrayBuffer();return yield nr().decodeAudioData(o)})}static supportsType(e){const t=e.split("."),r=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+r)!==""}static loaded(){return tt(this,void 0,void 0,function*(){for(yield Promise.resolve();$e.downloads.length;)yield $e.downloads[0]})}}$e.baseUrl="";$e.downloads=[];class lT extends jh{constructor(){super({clockSource:"offline",context:sf(arguments[0])?arguments[0]:s$(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:sf(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=sf(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return tt(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const r=Math.floor(this.sampleRate/128);e&&t%r===0&&(yield new Promise(s=>setTimeout(s,1)))}})}render(e=!0){return tt(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new $e(t)})}close(){return Promise.resolve()}}const vb=new m$;let uo=vb;function nr(){return uo===vb&&i$&&g$(new jh),uo}function g$(n,e=!1){e&&uo.dispose(),fa(n)?uo=new jh(n):sf(n)?uo=new lT(n):uo=n}function _$(){return uo.resume()}if(Jr&&!Jr.TONE_SILENCE_LOGGING){const e=` * Tone.js v${vP} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function y$(n){return Math.pow(10,n/20)}function v$(n){return 20*(Math.log(n)/Math.LN10)}function wb(n){return Math.pow(2,n/12)}let wm=440;function w$(){return wm}function T$(n){wm=n}function yy(n){return Math.round(Tb(n))}function Tb(n){return 69+12*Math.log2(n/wm)}function E$(n){return wm*Math.pow(2,(n-69)/12)}class uT extends ys{constructor(e,t,r){super(),this.defaultUnits="s",this._val=t,this._units=r,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const r=parseInt(e,10),s=t==="."?1.5:1;return r===1?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/r)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,r)=>{let s=0;return e&&e!=="0"&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s+=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(s+=this._beatsToUnits(parseFloat(r)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof uT&&this.fromType(this._val),$n(this._val))return this._noArg();if(ls(this._val)&&$n(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(go(this._val)){let e=0;for(const t in this._val)if(_e(this._val[t])){const r=this._val[t],s=new this.constructor(this.context,t).valueOf()*r;e+=s}return e}if(_e(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return ls(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class rr extends uT{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new rr(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const r=new this.constructor(this.context,e).valueOf(),s=this.valueOf(),a=Math.round(s/r)*r-s;return s+a*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let i=1;i<9;i++){const o=Math.pow(2,i);t.push(o+"n."),t.push(o+"n"),t.push(o+"t")}t.push("0");let r=t[0],s=new rr(this.context,t[0]).toSeconds();return t.forEach(i=>{const o=new rr(this.context,i).toSeconds();Math.abs(o-e)<Math.abs(s-e)&&(r=i,s=o)}),r}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const r=Math.floor(t/this._getTimeSignature());let s=t%1*4;t=Math.floor(t)%this._getTimeSignature();const i=s.toString();return i.length>3&&(s=parseFloat(parseFloat(i).toFixed(3))),[r,t,s].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return yy(this.toFrequency())}_now(){return this.context.now()}}class zn extends rr{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return w$()}static set A4(e){T$(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:zn.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const s=I$[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?s:zn.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,r){let s=1;return e&&e!=="0"&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s*=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(s*=this._beatsToUnits(parseFloat(r)/4)),s}}})}transpose(e){return new zn(this.context,this.valueOf()*wb(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return yy(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/zn.A4);let r=Math.round(12*t)+57;const s=Math.floor(r/12);return s<0&&(r+=-12*s),S$[r%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return E$(e)}static ftom(e){return yy(e)}}const I$={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},S$=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class oc extends rr{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Sn extends ys{constructor(){super();const e=Y(Sn.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:nr()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return t$(e),new rr(this.context,e).toSeconds()}toFrequency(e){return new zn(this.context,e).toFrequency()}toTicks(e){return new oc(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(r=>{$n(e[r])&&delete t[r]}),t}get(){const e=h$(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const r=this[t];_e(r)&&_e(r.value)&&_e(r.setValueAtTime)?e[t]=r.value:r instanceof Sn?e[t]=r._getPartialProperties(e[t]):ur(r)||Ti(r)||ls(r)||e$(r)?e[t]=r:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&_e(this[t])&&(this[t]&&_e(this[t].value)&&_e(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof Sn?this[t].set(e[t]):this[t]=e[t])}),this}}class cT extends Wn{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,r){return Ei(t,0),this.add(Object.assign({},r,{state:e,time:t})),this}getLastState(e,t){const r=this._search(t);for(let s=r;s>=0;s--){const i=this._timeline[s];if(i.state===e)return i}}getNextState(e,t){const r=this._search(t);if(r!==-1)for(let s=r;s<this._timeline.length;s++){const i=this._timeline[s];if(i.state===e)return i}}}class Ye extends Sn{constructor(){super(Y(Ye.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=Y(Ye.getDefaults(),arguments,["param","units","convert"]);for(de(_e(e.param)&&(Oo(e.param)||e.param instanceof Ye),"param must be an AudioParam");!Oo(e.param);)e.param=e.param._param;this._swappable=_e(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Wn(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,_e(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Sn.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return _e(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return _e(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return _e(this.maxValue)&&_e(this.minValue)&&Ei(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?y$(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?v$(e):e}setValueAtTime(e,t){const r=this.toSeconds(t),s=this._fromType(e);return de(isFinite(s)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",e,r),this._events.add({time:r,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,r),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),r=this._events.getAfter(t),s=this._events.get(t);let i=this._initialValue;if(s===null)i=this._initialValue;else if(s.type==="setTargetAtTime"&&(r===null||r.type==="setValueAtTime")){const o=this._events.getBefore(s.time);let a;o===null?a=this._initialValue:a=o.value,s.type==="setTargetAtTime"&&(i=this._exponentialApproach(s.time,a,s.value,s.constant,t))}else if(r===null)i=s.value;else if(r.type==="linearRampToValueAtTime"||r.type==="exponentialRampToValueAtTime"){let o=s.value;if(s.type==="setTargetAtTime"){const a=this._events.getBefore(s.time);a===null?o=this._initialValue:o=a.value}r.type==="linearRampToValueAtTime"?i=this._linearInterpolate(s.time,o,r.time,r.value,t):i=this._exponentialInterpolate(s.time,o,r.time,r.value,t)}else i=s.value;return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const r=this._fromType(e),s=this.toSeconds(t);return de(isFinite(r)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this._events.add({time:s,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",e,s),this._param.linearRampToValueAtTime(r,s),this}exponentialRampToValueAtTime(e,t){let r=this._fromType(e);r=er(r,0)?this._minOutput:r,this._assertRange(r);const s=this.toSeconds(t);return de(isFinite(r)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",e,s),this._param.exponentialRampToValueAtTime(r,s),this}exponentialRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(e,r+this.toSeconds(t)),this}linearRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(e,r+this.toSeconds(t)),this}targetRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(e,r,t),this}exponentialApproachValueAtTime(e,t,r){t=this.toSeconds(t),r=this.toSeconds(r);const s=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(e,t,s),this.cancelAndHoldAtTime(t+r*.9),this.linearRampToValueAtTime(e,t+r),this}setTargetAtTime(e,t,r){const s=this._fromType(e);de(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(t);return this._assertRange(s),de(isFinite(s)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:r,time:i,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",e,i,r),this._param.setTargetAtTime(s,i,r),this}setValueCurveAtTime(e,t,r,s=1){r=this.toSeconds(r),t=this.toSeconds(t);const i=this._fromType(e[0])*s;this.setValueAtTime(this._toType(i),t);const o=r/(e.length-1);for(let a=1;a<e.length;a++){const l=this._fromType(e[a])*s;this.linearRampToValueAtTime(this._toType(l),t+a*o)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return de(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),r=this._fromType(this.getValueAtTime(t));de(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+r);const s=this._events.get(t),i=this._events.getAfter(t);return s&&er(s.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),i.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(r),t):i.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(r),t)),this._events.add({time:t,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,t),this}rampTo(e,t=.1,r){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,r):this.linearRampTo(e,t,r),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const r=this._events.get(t);if(r&&r.type==="setTargetAtTime"){const s=this._events.getAfter(r.time),i=s?s.time:t+2,o=(i-t)/10;for(let a=t;a<i;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,s=>{s.type==="cancelScheduledValues"?e.cancelScheduledValues(s.time):s.type==="setTargetAtTime"?e.setTargetAtTime(s.value,s.time,s.constant):e[s.type](s.value,s.time)}),this}setParam(e){de(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,r,s,i){return r+(t-r)*Math.exp(-(i-e)/s)}_linearInterpolate(e,t,r,s,i){return t+(s-t)*((i-e)/(r-e))}_exponentialInterpolate(e,t,r,s,i){return t*Math.pow(s/t,(i-e)/(r-e))}}class me extends Sn{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return _e(this.input)?Oo(this.input)||this.input instanceof Ye?1:this.input.numberOfInputs:0}get numberOfOutputs(){return _e(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return _e(e)&&(e instanceof me||ci(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(r=>{r.channelCount=e.channelCount,r.channelCountMode=e.channelCountMode,r.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();de(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,r=0){return Yo(this,e,t,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return oT("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,r=0){return A$(this,e,t,r),this}chain(...e){return vy(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),_e(this.input)&&(this.input instanceof me?this.input.dispose():ci(this.input)&&this.input.disconnect()),_e(this.output)&&(this.output instanceof me?this.output.dispose():ci(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function vy(...n){const e=n.shift();n.reduce((t,r)=>(t instanceof me?t.connect(r):ci(t)&&Yo(t,r),r),e)}function Yo(n,e,t=0,r=0){for(de(_e(n),"Cannot connect from undefined node"),de(_e(e),"Cannot connect to undefined node"),(e instanceof me||ci(e))&&de(e.numberOfInputs>0,"Cannot connect to node with no inputs"),de(n.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof me||e instanceof Ye;)_e(e.input)&&(e=e.input);for(;n instanceof me;)_e(n.output)&&(n=n.output);Oo(e)?n.connect(e,t):n.connect(e,t,r)}function A$(n,e,t=0,r=0){if(_e(e))for(;e instanceof me;)e=e.input;for(;!ci(n);)_e(n.output)&&(n=n.output);Oo(e)?n.disconnect(e,t):ci(e)?n.disconnect(e,t,r):n.disconnect()}class Bt extends me{constructor(){super(Y(Bt.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=Y(Bt.getDefaults(),arguments,["gain","units"]);this.gain=new Ye({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),lt(this,"gain")}static getDefaults(){return Object.assign(me.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Tl extends me{constructor(e){super(e),this.onended=Ne,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Bt({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const r=this.toSeconds(t);return this._startTime!==-1&&r>=this._startTime&&(this._stopTime===-1||r<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(me.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ne})}_startGain(e,t=1){de(this._startTime===-1,"Source cannot be started more than once");const r=this.toSeconds(this._fadeIn);return this._startTime=e+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+r):this._gainNode.gain.exponentialApproachValueAtTime(t,e,r)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){de(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const r=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+r),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ne&&(this.onended(this),this.onended=Ne,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),de(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Ne,this}}class hp extends Tl{constructor(){super(Y(hp.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=Y(hp.getDefaults(),arguments,["offset"]);Yo(this._source,this._gainNode),this.offset=new Ye({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Tl.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Pt extends me{constructor(){super(Y(Pt.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=Y(Pt.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new hp({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(me.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,r=0){return hT(this,e,t,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,r){return this._param.exponentialRampTo(e,t,r),this}linearRampTo(e,t,r){return this._param.linearRampTo(e,t,r),this}targetRampTo(e,t,r){return this._param.targetRampTo(e,t,r),this}exponentialApproachValueAtTime(e,t,r){return this._param.exponentialApproachValueAtTime(e,t,r),this}setTargetAtTime(e,t,r){return this._param.setTargetAtTime(e,t,r),this}setValueCurveAtTime(e,t,r,s){return this._param.setValueCurveAtTime(e,t,r,s),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,r){return this._param.rampTo(e,t,r),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function hT(n,e,t,r){(e instanceof Ye||Oo(e)||e instanceof Pt&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Pt&&(e.overridden=!0)),Yo(n,e,t,r)}class dp extends Ye{constructor(){super(Y(dp.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Wn(1/0),this._multiplier=1;const e=Y(dp.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Ye.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,r){t=this.toSeconds(t),this.setRampPoint(t);const s=this._fromType(e),i=this._events.get(t),o=Math.round(Math.max(1/r,1));for(let a=0;a<=o;a++){const l=r*a+t,u=this._exponentialApproach(i.time,i.value,s,r,l);this.linearRampToValueAtTime(this._toType(u),l)}return this}setValueAtTime(e,t){const r=this.toSeconds(t);super.setValueAtTime(e,t);const s=this._events.get(r),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,r);return s.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,t){const r=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const s=this._events.get(r),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,r);return s.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const r=this._fromType(e),s=this._events.get(t),i=Math.round(Math.max((t-s.time)*10,1)),o=(t-s.time)/i;for(let a=0;a<=i;a++){const l=o*a+s.time,u=this._exponentialInterpolate(s.time,s.value,t,r,l);this.linearRampToValueAtTime(this._toType(u),l)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if($n(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const r=this._fromType(this.getValueAtTime(e.time));let s=this._fromType(this.getValueAtTime(t));const i=this._events.get(t);return i&&i.time===t&&i.type==="setValueAtTime"&&(s=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+s)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),r=this._events.get(t);return Math.max(this._getTicksUntilEvent(r,t),0)}getDurationOfTicks(e,t){const r=this.toSeconds(t),s=this.getTicksAtTime(t);return this.getTimeOfTick(s+e)-r}getTimeOfTick(e){const t=this._events.get(e,"ticks"),r=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&r&&r.type==="linearRampToValueAtTime"&&t.value!==r.value){const s=this._fromType(this.getValueAtTime(t.time)),o=(this._fromType(this.getValueAtTime(r.time))-s)/(r.time-t.time),a=Math.sqrt(Math.pow(s,2)-2*o*(t.ticks-e)),l=(-s+a)/o,u=(-s-a)/o;return(l>0?l:u)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const r=this.toSeconds(t),s=this.toSeconds(e),i=this.getTicksAtTime(r);return this.getTicksAtTime(r+s)-i}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class fp extends Pt{constructor(){super(Y(fp.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=Y(fp.getDefaults(),arguments,["value"]);this.input=this._param=new dp({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Pt.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class pp extends Sn{constructor(){super(Y(pp.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new cT,this._tickOffset=new Wn,this._ticksAtTime=new Wn,this._secondsAtTime=new Wn;const e=Y(pp.getDefaults(),arguments,["frequency"]);this.frequency=new fp({context:this.context,units:e.units,value:e.frequency}),lt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Sn.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const r=this.toSeconds(e);return this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),_e(t)&&this.setTicksAtTime(t,r),this._ticksAtTime.cancel(r),this._secondsAtTime.cancel(r)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const r=this._state.get(t);r&&r.time>0&&(this._tickOffset.cancel(r.time),this._state.cancel(r.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),r=this._state.getLastState("stopped",t),s=this._ticksAtTime.get(t),i={state:"paused",time:t};this._state.add(i);let o=s||r,a=s?s.ticks:0,l=null;return this._state.forEachBetween(o.time,t+this.sampleTime,u=>{let h=o.time;const d=this._tickOffset.get(u.time);d&&d.time>=o.time&&(a=d.ticks,h=d.time),o.state==="started"&&u.state!=="started"&&(a+=this.frequency.getTicksAtTime(u.time)-this.frequency.getTicksAtTime(h),u.time!==i.time&&(l={state:u.state,time:u.time,ticks:a})),o=u}),this._state.remove(i),l&&this._ticksAtTime.add(l),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),r=this.frequency.timeToTicks(e,t);this.setTicksAtTime(r,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);const s=this._secondsAtTime.get(e);let i=s||t,o=s?s.seconds:0,a=null;return this._state.forEachBetween(i.time,e+this.sampleTime,l=>{let u=i.time;const h=this._tickOffset.get(l.time);h&&h.time>=i.time&&(o=h.seconds,u=h.time),i.state==="started"&&l.state!=="started"&&(o+=l.time-u,l.time!==r.time&&(a={state:l.state,time:l.time,seconds:o})),i=l}),this._state.remove(r),a&&this._secondsAtTime.add(a),o}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const r=this._tickOffset.get(t),s=this._state.get(t),i=Math.max(r.time,s.time),o=this.frequency.getTicksAtTime(i)+e-r.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,t,r){let s=this._state.get(e);this._state.forEachBetween(e,t,o=>{s&&s.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(s.time,e),o.time-this.sampleTime,r),s=o});let i=null;if(s&&s.state==="started"){const o=Math.max(s.time,e),a=this.frequency.getTicksAtTime(o),l=this.frequency.getTicksAtTime(s.time),u=a-l;let h=Math.ceil(u)-u;h=er(h,1)?0:h;let d=this.frequency.getTimeOfTick(a+h);for(;d<t;){try{r(d,Math.round(this.getTicksAtTime(d)))}catch(f){i=f;break}d+=this.frequency.getDurationOfTicks(1,d)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class Wc extends Sn{constructor(){super(Y(Wc.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Ne,this._lastUpdate=0,this._state=new cT("stopped"),this._boundLoop=this._loop.bind(this);const e=Y(Wc.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new pp({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,lt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Sn.getDefaults(),{callback:Ne,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){db(this.context);const r=this.toSeconds(e);return this.log("start",r),this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,t),r<this._lastUpdate&&this.emit("start",r,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const r=this.toSeconds(t),s=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(s+e,r)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,r=>{switch(r.state){case"started":const s=this._tickSource.getTicksAtTime(r.time);this.emit("start",r.time,s);break;case"stopped":r.time!==0&&this.emit("stop",r.time);break;case"paused":this.emit("pause",r.time);break}}),this._tickSource.forEachTickBetween(e,t,(r,s)=>{this.callback(r,s)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Uh.mixin(Wc);class dT extends ys{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=Y(dT.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const r=e.urls[t];this.add(t,r,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Ne,onload:Ne,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return de(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,r=Ne,s=Ne){return ls(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new $e(this.baseUrl+t,r,s))):this._buffers.set(e.toString(),new $e(t,r,s)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class xa extends oc{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class C$ extends Sn{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Wn,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}ym(n=>{n.draw=new C$({context:n})});vm(n=>{n.draw.dispose()});class x$ extends ys{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){de(_e(e.time),"Events must have a time property"),de(_e(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new k$(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const r of t)if(r.event===e){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let r,s=null;if(t>0)if(e.left.right===null)r=e.left,r.right=e.right,s=r;else{for(r=e.left.right;r.right!==null;)r=r.right;r.parent&&(r.parent.right=r.left,s=r.parent,r.left=e.left,r.right=e.right)}else if(e.right.left===null)r=e.right,r.left=e.left,s=r;else{for(r=e.right.left;r.left!==null;)r=r.left;r.parent&&(r.parent.left=r.right,s=r.parent,r.left=e.left,r.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=r:e.parent.right=r:this._setRoot(r),s&&this._rebalance(s)}e.dispose()}_rotateLeft(e){const t=e.parent,r=e.isLeftChild(),s=e.right;s&&(e.right=s.left,s.left=e),t!==null?r?t.left=s:t.right=s:this._setRoot(s)}_rotateRight(e){const t=e.parent,r=e.isLeftChild(),s=e.left;s&&(e.left=s.right,s.right=e),t!==null?r?t.left=s:t.right=s:this._setRoot(s)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let r=t[0];for(let s=1;s<t.length;s++)t[s].low>r.low&&(r=t[s]);return r.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(r=>t.push(r)),t.forEach(r=>{r.event&&e(r.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const r=[];this._root.search(e,r),r.forEach(s=>{s.event&&t(s.event)})}return this}forEachFrom(e,t){if(this._root!==null){const r=[];this._root.searchAfter(e,r),r.forEach(s=>{s.event&&t(s.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class k${constructor(e,t,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Ii extends me{constructor(){super(Y(Ii.getDefaults(),arguments,["volume"])),this.name="Volume";const e=Y(Ii.getDefaults(),arguments,["volume"]);this.input=this.output=new Bt({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,lt(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(me.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class mp extends me{constructor(){super(Y(mp.getDefaults(),arguments)),this.name="Destination",this.input=new Ii({context:this.context}),this.output=new Bt({context:this.context}),this.volume=this.input.volume;const e=Y(mp.getDefaults(),arguments);vy(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(me.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),vy(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}ym(n=>{n.destination=new mp({context:n})});vm(n=>{n.destination.dispose()});class R$ extends ys{constructor(e){super(),this.name="TimelineValue",this._timeline=new Wn({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class El extends me{constructor(){super(Object.assign(Y(El.getDefaults(),arguments,["context"])))}connect(e,t=0,r=0){return hT(this,e,t,r),this}}class Il extends El{constructor(){super(Object.assign(Y(Il.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=Y(Il.getDefaults(),arguments,["mapping","length"]);ur(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):Zq(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Pt.getDefaults(),{length:1024})}setMap(e,t=1024){const r=new Float32Array(t);for(let s=0,i=t;s<i;s++){const o=s/(i-1)*2-1;r[s]=e(o,s)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(r=>r.includes(e));de(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class gp extends El{constructor(){super(Object.assign(Y(gp.getDefaults(),arguments,["value"]))),this.name="Pow";const e=Y(gp.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new Il({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(El.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Si{constructor(e,t){this.id=Si._eventId++,this._remainderTime=0;const r=Object.assign(Si.getDefaults(),t);this.transport=e,this.callback=r.callback,this._once=r.once,this.time=Math.floor(r.time),this._remainderTime=r.time-this.time}static getDefaults(){return{callback:Ne,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Si._eventId=0;class fT extends Si{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const r=Object.assign(fT.getDefaults(),t);this.duration=r.duration,this._interval=r.interval,this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Si.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return cp(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new xa(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){cp(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new xa(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);wl(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class Gc extends Sn{constructor(){super(Y(Gc.getDefaults(),arguments)),this.name="Transport",this._loop=new R$(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Wn,this._repeatedEvents=new x$,this._syncedSignals=[],this._swingAmount=0;const e=Y(Gc.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new Wc({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),lt(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Sn.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const r=t%(this._swingTicks*2)/(this._swingTicks*2),s=Math.sin(r*Math.PI)*this._swingAmount;e+=new xa(this.context,this._swingTicks*2/3).toSeconds()*s}WS(!0),this._timeline.forEachAtTime(t,r=>r.invoke(e)),WS(!1)}schedule(e,t){const r=new Si(this,{callback:e,time:new oc(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(e,t,r,s=1/0){const i=new fT(this,{callback:e,duration:new rr(this.context,s).toTicks(),interval:new rr(this.context,t).toTicks(),time:new oc(this.context,r).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){const r=new Si(this,{callback:e,once:!0,time:new oc(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,r=>this.clear(r.id)),this._repeatedEvents.forEachFrom(t,r=>this.clear(r.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new xa(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let r;return _e(t)&&(r=this.toTicks(t)),this._clock.start(e,r),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){ur(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new rr(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new rr(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new xa(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new xa(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),r=this._clock.frequency.timeToTicks(e,t);this.ticks=r}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const r=this._clock.getTicksAtTime(t),s=this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,t),i=t+s;this.emit("stop",i),this._clock.setTicksAtTime(e,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),r=this.getTicksAtTime(t),s=e-r%e;return this._clock.nextTickTime(s,t)}}syncSignal(e,t){const r=this.now();let s=this.bpm,i=1/(60/s.getValueAtTime(r)/this.PPQ),o=[];if(e.units==="time"){const l=.015625/i,u=new Bt(l),h=new gp(-1),d=new Bt(l);s.chain(u,h,d),s=d,i=1/i,o=[u,h,d]}t||(e.getValueAtTime(r)!==0?t=e.getValueAtTime(r)/i:t=0);const a=new Bt(t);return s.connect(a),a.connect(e._param),o.push(a),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const r=this._syncedSignals[t];r.signal===e&&(r.nodes.forEach(s=>s.dispose()),r.signal.value=r.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),yb(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Uh.mixin(Gc);ym(n=>{n.transport=new Gc({context:n})});vm(n=>{n.transport.dispose()});class Mn extends me{constructor(e){super(e),this.input=void 0,this._state=new cT("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ne,this._syncedStop=Ne,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Ii({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,lt(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(me.getDefaults(),{mute:!1,onstop:Ne,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,r){let s=$n(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(s=this._clampToCurrentTime(s),!this._synced&&this._state.getValueAtTime(s)==="started")de(wl(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,t,r);else if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const i=this._state.get(s);i&&(i.offset=this.toSeconds(za(t,0)),i.duration=r?this.toSeconds(r):void 0);const o=this.context.transport.schedule(a=>{this._start(a,t,r)},s);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else db(this.context),this._start(s,t,r);return this}stop(e){let t=$n(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||_e(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const r=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(r)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,r){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(wl(t,0)){const r=this._state.get(t);if(r&&r.state==="started"&&r.time!==t){const s=t-this.toSeconds(r.time);let i;r.duration&&(i=this.toSeconds(r.duration)-s),this._start(e,this.toSeconds(r.offset)+s,i)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ne,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Hc extends Tl{constructor(){super(Y(Hc.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=Y(Hc.getDefaults(),arguments,["url","onload"]);Yo(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Ye({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new $e(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Tl.getDefaults(),{url:new $e,loop:!1,loopEnd:0,loopStart:0,onload:Ne,onerror:Ne,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,r,s=1){de(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(e);this._startGain(i,s),this.loop?t=za(t,this.loopStart):t=za(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),u=a-l;_y(o,a)&&(o=(o-l)%u+l),er(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,cp(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),_e(r)){let a=this.toSeconds(r);a=Math.max(a,0),this.stop(i+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class ka extends me{constructor(){super(Y(ka.getDefaults(),arguments,["volume"])),this.name="UserMedia";const e=Y(ka.getDefaults(),arguments,["volume"]);this._volume=this.output=new Ii({context:this.context,volume:e.volume}),this.volume=this._volume.volume,lt(this,"volume"),this.mute=e.mute}static getDefaults(){return Object.assign(me.getDefaults(),{mute:!1,volume:0})}open(e){return tt(this,void 0,void 0,function*(){de(ka.supported,"UserMedia is not supported"),this.state==="started"&&this.close();const t=yield ka.enumerateDevices();Ti(e)?this._device=t[e]:(this._device=t.find(i=>i.label===e||i.deviceId===e),!this._device&&t.length>0&&(this._device=t[0]),de(_e(this._device),`No matching device ${e}`));const r={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(r.audio.deviceId=this._device.deviceId);const s=yield navigator.mediaDevices.getUserMedia(r);if(!this._stream){this._stream=s;const i=this.context.createMediaStreamSource(s);Yo(i,this.output),this._mediaStream=i}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(e=>{e.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return tt(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="audioinput")})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){if(this._device)return this._device.deviceId}get groupId(){if(this._device)return this._device.groupId}get label(){if(this._device)return this._device.label}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return _e(navigator.mediaDevices)&&_e(navigator.mediaDevices.getUserMedia)}}function Xo(n,e){return tt(this,void 0,void 0,function*(){const t=e/n.context.sampleRate,r=new lT(1,t,n.context.sampleRate);return new n.constructor(Object.assign(n.get(),{frequency:2/t,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}class _p extends Tl{constructor(){super(Y(_p.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=Y(_p.getDefaults(),arguments,["frequency","type"]);Yo(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Ye({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Ye({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),lt(this,["frequency","detune"])}static getDefaults(){return Object.assign(Tl.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class mt extends Mn{constructor(){super(Y(mt.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const e=Y(mt.getDefaults(),arguments,["frequency","type"]);this.frequency=new Pt({context:this.context,units:"frequency",value:e.frequency}),lt(this,"frequency"),this.detune=new Pt({context:this.context,units:"cents",value:e.detune}),lt(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Mn.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),r=new _p({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return mt._periodicWaveCache.find(t=>t.phase===this._phase&&c$(t.partials,this._partials));{const e=mt._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const r=this._getCachedPeriodicWave();if(_e(r)){const{partials:s,wave:i}=r;this._wave=i,this._partials=s,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[s,i]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(s,i);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),mt._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),mt._periodicWaveCache.length>100&&mt._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){Ei(e,0);let t=this._type;const r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(t=r[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const s=new Float32Array(e);this._partials.forEach((i,o)=>s[o]=i),this._partials=Array.from(s),this.type=this._type}}_getRealImaginary(e,t){let s=2048;const i=new Float32Array(s),o=new Float32Array(s);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,s=a,this._partials.length===0)return[i,o]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);l?(a=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),e=l[1],a=Math.max(a,2),s=a):this._partialCount=0,this._partials=[]}for(let l=1;l<s;++l){const u=2/(l*Math.PI);let h;switch(e){case"sine":h=l<=a?1:0,this._partials[l-1]=h;break;case"square":h=l&1?2*u:0,this._partials[l-1]=h;break;case"sawtooth":h=u*(l&1?1:-1),this._partials[l-1]=h;break;case"triangle":l&1?h=2*(u*u)*(l-1>>1&1?-1:1):h=0,this._partials[l-1]=h;break;case"custom":h=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}h!==0?(i[l]=-h*Math.sin(t*l),o[l]=h*Math.cos(t*l)):(i[l]=0,o[l]=0)}return[i,o]}_inverseFFT(e,t,r){let s=0;const i=e.length;for(let o=0;o<i;o++)s+=e[o]*Math.cos(o*r)+t[o]*Math.sin(o*r);return s}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let r=0;const s=Math.PI*2,i=32;for(let o=0;o<i;o++)r=Math.max(this._inverseFFT(e,t,o/i*s),r);return d$(-this._inverseFFT(e,t,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return tt(this,void 0,void 0,function*(){return Xo(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}mt._periodicWaveCache=[];class P$ extends El{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Il({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Mo extends Pt{constructor(){super(Object.assign(Y(Mo.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=Y(Mo.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Bt({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Pt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Kc extends Mn{constructor(){super(Y(Kc.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new P$({context:this.context}),this._modulationNode=new Bt({context:this.context});const e=Y(Kc.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new mt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new mt({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Mo({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),lt(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(mt.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return tt(this,void 0,void 0,function*(){return Xo(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Qc extends Mn{constructor(){super(Y(Qc.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Bt({context:this.context,gain:0});const e=Y(Qc.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new mt({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Pt({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new mt({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Mo({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Mo({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),lt(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(mt.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return tt(this,void 0,void 0,function*(){return Xo(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Sl extends Mn{constructor(){super(Y(Sl.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Bt({context:this.context,gain:0}),this._thresh=new Il({context:this.context,mapping:t=>t<=0?-1:1});const e=Y(Sl.getDefaults(),arguments,["frequency","width"]);this.width=new Pt({context:this.context,units:"audioRange",value:e.width}),this._triangle=new mt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),lt(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Mn.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return tt(this,void 0,void 0,function*(){return Xo(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Yc extends Mn{constructor(){super(Y(Yc.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=Y(Yc.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Pt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Pt({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,lt(this,["frequency","detune"])}static getDefaults(){return Object.assign(mt.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,r=e/(this._oscillators.length-1);this._forEach((s,i)=>s.detune.value=t+r*i)}}get count(){return this._oscillators.length}set count(e){if(Ei(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const r=new mt({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):Ne});this.type==="custom"&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[t]=r}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,r)=>t.phase=this._phase+r/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return tt(this,void 0,void 0,function*(){return Xo(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class Xc extends Mn{constructor(){super(Y(Xc.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Mo({context:this.context,value:2});const e=Y(Xc.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Sl({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new mt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),lt(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Mn.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return tt(this,void 0,void 0,function*(){return Xo(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const HS={am:Kc,fat:Yc,fm:Qc,oscillator:mt,pulse:Sl,pwm:Xc};class Jc extends Mn{constructor(){super(Y(Jc.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=Y(Jc.getDefaults(),arguments,["frequency","type"]);this.frequency=new Pt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Pt({context:this.context,units:"cents",value:e.detune}),lt(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(mt.getDefaults(),Qc.getDefaults(),Kc.getDefaults(),Yc.getDefaults(),Sl.getDefaults(),Xc.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=HS[e],r=this.now();if(this._oscillator){const s=this._oscillator;s.stop(r),this.context.setTimeout(()=>s.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof HS[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&Ti(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&Ti(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&ls(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return tt(this,void 0,void 0,function*(){return Xo(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function Eb(n,e=1/0){const t=new WeakMap;return function(r,s){Reflect.defineProperty(r,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Ei(i,n,e),t.set(this,i)}})}}function vs(n,e=1/0){const t=new WeakMap;return function(r,s){Reflect.defineProperty(r,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Ei(this.toSeconds(i),n,e),t.set(this,i)}})}}class Al extends Mn{constructor(){super(Y(Al.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=Y(Al.getDefaults(),arguments,["url","onload"]);this._buffer=new $e({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Mn.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ne,onerror:Ne,playbackRate:1,reverse:!1})}load(e){return tt(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Ne){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,r){return super.start(e,t,r),this}_start(e,t,r){this._loop?t=za(t,this._loopStart):t=za(t,0);const s=this.toSeconds(t),i=r;r=za(r,Math.max(this._buffer.duration-s,0));let o=this.toSeconds(r);o=o/this._playbackRate,e=this.toSeconds(e);const a=new Hc({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&$n(i)?a.start(e,s):a.start(e,s,o-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(r=>r.stop(t))}restart(e,t,r){return super.restart(e,t,r),this}_restart(e,t,r){var s;(s=[...this._activeSources].pop())===null||s===void 0||s.stop(e),this._start(e,t,r)}seek(e,t){const r=this.toSeconds(t);if(this._state.getValueAtTime(r)==="started"){const s=this.toSeconds(e);this._stop(r),this._start(r,s)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&Ei(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&Ei(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),r=this._state.getNextState("stopped",t);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(s=>s.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}mr([vs(0)],Al.prototype,"fadeIn",void 0);mr([vs(0)],Al.prototype,"fadeOut",void 0);class us extends me{constructor(){super(Y(us.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Pt({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=Y(us.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(me.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(ls(e))return e;{let r;for(r in Pd)if(Pd[r][t]===e)return r;return e}}_setCurve(e,t,r){if(ls(r)&&Reflect.has(Pd,r)){const s=Pd[r];go(s)?e!=="_decayCurve"&&(this[e]=s[t]):this[e]=s}else if(ur(r)&&e!=="_decayCurve")this[e]=r;else throw new Error("Envelope: invalid curve: "+r)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let s=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/s;s=(1-o)/a}if(s<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,s,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,s,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let l=1;l<a.length;l++)if(a[l-1]<=o&&o<=a[l]){a=this._attackCurve.slice(l),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,s,t)}if(i&&this.sustain<1){const a=t*this.sustain,l=e+s;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,i+l):this._sig.exponentialApproachValueAtTime(a,l,i)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,r,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,r,e):(de(ur(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,r,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),this.triggerAttack(t,r),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,r=0){return hT(this,e,t,r),this}asArray(e=1024){return tt(this,void 0,void 0,function*(){const t=e/this.context.sampleRate,r=new lT(1,t,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=s+this.toSeconds(this.release),o=i*.1,a=i+o,l=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:r}));return l._sig.toDestination(),l.triggerAttackRelease(t*(s+o)/a,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}mr([vs(0)],us.prototype,"attack",void 0);mr([vs(0)],us.prototype,"decay",void 0);mr([Eb(0,1)],us.prototype,"sustain",void 0);mr([vs(0)],us.prototype,"release",void 0);const Pd=(()=>{let e,t;const r=[];for(e=0;e<128;e++)r[e]=Math.sin(e/127*(Math.PI/2));const s=[],i=6.4;for(e=0;e<127;e++){t=e/127;const f=Math.sin(t*(Math.PI*2)*i-Math.PI/2)+1;s[e]=f/10+t*.83}s[127]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/127*a)/a;const l=[];for(e=0;e<128;e++)t=e/127,l[e]=.5*(1-Math.cos(Math.PI*t));const u=[];for(e=0;e<128;e++){t=e/127;const f=Math.pow(t,3)*4+.2,m=Math.cos(f*Math.PI*2*t);u[e]=Math.abs(m*(1-t))}function h(f){const m=new Array(f.length);for(let g=0;g<f.length;g++)m[g]=1-f[g];return m}function d(f){return f.slice(0).reverse()}return{bounce:{In:h(u),Out:u},cosine:{In:r,Out:d(r)},exponential:"exponential",linear:"linear",ripple:{In:s,Out:h(s)},sine:{In:l,Out:h(l)},step:{In:o,Out:h(o)}}})();class Lo extends me{constructor(){super(Y(Lo.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t);const e=Y(Lo.getDefaults(),arguments);this._volume=this.output=new Ii({context:this.context,volume:e.volume}),this.volume=this._volume.volume,lt(this,"volume")}static getDefaults(){return Object.assign(me.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const r=this["_original_"+e]=this[e];this[e]=(...s)=>{const i=s[t],o=this.context.transport.schedule(a=>{s[t]=a,r.apply(this,s)},i);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,r,s){const i=this.toSeconds(r),o=this.toSeconds(t);return this.triggerAttack(e,i,s),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Fo extends Lo{constructor(){super(Y(Fo.getDefaults(),arguments));const e=Y(Fo.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Lo.getDefaults(),{detune:0,onsilence:Ne,portamento:0})}triggerAttack(e,t,r=1){this.log("triggerAttack",e,t,r);const s=this.toSeconds(t);return this._triggerEnvelopeAttack(s,r),this.setNote(e,s),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const r=this.toSeconds(t),s=e instanceof zn?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(r)>.05){const i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,i,r)}else this.frequency.setValueAtTime(s,r);return this}}mr([vs(0)],Fo.prototype,"portamento",void 0);class pT extends us{constructor(){super(Y(pT.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Bt({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Zc extends Fo{constructor(){super(Y(Zc.getDefaults(),arguments)),this.name="Synth";const e=Y(Zc.getDefaults(),arguments);this.oscillator=new Jc(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new pT(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),lt(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Fo.getDefaults(),{envelope:Object.assign(GS(us.getDefaults(),Object.keys(me.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(GS(Jc.getDefaults(),[...Object.keys(Mn.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const r=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+r+s)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class eh extends Zc{constructor(){super(Y(eh.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=Y(eh.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,lt(this,["oscillator","envelope"])}static getDefaults(){return Ba(Fo.getDefaults(),Zc.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const r=this.toSeconds(t),s=this.toFrequency(e instanceof zn?e.toFrequency():e),i=s*this.octaves;return this.oscillator.frequency.setValueAtTime(i,r),this.oscillator.frequency.exponentialRampToValueAtTime(s,r+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}mr([Eb(0)],eh.prototype,"octaves",void 0);mr([vs(0)],eh.prototype,"pitchDecay",void 0);const Ib=new Set;function mT(n){Ib.add(n)}function Sb(n,e){const t=`registerProcessor("${n}", ${e})`;Ib.add(t)}const b$=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;mT(b$);const N$=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;mT(N$);const D$=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;mT(D$);const V$="feedback-comb-filter",O$=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;Sb(V$,O$);class th extends Lo{constructor(){super(Y(th.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=Y(th.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(r=>{const s=parseInt(r,10);if(de(Rd(r)||Ti(s)&&isFinite(s),`url key is neither a note or midi pitch: ${r}`),Rd(r)){const i=new zn(this.context,r).toMidi();t[i]=e.urls[r]}else Ti(s)&&isFinite(s)&&(t[s]=e.urls[s])}),this._buffers=new dT({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Lo.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ne,onerror:Ne,release:.1,urls:{}})}_findClosest(e){let r=0;for(;r<96;){if(this._buffers.has(e+r))return-r;if(this._buffers.has(e-r))return r;r++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,r=1){return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach(s=>{const i=Tb(new zn(this.context,s).toFrequency()),o=Math.round(i),a=i-o,l=this._findClosest(o),u=o-l,h=this._buffers.get(u),d=wb(l+a),f=new Hc({url:h,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:d}).connect(this.output);f.start(t,0,h.duration/d,r),ur(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const m=this._activeSources.get(o),g=m.indexOf(f);g!==-1&&m.splice(g,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(r=>{const s=new zn(this.context,r).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const i=this._activeSources.get(s);t=this.toSeconds(t),i.forEach(o=>{o.stop(t)}),this._activeSources.set(s,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(r=>{for(;r.length;)r.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,r,s=1){const i=this.toSeconds(r);return this.triggerAttack(e,i,s),ur(t)?(de(ur(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const l=t[Math.min(a,t.length-1)];this.triggerRelease(o,i+this.toSeconds(l))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,r){if(de(Rd(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Rd(e)){const s=new zn(this.context,e).toMidi();this._buffers.add(s,t,r)}else this._buffers.add(e,t,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}mr([vs(0)],th.prototype,"attack",void 0);mr([vs(0)],th.prototype,"release",void 0);class yp extends me{constructor(){super(Object.assign(Y(yp.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=Y(yp.getDefaults(),arguments,["pan"]);this.pan=new Ye({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",lt(this,"pan")}static getDefaults(){return Object.assign(me.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const M$="bit-crusher",L$=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;Sb(M$,L$);class ft extends me{constructor(){super(Y(ft.getDefaults(),arguments,["solo"])),this.name="Solo";const e=Y(ft.getDefaults(),arguments,["solo"]);this.input=this.output=new Bt({context:this.context}),ft._allSolos.has(this.context)||ft._allSolos.set(this.context,new Set),ft._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(me.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),ft._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){ft._soloed.has(this.context)||ft._soloed.set(this.context,new Set),ft._soloed.get(this.context).add(this)}_removeSolo(){ft._soloed.has(this.context)&&ft._soloed.get(this.context).delete(this)}_isSoloed(){return ft._soloed.has(this.context)&&ft._soloed.get(this.context).has(this)}_noSolos(){return!ft._soloed.has(this.context)||ft._soloed.has(this.context)&&ft._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),ft._allSolos.get(this.context).delete(this),this._removeSolo(),this}}ft._allSolos=new Map;ft._soloed=new Map;class vp extends me{constructor(){super(Y(vp.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=Y(vp.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new yp({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Ii({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,lt(this,["pan","volume"])}static getDefaults(){return Object.assign(me.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class ro extends me{constructor(){super(Y(ro.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=Y(ro.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new ft({solo:e.solo,context:this.context}),this._panVol=this.output=new vp({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),lt(this,["pan","volume"])}static getDefaults(){return Object.assign(me.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return ro.buses.has(e)||ro.buses.set(e,new Bt({context:this.context})),ro.buses.get(e)}send(e,t=0){const r=this._getBus(e),s=new Bt({context:this.context,units:"decibels",gain:t});return this.connect(s),s.connect(r),s}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}ro.buses=new Map;class F$ extends me{constructor(){super(...arguments),this.name="Listener",this.positionX=new Ye({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Ye({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Ye({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Ye({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Ye({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Ye({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Ye({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Ye({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Ye({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(me.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}ym(n=>{n.listener=new F$({context:n})});vm(n=>{n.listener.dispose()});class ac extends me{constructor(){super(Y(ac.getDefaults(),arguments)),this.name="Recorder";const e=Y(ac.getDefaults(),arguments);this.input=new Bt({context:this.context}),de(ac.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:e.mimeType})}static getDefaults(){return me.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return Jr!==null&&Reflect.has(Jr,"MediaRecorder")}get state(){return this._recorder.state==="inactive"?"stopped":this._recorder.state==="paused"?"paused":"started"}start(){return tt(this,void 0,void 0,function*(){de(this.state!=="started","Recorder is already started");const e=new Promise(t=>{const r=()=>{this._recorder.removeEventListener("start",r,!1),t()};this._recorder.addEventListener("start",r,!1)});return this._recorder.start(),yield e})}stop(){return tt(this,void 0,void 0,function*(){de(this.state!=="stopped","Recorder is not started");const e=new Promise(t=>{const r=s=>{this._recorder.removeEventListener("dataavailable",r,!1),t(s.data)};this._recorder.addEventListener("dataavailable",r,!1)});return this._recorder.stop(),yield e})}pause(){return de(this.state==="started","Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}nr().transport;nr().destination;nr().destination;nr().listener;nr().draw;nr();const U$=()=>{const{matches:n}=q.useContext(Jo),[e,t]=q.useState(null),[r,s]=q.useState([]),[i,o]=q.useState(!1),[a,l]=q.useState(null),[u,h]=q.useState("");q.useEffect(()=>(e&&(async()=>{if(e&&!a){const w=new ac,E=new ka;try{await E.open(),E.connect(w),l(w),console.log("Audio initialized")}catch(y){console.error("Mic access denied or error:",y)}}})(),()=>{}),[e]);const d=async()=>{if(a)if(!i)await _$(),a.start(),o(!0);else{const g=await a.stop(),w=URL.createObjectURL(g);s(E=>[...E,{audio:w,sender:"me"}]),o(!1)}},f=()=>{u.trim()&&(s(g=>[...g,{text:u,sender:"me"}]),h(""),setTimeout(()=>{s(g=>[...g,{text:"That's interesting...",sender:"them"}])},1500))},m=g=>{const w=new Al(g).toDestination();w.autostart=!0};return e?V.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[V.jsx("div",{style:{padding:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",background:"var(--color-primary)",zIndex:10},children:V.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[V.jsx("button",{onClick:()=>t(null),className:"icon-btn",children:V.jsx(D2,{color:"white"})}),V.jsx("img",{src:e.avatar,alt:e.name,style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover"}}),V.jsx("span",{style:{fontWeight:"bold"},children:e.name})]})}),V.jsx("div",{style:{flex:1,overflowY:"auto",padding:"1rem",display:"flex",flexDirection:"column",gap:"1rem",WebkitOverflowScrolling:"touch"},children:r.map((g,w)=>V.jsxs("div",{style:{alignSelf:g.sender==="me"?"flex-end":"flex-start",backgroundColor:g.sender==="me"?"var(--color-secondary)":"rgba(255,255,255,0.1)",color:g.sender==="me"?"var(--color-primary)":"white",padding:"10px 15px",borderRadius:"15px",maxWidth:"70%",borderBottomRightRadius:g.sender==="me"?"2px":"15px",borderBottomLeftRadius:g.sender==="me"?"15px":"2px"},children:[g.text&&V.jsx("p",{children:g.text}),g.audio&&V.jsxs("button",{onClick:()=>m(g.audio),style:{display:"flex",alignItems:"center",gap:"5px"},children:[V.jsx(j2,{size:16,fill:"currentColor"})," Audio Note"]})]},w))}),V.jsxs("div",{style:{padding:"10px",display:"flex",gap:"10px",alignItems:"center",background:"var(--color-primary)",borderTop:"1px solid rgba(255,255,255,0.1)",paddingBottom:"20px"},children:[V.jsx("button",{onClick:d,className:"icon-btn",style:{width:"45px",height:"45px",backgroundColor:i?"#ff4444":"rgba(255,255,255,0.05)",color:"white",border:i?"none":"1px solid rgba(255,255,255,0.1)"},children:V.jsx(U2,{size:20,className:i?"animate-pulse":""})}),V.jsx("input",{type:"text",value:u,onChange:g=>h(g.target.value),placeholder:"Type a message...",style:{flex:1,margin:0,borderRadius:"20px"}}),V.jsx("button",{onClick:f,className:"icon-btn",style:{color:"var(--color-secondary)"},children:V.jsx(B2,{size:24})})]})]}):V.jsxs("div",{className:"page-container",children:[V.jsx("h2",{style:{color:"var(--color-secondary)",marginBottom:"1.5rem",fontSize:"1.8rem",fontWeight:"800"},children:"Matches"}),n.length===0?V.jsx("p",{style:{color:"var(--color-text-muted)",textAlign:"center",marginTop:"3rem"},children:"No matches yet. Go swipe!"}):V.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:n.map(g=>V.jsxs("div",{onClick:()=>t(g),style:{display:"flex",alignItems:"center",gap:"15px",padding:"1rem",backgroundColor:"rgba(255,255,255,0.03)",borderRadius:"16px",cursor:"pointer",border:"1px solid rgba(255,255,255,0.05)",transition:"background 0.2s"},onMouseOver:w=>w.currentTarget.style.backgroundColor="rgba(255,255,255,0.06)",onMouseOut:w=>w.currentTarget.style.backgroundColor="rgba(255,255,255,0.03)",children:[V.jsx("img",{src:g.avatar,alt:g.name,style:{width:"56px",height:"56px",borderRadius:"50%",objectFit:"cover",border:"2px solid rgba(255,215,0,0.2)"}}),V.jsxs("div",{children:[V.jsx("div",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:g.name}),V.jsx("div",{style:{fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Click to chat"})]})]},g.id))})]})},j$=()=>{const{user:n,setUser:e}=q.useContext(Jo),[t,r]=q.useState((n==null?void 0:n.bio)||"I love gazing at the stars and thinking about the void."),[s,i]=q.useState((n==null?void 0:n.location)||""),[o,a]=q.useState(!0),[l,u]=q.useState([]),[h,d]=q.useState(!1),f=q.useRef(null),[m,g]=q.useState((n==null?void 0:n.positive)||[]),[w,E]=q.useState((n==null?void 0:n.traumas)||[]),[y,T]=q.useState(""),[S,N]=q.useState("positive"),P=()=>{y.trim()&&(S==="positive"?g([...m,y.trim()]):E([...w,y.trim()]),T(""))},D=(C,b)=>{b==="positive"?g(m.filter(R=>R!==C)):E(w.filter(R=>R!==C))},I=async()=>{if(n){const C={bio:t,positive:m,traumas:w,location:s};try{n.uid&&await Fw(Ah(Ph,"users",n.uid),C,{merge:!0}),e({...n,...C}),alert("Profile & Emotional Data saved!")}catch(b){console.error("Error saving profile:",b),alert("Error saving profile. Please try again.")}}else alert("Error: No user logged in.")},v=C=>{const b=C.target.files[0];if(b){const R=new FileReader;R.onloadend=()=>{e({...n,avatar:R.result})},R.readAsDataURL(b)}},A=async C=>{if(C.length<3){u([]);return}d(!0);try{const R=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(C)}&addressdetails=1&limit=5&featuretype=city`)).json();u(R.map(W=>({display_name:W.display_name,city:W.address.city||W.address.town||W.address.village||W.display_name.split(",")[0]})))}catch(b){console.error("Error fetching cities:",b)}finally{d(!1)}},x=C=>{i(C);const b=setTimeout(()=>A(C),500);return()=>clearTimeout(b)};return n?V.jsxs("div",{className:"page-container",children:[V.jsx("h2",{style:{color:"var(--color-secondary)",textAlign:"center",marginBottom:"2rem"},children:"Edit Profile"}),V.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"2rem"},children:[V.jsxs("div",{style:{position:"relative",width:"120px",height:"120px",marginBottom:"1rem"},children:[V.jsx("img",{src:(n==null?void 0:n.avatar)||"https://via.placeholder.com/150",alt:"Profile",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover",border:"3px solid var(--color-secondary)"}}),V.jsx("input",{type:"file",ref:f,onChange:v,style:{display:"none"},accept:"image/*"}),V.jsx("button",{onClick:()=>f.current.click(),style:{position:"absolute",bottom:"0",right:"0",backgroundColor:"var(--color-primary)",border:"1px solid var(--color-secondary)",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-secondary)"},children:V.jsx(N2,{size:18})})]}),V.jsx("h3",{style:{fontSize:"1.5rem"},children:n==null?void 0:n.name})]}),V.jsxs("div",{style:{marginBottom:"1.5rem"},children:[V.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--color-text-muted)"},children:"Bio"}),V.jsx("textarea",{value:t,onChange:C=>r(C.target.value),rows:3,style:{resize:"none"}})]}),V.jsxs("div",{style:{marginBottom:"2rem"},children:[V.jsx("label",{style:{display:"block",marginBottom:"1rem",color:"var(--color-text-muted)",textAlign:"center"},children:"Emotional Aspects"}),V.jsxs("div",{style:{display:"flex",marginBottom:"1rem",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[V.jsx("button",{onClick:()=>N("positive"),style:{flex:1,padding:"10px",borderBottom:S==="positive"?"2px solid var(--color-secondary)":"none",color:S==="positive"?"var(--color-secondary)":"var(--color-text-muted)",background:"transparent"},children:"Positive"}),V.jsx("button",{onClick:()=>N("negative"),style:{flex:1,padding:"10px",borderBottom:S==="negative"?"2px solid #ff4444":"none",color:S==="negative"?"#ff4444":"var(--color-text-muted)",background:"transparent"},children:"Traumas / Deep"})]}),V.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"1rem"},children:[V.jsx("input",{type:"text",value:y,onChange:C=>T(C.target.value),placeholder:`Add ${S} trait...`,style:{margin:0}}),V.jsx("button",{onClick:P,className:"btn",style:{padding:"0 20px",minWidth:"50px"},children:"+"})]}),V.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(S==="positive"?m:w).map((C,b)=>V.jsxs("span",{style:{backgroundColor:S==="positive"?"rgba(255,215,0,0.15)":"rgba(255,68,68,0.15)",color:S==="positive"?"var(--color-secondary)":"#ff4444",padding:"6px 12px",borderRadius:"20px",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"8px",border:"1px solid currentColor"},children:[C,V.jsx("button",{onClick:()=>D(C,S),className:"icon-btn",style:{padding:0,color:"inherit"},children:""})]},b)),(S==="positive"?m:w).length===0&&V.jsx("span",{style:{color:"var(--color-text-muted)",fontStyle:"italic",fontSize:"0.8rem",width:"100%",textAlign:"center"},children:"No traits added yet. Add some to improve matching!"})]})]}),V.jsxs("div",{style:{marginBottom:"2rem",display:"flex",flexDirection:"column",gap:"0.5rem",backgroundColor:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"12px"},children:[V.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[V.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[V.jsx(L2,{size:20,color:"var(--color-secondary)"}),V.jsx("div",{style:{fontWeight:"bold"},children:"Location"})]}),V.jsxs("button",{onClick:()=>a(!o),className:"icon-btn",style:{color:o?"var(--color-accent)":"var(--color-text-muted)",gap:"5px",borderRadius:"8px"},children:[o?V.jsx(M2,{size:16}):V.jsx(V2,{size:16}),V.jsx("span",{style:{fontSize:"0.8rem"},children:o?"Private":"Public"})]})]}),V.jsxs("div",{style:{position:"relative"},children:[V.jsx("input",{type:"text",value:s,onChange:C=>x(C.target.value),placeholder:"Search your city...",style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",marginTop:"0.5rem",width:"100%"}}),l.length>0&&V.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"#0a192f",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",zIndex:100,marginTop:"5px",maxHeight:"200px",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.5)"},children:l.map((C,b)=>V.jsx("div",{onClick:()=>{i(C.display_name),u([])},style:{padding:"10px 15px",color:"white",cursor:"pointer",borderBottom:"1px solid rgba(255,255,255,0.05)",fontSize:"0.85rem"},onMouseOver:R=>R.currentTarget.style.backgroundColor="rgba(255,255,255,0.05)",onMouseOut:R=>R.currentTarget.style.backgroundColor="transparent",children:C.display_name},b))}),h&&V.jsx("div",{style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-20%)",fontSize:"0.7rem",color:"var(--color-accent)"},children:"Searching..."})]})]}),V.jsx("button",{className:"btn",style:{width:"100%"},onClick:I,children:"Save Changes"})]}):V.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Please log in."})},B$=()=>{const{setUser:n}=pt.useContext(Jo),e=ah(),[t,r]=pt.useState(!0),[s,i]=pt.useState(!1),[o,a]=pt.useState(""),[l,u]=pt.useState(""),[h,d]=pt.useState(""),[f,m]=pt.useState(""),[g,w]=pt.useState(""),E=async T=>{T.preventDefault(),w(""),i(!0);try{if(t)await RL(ic,o,l),e("/");else{const S=await kL(ic,o,l),N=Ah(Ph,"users",S.user.uid);await Fw(N,{name:h,phone:f,email:o,createdAt:new Date().toISOString(),traumas:[],positive:[],interests:[],intent:""}),e("/assessment")}}catch(S){w(S.message.replace("Firebase: ",""))}finally{i(!1)}},y=async()=>{w("");try{await JL(ic,yP),e("/assessment")}catch(T){w(T.message)}};return V.jsx("div",{className:"page-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%"},children:V.jsxs("div",{className:"animate-fade-in",style:{backgroundColor:"rgba(255,255,255,0.03)",padding:"2.5rem 2rem",borderRadius:"24px",border:"1px solid rgba(255,255,255,0.05)",boxShadow:"0 20px 40px rgba(0,0,0,0.4)"},children:[V.jsxs("div",{style:{textAlign:"center",marginBottom:"2.5rem"},children:[V.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.5rem"},children:""}),V.jsx("h1",{style:{color:"var(--color-secondary)",fontSize:"2.2rem",fontWeight:"800"},children:"Traumatch"}),V.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"0.9rem"},children:t?"Welcome back to the sanctuary.":"Join the sanctuary of deep bonds."})]}),g&&V.jsx("div",{style:{backgroundColor:"rgba(255,68,68,0.1)",color:"#ff4444",padding:"1rem",borderRadius:"12px",marginBottom:"1.5rem",fontSize:"0.85rem",border:"1px solid rgba(255,68,68,0.2)"},children:g}),V.jsxs("form",{onSubmit:E,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[!t&&V.jsxs(V.Fragment,{children:[V.jsx("input",{type:"text",placeholder:"Full Name",value:h,onChange:T=>d(T.target.value),required:!0}),V.jsx("input",{type:"tel",placeholder:"Phone Number",value:f,onChange:T=>m(T.target.value),required:!0})]}),V.jsx("input",{type:"email",placeholder:"Email Address",value:o,onChange:T=>a(T.target.value),required:!0}),V.jsx("input",{type:"password",placeholder:"Password",value:l,onChange:T=>u(T.target.value),required:!0}),V.jsx("button",{type:"submit",disabled:s,className:"btn",children:s?"Connecting...":t?"Enter Sanctuary":"Create Soul Profile"})]}),V.jsxs("div",{style:{margin:"1.5rem 0",display:"flex",alignItems:"center",gap:"10px"},children:[V.jsx("div",{style:{flex:1,height:"1px",background:"rgba(255,255,255,0.1)"}}),V.jsx("span",{style:{fontSize:"0.8rem",color:"var(--color-text-muted)"},children:"OR"}),V.jsx("div",{style:{flex:1,height:"1px",background:"rgba(255,255,255,0.1)"}})]}),V.jsxs("button",{onClick:y,className:"btn btn-secondary",style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[V.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",style:{width:"18px"}}),"Continue with Google"]}),V.jsx("button",{onClick:()=>r(!t),style:{width:"100%",background:"none",border:"none",color:"var(--color-accent)",fontSize:"0.9rem",cursor:"pointer"},children:t?"New here? Create an account":"Already have an account? Login"})]})})},z$="modulepreload",q$=function(n){return"/"+n},KS={},QS=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=q$(l),l in KS)return;KS[l]=!0;const u=l.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":z$,u||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((f,m)=>{d.addEventListener("load",f),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},$$=()=>{const{user:n,setUser:e}=pt.useContext(Jo),t=ah(),[r,s]=pt.useState(0),[i,o]=pt.useState({}),a=["Music","Poetry","Gaming","Meditation","Fitness","Coding","Art","Philosophy","Psychology","Travel","Astrology","Nature","Cooking","Photography"],l=[{id:"q1",type:"single",text:"How do you usually process a difficult day?",options:[{label:"I isolate and reflect in silence",trait:"Deep Thinker",type:"positive"},{label:"I seek comfort in music or art",trait:"Creative Soul",type:"positive"},{label:"I feel overwhelmed and anxious",trait:"Anxiety",type:"trauma"},{label:"I talk it out with someone I trust",trait:"Open Book",type:"positive"}]},{id:"q2",type:"single",text:"What is your biggest fear in a relationship?",options:[{label:"Being misunderstood",trait:"Sensitive",type:"positive"},{label:"Being abandoned",trait:"Abandonment Issues",type:"trauma"},{label:"Losing my independence",trait:"Independent",type:"positive"},{label:"Not being 'enough'",trait:"Insecurity",type:"trauma"}]},{id:"q3",type:"single",text:"When you look at the stars, what do you feel?",options:[{label:"Small and insignificant",trait:"Existential Dread",type:"trauma"},{label:"Connected to everything",trait:"Spiritual",type:"positive"},{label:"Curiosity and wonder",trait:"Inquisitive",type:"positive"},{label:"A sense of deep loneliness",trait:"Loneliness",type:"trauma"}]},{id:"q4",type:"single",text:"How do you handle conflict with others?",options:[{label:"I shut down and avoid it",trait:"Avoidant",type:"trauma"},{label:"I try to keep the peace at any cost",trait:"People Pleaser",type:"trauma"},{label:"I face it head-on with honesty",trait:"Direct",type:"positive"},{label:"I use humor to deflect",trait:"Witty",type:"positive"}]},{id:"q5",type:"single",text:"What does 'home' mean to you?",options:[{label:"A place where I can hide",trait:"Introverted",type:"positive"},{label:"A person, not a place",trait:"Romantic",type:"positive"},{label:"Somewhere I haven't found yet",trait:"Restless Soul",type:"trauma"},{label:"Chaos and noise",trait:"Family Trauma",type:"trauma"}]},{id:"q6",type:"single",text:"What is your 'guilty pleasure' when feeling down?",options:[{label:"Sad movies and crying",trait:"Melancholic",type:"trauma"},{label:"Eating my feelings",trait:"Emotional Eater",type:"trauma"},{label:"Cleaning everything",trait:"Perfectionist",type:"positive"},{label:"Sleeping for 12 hours",trait:"Exhausted",type:"trauma"}]}],u=pt.useMemo(()=>{const m=[{id:"intent",type:"intent",text:"What kind of soul-connection are you seeking today?"},{id:"interests",type:"multiselect",text:"Which frequencies do you tune into? (Pick your interests)",options:a}],g=[...l].sort(()=>.5-Math.random());return[...m,...g.slice(0,4)]},[]),h=u[r],d=m=>{const g={...i,[h.id]:m};o(g),r<u.length-1?s(r+1):f(g)},f=async m=>{const g=Object.values(m).filter(T=>T&&typeof T=="object"&&T.trait),w=g.filter(T=>T.type==="positive").map(T=>T.trait),E=g.filter(T=>T.type==="trauma").map(T=>T.trait),y={positive:[...new Set([...(n==null?void 0:n.positive)||[],...w])],traumas:[...new Set([...(n==null?void 0:n.traumas)||[],...E])],intent:m.intent||"",interests:m.interests||[]};try{if(n!=null&&n.uid){const{db:T}=await QS(async()=>{const{db:P}=await Promise.resolve().then(()=>Wj);return{db:P}},void 0),{doc:S,setDoc:N}=await QS(async()=>{const{doc:P,setDoc:D}=await Promise.resolve().then(()=>qj);return{doc:P,setDoc:D}},void 0);await N(S(T,"users",n.uid),y,{merge:!0})}e({...n,...y}),t("/")}catch(T){console.error("Error updating profile:",T),t("/")}};return V.jsxs("div",{className:"page-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",minHeight:"100%"},children:[V.jsxs("div",{className:"animate-fade-in",style:{backgroundColor:"rgba(255,255,255,0.03)",padding:"2rem",borderRadius:"24px",border:"1px solid rgba(255,255,255,0.05)"},children:[V.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[V.jsx("h2",{style:{color:"var(--color-secondary)",fontSize:"1.2rem"},children:"Soul Discovery"}),V.jsxs("span",{style:{fontSize:"0.8rem",opacity:.5},children:["Step ",r+1," of ",u.length]})]}),V.jsx("h3",{style:{fontSize:"1.5rem",marginBottom:"2rem",lineHeight:1.3},children:u[r].text}),V.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:u[r].options.map((m,g)=>V.jsx("button",{className:"btn btn-secondary",onClick:()=>d(m),style:{textAlign:"left",justifyContent:"flex-start",padding:"1.2rem",textTransform:"none",letterSpacing:"normal"},children:m.label},g))}),V.jsx("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:V.jsxs("button",{onClick:()=>t("/"),style:{display:"flex",alignItems:"center",gap:"5px",color:"var(--color-text-muted)",fontSize:"0.9rem"},children:[V.jsx(q2,{size:16})," Skip for now"]})})]}),V.jsxs("div",{style:{marginTop:"3rem",padding:"1.5rem",backgroundColor:"rgba(100, 255, 218, 0.05)",borderRadius:"12px",border:"1px solid rgba(100, 255, 218, 0.1)",display:"flex",gap:"12px"},children:[V.jsx(z2,{size:40,color:"var(--color-accent)",style:{flexShrink:0}}),V.jsxs("p",{style:{fontSize:"0.75rem",color:"var(--color-text-muted)",lineHeight:1.4},children:[V.jsx("strong",{style:{color:"var(--color-accent)"},children:"Privacy Commitment:"})," All information you provide is protected on our secure servers. This data will ",V.jsx("strong",{style:{color:"white"},children:"never"})," be used for any purpose other than finding deep connections with others or personalizing your music and content feed based on your mood."]})]})]})},W$=()=>{const n=bl(),e=t=>({color:n.pathname===t?"var(--color-secondary)":"var(--color-text-muted)",display:"flex",flexDirection:"column",alignItems:"center",fontSize:"0.8rem",textDecoration:"none",flex:1});return V.jsxs("div",{className:"app-shell",children:[V.jsx("div",{className:"page-container",children:V.jsx(g2,{})}),V.jsx("nav",{className:"main-nav",children:V.jsxs("div",{className:"nav-content",children:[V.jsxs(_d,{to:"/",style:e("/"),children:[V.jsx(O2,{size:24}),V.jsx("span",{children:"Home"})]}),V.jsxs(_d,{to:"/swipe",style:e("/swipe"),children:[V.jsx(_C,{size:24}),V.jsx("span",{children:"Match"})]}),V.jsxs(_d,{to:"/chat",style:e("/chat"),children:[V.jsx(F2,{size:24}),V.jsx("span",{children:"Chat"})]}),V.jsxs(_d,{to:"/profile",style:e("/profile"),children:[V.jsx(W2,{size:24}),V.jsx("span",{children:"Profile"})]})]})})]})},Jo=pt.createContext(null);function G$(){const[n,e]=q.useState(null),[t,r]=q.useState([]),[s,i]=q.useState(!0);return pt.useEffect(()=>{const o=NL(ic,async a=>{if(a){const l=await pP(Ah(Ph,"users",a.uid));l.exists()?e({uid:a.uid,email:a.email,...l.data()}):e({uid:a.uid,email:a.email,name:a.displayName||"New Soul"})}else e(null);i(!1)});return()=>o()},[]),s?V.jsx("div",{className:"app-shell",style:{justifyContent:"center",alignItems:"center"},children:V.jsx("div",{className:"animate-pulse",style:{color:"var(--color-secondary)",fontSize:"1.2rem"},children:"Loading Traumatch..."})}):V.jsx(Jo.Provider,{value:{user:n,setUser:e,matches:t,setMatches:r},children:V.jsx(A2,{children:V.jsx("div",{className:"app-shell",children:V.jsxs(y2,{children:[V.jsx(Vs,{path:"/auth",element:n?V.jsx(hg,{to:"/"}):V.jsx(B$,{})}),V.jsx(Vs,{path:"/assessment",element:n?V.jsx($$,{}):V.jsx(hg,{to:"/auth"})}),V.jsxs(Vs,{path:"/",element:n?V.jsx(W$,{}):V.jsx(hg,{to:"/auth"}),children:[V.jsx(Vs,{index:!0,element:V.jsx(H2,{})}),V.jsx(Vs,{path:"swipe",element:V.jsx(Gj,{})}),V.jsx(Vs,{path:"chat",element:V.jsx(U$,{})}),V.jsx(Vs,{path:"profile",element:V.jsx(j$,{})})]})]})})})})}Pg.createRoot(document.getElementById("root")).render(V.jsx(pt.StrictMode,{children:V.jsx(G$,{})}));
